"use strict";(self.webpackChunkWon_Yong_Jo=self.webpackChunkWon_Yong_Jo||[]).push([[334],{3905:(a,t,e)=>{e.d(t,{Zo:()=>N,kt:()=>h});var n=e(67294);function s(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}function m(a,t){var e=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(a,t).enumerable}))),e.push.apply(e,n)}return e}function p(a){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?m(Object(e),!0).forEach((function(t){s(a,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(e)):m(Object(e)).forEach((function(t){Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(e,t))}))}return a}function r(a,t){if(null==a)return{};var e,n,s=function(a,t){if(null==a)return{};var e,n,s={},m=Object.keys(a);for(n=0;n<m.length;n++)e=m[n],t.indexOf(e)>=0||(s[e]=a[e]);return s}(a,t);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(n=0;n<m.length;n++)e=m[n],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(a,e)&&(s[e]=a[e])}return s}var l=n.createContext({}),i=function(a){var t=n.useContext(l),e=t;return a&&(e="function"==typeof a?a(t):p(p({},t),a)),e},N=function(a){var t=i(a.components);return n.createElement(l.Provider,{value:t},a.children)},k="mdxType",o={inlineCode:"code",wrapper:function(a){var t=a.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(a,t){var e=a.components,s=a.mdxType,m=a.originalType,l=a.parentName,N=r(a,["components","mdxType","originalType","parentName"]),k=i(e),c=s,h=k["".concat(l,".").concat(c)]||k[c]||o[c]||m;return e?n.createElement(h,p(p({ref:t},N),{},{components:e})):n.createElement(h,p({ref:t},N))}));function h(a,t){var e=arguments,s=t&&t.mdxType;if("string"==typeof a||s){var m=e.length,p=new Array(m);p[0]=c;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=a,r[k]="string"==typeof a?a:s,p[1]=r;for(var i=2;i<m;i++)p[i]=e[i];return n.createElement.apply(null,p)}return n.createElement.apply(null,e)}c.displayName="MDXCreateElement"},49714:(a,t,e)=>{e.r(t),e.d(t,{assets:()=>l,contentTitle:()=>p,default:()=>o,frontMatter:()=>m,metadata:()=>r,toc:()=>i});var n=e(87462),s=(e(67294),e(3905));const m={slug:"LongLoRA",title:"LongLoRA: Efficient Fine-Tuning of LongContext Large Language Models",tags:["LongLoRA","LoRA","PEFT","Low-Rank","LongContext"]},p=void 0,r={unversionedId:"Paper/NLP/PEFT/Composition/2023-09-LongLoRA",id:"Paper/NLP/PEFT/Composition/2023-09-LongLoRA",title:"LongLoRA: Efficient Fine-Tuning of LongContext Large Language Models",description:"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 :",source:"@site/docs/Paper/NLP/PEFT/Composition/2023-09-LongLoRA.md",sourceDirName:"Paper/NLP/PEFT/Composition",slug:"/Paper/NLP/PEFT/Composition/LongLoRA",permalink:"/docs/Paper/NLP/PEFT/Composition/LongLoRA",draft:!1,editUrl:"https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/NLP/PEFT/Composition/2023-09-LongLoRA.md",tags:[{label:"LongLoRA",permalink:"/docs/tags/long-lo-ra"},{label:"LoRA",permalink:"/docs/tags/lo-ra"},{label:"PEFT",permalink:"/docs/tags/peft"},{label:"Low-Rank",permalink:"/docs/tags/low-rank"},{label:"LongContext",permalink:"/docs/tags/long-context"}],version:"current",frontMatter:{slug:"LongLoRA",title:"LongLoRA: Efficient Fine-Tuning of LongContext Large Language Models",tags:["LongLoRA","LoRA","PEFT","Low-Rank","LongContext"]},sidebar:"tutorialSidebar",previous:{title:"Delta-LoRA: Fine-Tuning High-Rank Parameters with the Delta of Low-Rank Matrices",permalink:"/docs/Paper/NLP/PEFT/Composition/Delta-LoRA"},next:{title:"Chain of LoRA: Efficient Fine-tuning of Language Models via Residual Learning",permalink:"/docs/Paper/NLP/PEFT/Composition/SaLoRA"}},l={},i=[{value:"\ucd08\ub85d",id:"\ucd08\ub85d",level:3},{value:"Long-context Transformers",id:"long-context-transformers",level:4},{value:"Long-context LLMs.",id:"long-context-llms",level:4},{value:"efficient fine-tuning",id:"efficient-fine-tuning",level:4},{value:"3.1 Background",id:"31-background",level:2},{value:"transformer",id:"transformer",level:4},{value:"Low-rank Adaptation",id:"low-rank-adaptation",level:4},{value:"3.2 Shifted Sparse Attention",id:"32-shifted-sparse-attention",level:2},{value:"Pilot Study.",id:"pilot-study",level:4},{value:"Consistency to Full Attention.",id:"consistency-to-full-attention",level:4},{value:"Easy Implementation.",id:"easy-implementation",level:4},{value:"3.3 long context \ub97c \uc704\ud55c \uac1c\uc120\ub41c LoRA",id:"33-long-context-\ub97c-\uc704\ud55c-\uac1c\uc120\ub41c-lora",level:3},{value:"4.1 Experimental Settings",id:"41-experimental-settings",level:2},{value:"Models",id:"models",level:4},{value:"Training Procedure",id:"training-procedure",level:4},{value:"Dataset",id:"dataset",level:4},{value:"4.2 Main Results",id:"42-main-results",level:2},{value:"Long-sequence Language Modeling.",id:"long-sequence-language-modeling",level:4},{value:"Retrieval-based Evaluation.",id:"retrieval-based-evaluation",level:4},{value:"4.3 Ablation Study",id:"43-ablation-study",level:2},{value:"Ablation on Fine-tuning Steps.",id:"ablation-on-fine-tuning-steps",level:4},{value:"Attention Patterns",id:"attention-patterns",level:4},{value:"5 \uacb0\ub860",id:"5-\uacb0\ub860",level:3}],N={toc:i},k="wrapper";function o(a){let{components:t,...m}=a;return(0,s.kt)(k,(0,n.Z)({},N,m,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 : ",(0,s.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2309.12307"},"https://arxiv.org/pdf/2309.12307")),(0,s.kt)("h3",{id:"\ucd08\ub85d"},"\ucd08\ub85d"),(0,s.kt)("p",null,"LongLoRA \ub294 limited computation cost \ub85c pre-trained large language model(LLM)\uc758 context sizes \ub97c \ud655\uc7a5\ud558\ub294 efficient fine-tuning \uc811\uadfc \ubc29\uc2dd\uc774\ub2e4. "),(0,s.kt)("p",null,"\uc77c\ubc18\uc801\uc73c\ub85c long context sizes \ub85c LLM \uc744 \ud6c8\ub828\ud558\ub294 \uac83\uc740 \uacc4\uc0b0\uc801\uc73c\ub85c \ube44\uc6a9\uc774 \ub9ce\uc774 \ub4e4\uba70, \uc0c1\ub2f9\ud55c training time \uacfc GPU \uc790\uc6d0\uc744 \ud544\uc694\ub85c \ud55c\ub2e4. \uc608\ub85c, 8192 \uc758 context length \ub85c \ud6c8\ub828\ud558\uba74 2048 \uc758 context length \uc5d0 \ube44\ud574 16x computation cost \uc774 \ub4e0\ub2e4. "),(0,s.kt)("p",null,"\ubcf8 \ub17c\ubb38\uc5d0\uc11c\ub294 \ub450 \uac00\uc9c0 \uce21\uba74\uc5d0\uc11c LLM \uc758 context extension \uc744 \uac00\uc18d\ud654\ud55c\ub2e4. "),(0,s.kt)("p",null,"\ud55c\ud3b8, inference \uc2dc\uc5d0 ",(0,s.kt)("em",{parentName:"p"},"dense global")," attention \uac00 \ud544\uc694\ud558\uc9c0\ub9cc, model \uc758 fine-tuning \uc740 ",(0,s.kt)("em",{parentName:"p"},"sparse local")," attention \ub85c \ud6a8\uacfc\uc801\uc774\uace0 \ud6a8\uc728\uc801\uc73c\ub85c \uc218\ud589\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"shifted sparse attention(S",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn) \ub294 context extension \uc744 \ud6a8\uacfc\uc801\uc73c\ub85c \uac00\ub2a5\ud558\uac8c \ud558\uba70, vanilla attention \uc640 \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uba74\uc11c computation cost \uc744 \uc2e4\uc9c8\uc801\uc73c\ub85c \uc808\uac10\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ud2b9\ud788, \uc774\ub294 training \uc2dc ",(0,s.kt)("em",{parentName:"li"},"\ub450 \uc904\uc758 \ucf54\ub4dc")," \ub9cc\uc73c\ub85c \uad6c\ud604\ud560 \uc218 \uc788\uc73c\uba70, inference \uc2dc\uc5d0\ub294 \uc120\ud0dd\uc801\uc774\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\ub2e4\ub978 \ud55c\ud3b8\uc73c\ub85c, context extension \uc744 \uc704\ud55c parameter efficient fine-tuning \ubc29\uc2dd\uc744 \uc7ac\uac80\ud1a0\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ud2b9\ud788, context extension \uc744 \uc704\ud55c LoRA \ub294 trainable embedding \ubc0f normalization \uac00 \uc804\uc81c\ub418\uc5b4\uc57c \uc798 \uc791\ub3d9\ud55c\ub2e4\ub294 \uac83\uc744 \ubc1c\uacac\ud558\uc600\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 improved LoRA \uc640 S",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc744 \uacb0\ud569\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 Llama2 model(7B/13B to 70B)\uc5d0\uc11c \ub2e4\uc591\ud55c task \uc5d0 \ub300\ud574 \uac15\ub825\ud55c \uc2e4\ud5d8\uc801 \uacb0\uacfc\ub97c \ubcf4\uc5ec\uc900\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 Llama2 7B \ub97c 4k context \uc5d0\uc11c 100k \ub85c \ud655\uc7a5\ud558\uac70\ub098, Llama2 70B \ub97c single 8\xd7 A100 \uc5d0\uc11c 32k \ub85c \ud655\uc7a5\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 model \uc758 context \ub97c \ud655\uc7a5\ud558\uba74\uc11c original architecture \ub97c \uc720\uc9c0\ud558\uba70, Flash-Attention2 \uc640 \uac19\uc740 \ub300\ubd80\ubd84\uc758 \uae30\uc874 \uae30\uc220\uacfc \ud638\ud658\ub41c\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},"\ucd94\uac00\ub85c, LongLoRA \uc640 \uc800\uc790\uc758 long instruction-following LongAlpaca dataset \uc744 \uc0ac\uc6a9\ud558\uc5ec supervised fine-tuning \uc744 \uc218\ud589\ud55c\ub2e4. ")),(0,s.kt)("h1",{id:"1-introduction"},"1 Introduction"),(0,s.kt)("p",null,"large language model(LLM)\uc740 \uc77c\ubc18\uc801\uc73c\ub85c pre-defined context sizes \ub85c \ud6c8\ub828\ub41c\ub2e4. "),(0,s.kt)("p",null,"\uc608\ub85c, LLaMA \ub294 2048 tokens, Llama2 \ub294 4096 tokens \ub97c \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 \uc774\ub7ec\ud55c pre-defined size \ub294 long documents \ub97c \uc694\uc57d\ud558\uac70\ub098 long questions \uc5d0 \ub2f5\ud558\ub294 \ub4f1 \ub9ce\uc740 \uc751\uc6a9\uc5d0\uc11c LLM \uc744 \uc81c\ud55c\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774 \uc81c\ud55c\uc744 \ud574\uacb0\ud558\uae30 \uc704\ud574, \ucd5c\uadfc \uba87 \uac00\uc9c0 \uc5f0\uad6c\ub294 LLM \uc744 longer context \ub85c \ud6c8\ub828\ud558\uac70\ub098 fine-tuning \ud55c\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 long sequence \uc758 LLM \uc744 scratch training \ud558\ub294 \uac83\uc740 computational challenges \ub97c \uc81c\uc2dc\ud558\uba70, \uae30\uc874\uc758 pre-trained LLM \uc744 fine-tuning \ud558\ub294 \uac83\ub3c4 \uc0c1\ub2f9\ud788 \ube44\uc2f8\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, Position Interpolation \uc740 LLaMA model \uc744 2k to 8k context \ub85c \ud655\uc7a5\ud558\uae30 \uc704\ud574 32 A100 GPU \ub97c \uc0ac\uc6a9\ud558\uace0, longer context \uc758 fine-tuning \uc5d0\ub294 128 A100 GPU \ub97c \uc0ac\uc6a9\ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"FOT \uc740 standard transformer training \uc744 \uc704\ud574 32 TPU \ub97c \uc0ac\uc6a9\ud558\uace0, LongLLaMA \uc5d0\ub294 128 TPU \ub97c \uc0ac\uc6a9\ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c computation resources \uc740 \uc77c\ubc18 \uc5f0\uad6c\uc790\ub4e4\uc5d0\uac8c\ub294 \uac10\ub2f9\ud558\uae30 \uc5b4\ub824\uc6b4 \uacbd\uc6b0\uac00 \ub9ce\uc544, \uc800\uc790\ub294 LLM \uc758 context window \ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ud655\uc7a5\ud560 \uc218 \uc788\ub294 \ubc29\ubc95\uc744 \ubaa8\uc0c9\ud558\uac8c \ub41c\ub2e4.")),(0,s.kt)("p",null,"\ud558\ub098\uc758 \uac04\ub2e8\ud55c \uc811\uadfc \ubc29\uc2dd\uc740 pre-trained LLM \uc744 low-rank adaptation(LoRA) \uc744 \ud1b5\ud574 fine-tuning \ud558\ub294 \uac83\uc774\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 1",src:e(56030).Z,width:"1660",height:"678"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"LoRA \ub294 self-attention blocks \uc758 linear projection layers \ub97c low-rank matrix \ub97c \uc0ac\uc6a9\ud558\uc5ec \uc218\uc815\ud558\uba70, \uc77c\ubc18\uc801\uc73c\ub85c efficient \ud558\uba70 trainable parameters \uc218\ub97c \uc904\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uadf8\ub7ec\ub098 \uc800\uc790\uc758 \uacbd\ud5d8\uc801 \ubc1c\uacac\uc5d0 \ub530\ub974\uba74, long context model \uc744 \uc774 \ubc29\uc2dd\uc73c\ub85c \ud6c8\ub828\ud558\ub294 \uac83\uc740 effective \ubc0f efficient \ud558\uc9c0 \uc54a\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("em",{parentName:"li"},"effectiveness")," \uce21\uba74\uc5d0\uc120, plain low-rank adaptation \uc774 long context extension \uc5d0\uc11c high perplexity \ub97c \ucd08\ub798\ud55c\ub2e4 (Tab. 2).",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"e.g., ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"r"),(0,s.kt)("mi",{parentName:"mrow"},"a"),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mi",{parentName:"mrow"},"k"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"256")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"rank = 256")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"ank"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"256")))))," \uc758 higher value \ub85c \uc99d\uac00\uc2dc\ucf1c\ub3c4 \uc548\ud654\ub418\uc9c0 \uc54a\ub294\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("em",{parentName:"li"},"efficiency")," \uce21\uba74\uc5d0\uc120, LoRA \ub97c \uc0ac\uc6a9\ud558\ub4e0 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub4e0, context sizes \uac00 \ud655\uc7a5\ub428\uc5d0 \ub530\ub77c computation cost \uc774 \uadf9\uc801\uc73c\ub85c \uc99d\uac00\ud558\uba70, \uc774\ub294 \uc8fc\ub85c standard self-attention \uba54\ucee4\ub2c8\uc998 \ub54c\ubb38\uc774\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Fig. 1 \ucc98\ub7fc, LoRA \ub97c \uc0ac\uc6a9\ud558\ub354\ub77c\ub3c4 standard Llama2 model \uc758 training time \uc774 context window \uac00 \ud655\uc7a5\ub420 \ub54c \uc0c1\ub2f9\ud788 \uc99d\uac00\ud55c\ub2e4.")))))),(0,s.kt)("p",null,"\uc774 \ub17c\ubb38\uc5d0\uc11c\ub294 LongLoRA \ub97c \uc18c\uac1c\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 pre-trained LLM \uc758 context window \ub97c \ud655\uc7a5\ud558\ub294 efficient fine-tuning \uc811\uadfc \ubc29\uc2dd\uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"LoRA \ub294 full fine-tuning \uc744 \uadfc\uc0ac\ud558\uae30 \uc704\ud574 low-rank weights update \ub97c \uc0ac\uc6a9\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ub9c8\ucc2c\uac00\uc9c0\ub85c, \uc800\uc790\ub294 short attention \uac00 training \uc911 long context \ub97c \uadfc\uc0ac\ud560 \uc218 \uc788\uc74c\uc744 \ubc1c\uacac\ud558\uc600\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 shifted sparse attention (S",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn) \ub97c standard self-attention \uc758 efficient substitute \uc73c\ub85c \uc81c\uc2dc\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Fig. 2 \ucc98\ub7fc, \uc800\uc790\ub294 context length \ub97c \uc5ec\ub7ec groups \uc73c\ub85c \ub098\ub204\uace0 \uac01 group \uc5d0\uc11c attention \ub97c \uac1c\ubcc4\uc801\uc73c\ub85c \uc218\ud589\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"half attention head \uc5d0\uc11c, \uc800\uc790\ub294 tokens \ub97c half group size \ub9cc\ud07c shift \ud558\uc5ec neighboring groups \uac04\uc758 information flow \uc744 \ubcf4\uc7a5\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, S",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc744 group size 2048 \ub85c \uc0ac\uc6a9\ud558\uc5ec \ucd1d 8192 context length training \uc744 \uadfc\uc0ac\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 Swin Transformer \uc640 high-level spirit \uc744 \uacf5\uc720\ud55c\ub2e4.")))),(0,s.kt)("p",null,"S",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc744 \ud1b5\ud574 fine-tuned model \uc740 inference \uc911 original attention architecture \ub97c \uc720\uc9c0\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 \ub300\ubd80\ubd84\uc758 \uae30\uc874 optimization \ubc0f infrastructure \ub97c \uc6a9\uc774\ud558\uac8c \ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc77c\ubc18 LLM \uc5d0 \ub300\ud55c \uae30\uc220\uc740 \uc800\uc790\uc758 \ubc29\ubc95\uc5d0\ub3c4 \uc801\uc6a9\ud560 \uc218 \uc788\ub2e4.",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, Flash-Attention2 \ub294 training \ubc0f inference time \ubaa8\ub450\uc5d0\uc11c \uc800\uc790\uc758 \ubc29\ubc95\uacfc \ud638\ud658\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uadf8 \uc774\uc720\ub294 short attention \uac00 LLM \uc758 pre-training steps \uc5d0\uc11c\uc758 attention \ubc29\uc2dd\uacfc \uc720\uc0ac\ud558\uae30 \ub54c\ubb38\uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"dilated attention \ub610\ub294 sparse attention \uacfc \uac19\uc740 \ub2e4\ub978 efficient attention \ubc29\uc2dd\uc740 standard style \uacfc \ud070 \ucc28\uc774\uac00 \uc788\uc73c\uba70, Tab. 6 \uc5d0\uc11c\uc640 \uac19\uc774 \uc800\uc790\uc758 \ubc29\uc2dd\ucc98\ub7fc \uc798 \uc791\ub3d9\ud558\uc9c0 \uc54a\ub294\ub2e4.")))),(0,s.kt)("p",null,"\uc800\uc790\ub294 trainable embedding \ubc0f normalization layers \uac00 long context LoRA fine-tuning \uc758 \ud575\uc2ec\uc784\uc744 \uacbd\ud5d8\uc801\uc73c\ub85c \ubcf4\uc5ec\uc900\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Tab. 2 \ucc98\ub7fc, embeddings (",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow"},"\u2264"),(0,s.kt)("mn",{parentName:"mrow"},"2"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"%")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\le 2\\%")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7719em",verticalAlign:"-0.136em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2264"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8056em",verticalAlign:"-0.0556em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"2%"))))),") \ubc0f normalization layers (",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow"},"\u2264"),(0,s.kt)("mn",{parentName:"mrow"},"0.004"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"%")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\le 0.004\\%")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7719em",verticalAlign:"-0.136em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2264"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8056em",verticalAlign:"-0.0556em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.004%"))))),") \ub294 entire LLM \uc5d0\uc11c parameters \uc758 \uc791\uc740 \ube44\uc728\uc744 \ucc28\uc9c0\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, Llama2 7B \uc5d0\uc11c embeddings \uc740 2% \ubbf8\ub9cc\uc758 parameters \ub97c \uac00\uc9c0\uba70, normalization \ub294 0.004% \uc774\ud558\uc758 parameters \ub97c \uac00\uc9c4\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ube44\uc728\uc740 larger LLM \uc5d0\uc11c\ub294 \ub354 \uc904\uc5b4\ub4e0\ub2e4.")),(0,s.kt)("p",null,"\uc2e4\ud5d8\uc5d0\uc11c LongLoRA \uac00 \ud6a8\uacfc\uc801\uc774\uace0 \ud6a8\uc728\uc801\uc784\uc744 \ubcf4\uc5ec\uc900\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 Llama2 7B, 13B \ubc0f 70B \uc758 context window \ud655\uc7a5\uc5d0 \ub300\ud55c \uc2e4\ud5d8 \uacb0\uacfc\ub97c \uc81c\uc2dc\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Position Interpolation \uc758 \uc2e4\ud5d8 \uc124\uc815\uc744 \ub530\ub974\uba70, proper position embeddings \uc73c\ub85c model fine-tuning \ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"trained models \uc740 full-attention \ubc0f fully fine-tuning \uacb0\uacfc\uc640 \ube44\uad50\ud560 \uc218 \uc788\ub294 \uc131\ub2a5\uc744 \ub2ec\uc131\ud558\uba70, computation cost \uc740 \ud6e8\uc52c \uc801\ub2e4 (Fig. 1 \ucc38\uc870). "),(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 single 8\xd7 A100 \uc5d0\uc11c Llama2 7B \ub97c \ucd5c\ub300 100k context \ub85c, \ub610\ub294 70B model \uc744 \ucd5c\ub300 32k \ub85c fine-tuning \ud560 \uc218 \uc788\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, \uc800\uc790\ub294 LongAlpaca \ub77c\ub294 long instruction-following dataset \uc744 \uc0ac\uc6a9\ud558\uc5ec supervised fine-tuning(SFT)\uc744 \uc704\ud55c \uc194\ub8e8\uc158\uc744 \uc81c\uc2dc\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 LongLoRA model \uc740 long questions \uacfc \ud574\ub2f9 \ub2f5\ubcc0\uc73c\ub85c additional fine-tuning \ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 \uae30\uc220 \ub17c\ubb38, \uacf5\uc0c1 \uacfc\ud559 \ubc0f \uae30\ud0c0 \ucc45\uc744 \uc704\ud55c \ub2e4\uc591\ud55c \uc720\ud615\uc758 \uc9c8\ubb38\uc744 \uc124\uacc4\ud55c\ub2e4. SFT \ub294 LLM \uc758 \ub300\ud654 \ub2a5\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\ub294 \ub370 \uc911\uc694\ud558\ub2e4.")),(0,s.kt)("h1",{id:"2-related-work"},"2 RELATED WORK"),(0,s.kt)("h4",{id:"long-context-transformers"},"Long-context Transformers"),(0,s.kt)("p",null,"long context \ub97c \uc9c0\uc6d0\ud558\uae30 \uc704\ud574 \ub9ce\uc740 \uc5f0\uad6c\uac00 \uc9c4\ud589\ub418\uc5c8\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c \uc811\uadfc \ubc29\uc2dd \uc911 \uc77c\ubd80\ub294 retrieval-based, related documents \ub97c \uac00\uc838\uc624\uace0 retrieved results \ub97c context \uc5d0 \ud3ec\ud568\uc2dc\ucf1c language models \ub97c \ubcf4\uac15\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc800\uc790\uc758 \uc5f0\uad6c\ub294 \uc774\ub7ec\ud55c \uc5f0\uad6c\uc640 \uc0c1\ud638 \ubcf4\uc644\uc801\uc774\uba70, \uc800\uc790\uc758 attention \uba54\ucee4\ub2c8\uc998\uc740 inference \uc911 \ubcc0\uacbd\ub418\uc9c0 \uc54a\ub294\ub2e4. "),(0,s.kt)("p",null,"\ub9ce\uc740 \uc5f0\uad6c\ub4e4\uc740 multi-head attention \ub97c \uadfc\uc0ac\ud654\ub41c \ubc29\uc2dd\uc73c\ub85c \uc218\uc815\ud55c\ub2e4. \uc774\ub7ec\ud55c \uc5f0\uad6c\ub4e4\uc740 self-attention \uacc4\uc0b0\uc758 quadratic complexity \uc744 \uc644\ud654\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, Longformer \uc640 BigBird \ub294 sparse attention \ub97c \uc0ac\uc6a9\ud558\uc5ec long sequence \ub97c \ucc98\ub9ac\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub2e4\ub978 \uc5f0\uad6c\ub4e4\uc740 memory \uba54\ucee4\ub2c8\uc998\uc744 \ud65c\uc6a9\ud558\uc5ec past inputs \ub97c compression \ud558\uace0 related tokens \ub97c \uac80\uc0c9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c \uc5f0\uad6c\ub4e4\uc758 \ud55c\uacc4\ub294 compression \uc774 full attention \uacfc \ud070 \ucc28\uc774\uac00 \uc788\uc5b4 pre-trained LLM \uc744 fine-tuning \ud558\ub294 \ub370\uc5d0 \ube44\ud604\uc2e4\uc801\uc774\ub77c\ub294 \uc810\uc774\ub2e4. ")),(0,s.kt)("p",null,"\ube44\ub85d \uc800\uc790\uc758 \uc5f0\uad6c\ub3c4 attention \uba54\ucee4\ub2c8\uc998\uc758 \uadfc\uc0ac\ud654\ub97c \ud3ec\ud568\ud558\uc9c0\ub9cc, standard attention \uacfc \uc720\uc0ac\ud55c \ud615\ud0dc\uc640 \uc791\uc740 \ucc28\uc774\ub97c \uac00\uc9c0\uba70, \uc774\ub294 pre-trained LLM \uc744 S",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc73c\ub85c fine-tuning \ud558\uace0 inference \uc911 full attention \ub97c \uc720\uc9c0\ud560 \uc218 \uc788\uac8c \ud55c\ub2e4."),(0,s.kt)("h4",{id:"long-context-llms"},"Long-context LLMs."),(0,s.kt)("p",null,"LLM \uc740 \uc77c\ubc18\uc801\uc73c\ub85c pre-defined context length \ub85c \ud6c8\ub828\ub41c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, LLaMA \ub294 2048, Llama2 \ub294 4096 tokens \ub97c \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"long context \ub85c LLM \uc744 scratch training \ud558\ub294 \uac83\uc740 \ub300\ubd80\ubd84\uc758 \uc5f0\uad6c\uc790\ub4e4\uc5d0\uac8c\ub294 \ub108\ubb34 \ube44\uc6a9\uc774 \ud06c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ucd5c\uadfc \uba87\uba87 \uc5f0\uad6c\ub4e4\uc740 fine-tuning \uc744 \ud1b5\ud574 LLM \uc758 context length \ub97c \ud655\uc7a5\ud558\ub824\uace0 \uc2dc\ub3c4\ud588\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Position Interpolation \uc740 rotary position encoding \uc744 \uc218\uc815\ud558\uc5ec LLaMA \uc758 context length \ub97c 32768 \ub85c \ud655\uc7a5\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Focused Transformer \uc740 contrastive learning \uc744 \uc0ac\uc6a9\ud558\uc5ec LongLLaMA \ub97c \ud6c8\ub828\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub4e4 \ubaa8\ub450 full fine-tuning \uc5d0 \uc758\uc874\ud558\uba70, \uc774\ub294 \uacc4\uc0b0\uc801\uc73c\ub85c \ube44\uc2f8\ub2e4(training \uc5d0 128 A100 GPU / 128 TPUv3 \uc0ac\uc6a9). "))),(0,s.kt)("li",{parentName:"ul"},"Landmark attention \uc740 efficient approach \uc774\uc9c0\ub9cc \ub2e4\uc18c \uc190\uc2e4\uc774 \uc788\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 long context input \uc744 retrievaled tokens \uc73c\ub85c compression \ud55c\ub2e4. ")))),(0,s.kt)("p",null,"\uc800\uc790\uc758 \ubc29\ubc95\uc740 fine-tuning cost \ub97c \ub300\ud3ed \uc808\uac10\ud558\uba74\uc11c original attention \uc758 \ud488\uc9c8\uc744 \uc720\uc9c0\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc800\uc790\uc758 \ubc29\ubc95\uc740 inference \uc911 entire input \uc5d0 \ub300\ud55c \uc811\uadfc\uc744 \uc720\uc9c0\ud558\uba70, fine-tuning \uc2dc original architecture \ub97c \ubcf4\uc874\ud55c\ub2e4."),(0,s.kt)("p",null,"\uc77c\ubd80 \ubb38\ud5cc\uc740 long context extension \uc744 \uc704\ud55c LLM \uc758 position embeddings \uc218\uc815\uc5d0 \ucd08\uc810\uc744 \ub9de\ucd94\uace0 \uc788\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc5ec\uae30\uc5d0\ub294 Position Interpolation, positional Skipping, \uadf8\ub9ac\uace0 out-of-distribution-based methods \ub4f1\uc774 \ud3ec\ud568\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 \ubc29\ubc95\uc740 efficient fine-tuning \uacfc inference \uc911 original architecture \uc720\uc9c0\uc5d0 \ucd08\uc810\uc744 \ub9de\ucd94\uba70, position embeddings \ubc29\ubc95\ub4e4\uacfc\ub294 orthogonal \ud558\ub2e4.")),(0,s.kt)("h4",{id:"efficient-fine-tuning"},"efficient fine-tuning"),(0,s.kt)("p",null,"\uc774 \uc5f0\uad6c\ub294 LoRA \ub97c \uae30\ubc18\uc73c\ub85c \ud55c\ub2e4."),(0,s.kt)("p",null,"LoRA \uc678\uc5d0\ub3c4 \uc5ec\ub7ec \ub2e4\ub978 parameter efficient fine-tuning \ubc29\ubc95\uc774 \uc788\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc5ec\uae30\uc5d0\ub294 prompt tuning, prefix tuning, hidden state tuning, bias tuning, \uadf8\ub9ac\uace0 masked weight learning \uc774 \ud3ec\ud568\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Input-tuning \uc740 input embeddings \uc744 tuning \ud558\uae30 \uc704\ud574 adapter \ub97c \ub3c4\uc785\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"input embeddings layers \ub3c4 \uc800\uc790\uc758 \ubc29\ubc95\uc5d0\uc11c\ub294 trainable \ud558\uc9c0\ub9cc, long context extension \uc5d0\ub294 \ucda9\ubd84\ud558\uc9c0 \uc54a\ub2e4. ")),(0,s.kt)("p",null,"\uc800\uc790\ub294 \uc2e4\ud5d8\uc5d0\uc11c layer types \uc5d0 \ub300\ud55c \ud3ec\uad04\uc801\uc778 \ubd84\uc11d\uc744 \uc218\ud589\ud558\uc600\ub2e4(Tab. 2). "),(0,s.kt)("p",null,"\uae30\uc874 \uc5f0\uad6c\ub294 sparse mask \uac00 training cost \ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc808\uac10\ud558\uace0 \uc131\ub2a5 \uc800\ud558\ub97c \ubc29\uc9c0\ud560 \uc218 \uc788\uc74c\uc744 \ubcf4\uc5ec\uc900\ub2e4."),(0,s.kt)("h1",{id:"3-longlora"},"3 LongLoRA"),(0,s.kt)("h2",{id:"31-background"},"3.1 Background"),(0,s.kt)("h4",{id:"transformer"},"transformer"),(0,s.kt)("p",null,"LLM \uc740 \uc77c\ubc18\uc801\uc73c\ub85c transformer \ub97c \uae30\ubc18\uc73c\ub85c \uad6c\ucd95\ub41c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Llama2 \ub97c \ubcf4\uba74, LLM model \uc740 embedding input layer \uacfc \uc5ec\ub7ec decoder layers \ub85c \uad6c\uc131\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uac01 decoder layers \ub294 self-attention module \uc744 \ud3ec\ud568\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 module \uc740 input features \ub97c query, key, value set ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"{"),(0,s.kt)("mi",{parentName:"mrow"},"q"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"k"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"v"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"}")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\{q, k, v\\}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"{"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"v"),(0,s.kt)("span",{parentName:"span",className:"mclose"},"}")))))," \ub85c mapping \ud558\uc5ec, linear projection layers \uc640 weight matrices ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"{"),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"q")),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"k")),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"v")),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"}")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\{W_q, W_k, W_v\\}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"{"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"q")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"v")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mclose"},"}")))))," \ub97c \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"{"),(0,s.kt)("mi",{parentName:"mrow"},"q"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"k"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"v"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"}")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\{q, k, v\\}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"{"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"v"),(0,s.kt)("span",{parentName:"span",className:"mclose"},"}")))))," \ub97c \uc8fc\uc5b4\uc9c4 \ud6c4, output ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"o")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"o")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"o")))))," \ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uacc4\uc0b0\ub41c\ub2e4:")),(0,s.kt)("div",{className:"math math-display"},(0,s.kt)("span",{parentName:"div",className:"katex-display"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mtable",{parentName:"semantics",rowspacing:"0.16em",columnspacing:"1em"},(0,s.kt)("mtr",{parentName:"mtable"},(0,s.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,s.kt)("mtd",{parentName:"mtr"},(0,s.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,s.kt)("mrow",{parentName:"mstyle"},(0,s.kt)("mi",{parentName:"mrow"},"o"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mtext",{parentName:"mrow"},"softmax"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"q"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"k"),(0,s.kt)("mi",{parentName:"msup"},"T")),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mi",{parentName:"mrow"},"v")))),(0,s.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,s.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"}))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\begin{equation} o = \\text{softmax}(qk^T)v \\end{equation}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.2513em",verticalAlign:"-0.3757em"}}),(0,s.kt)("span",{parentName:"span",className:"mtable"},(0,s.kt)("span",{parentName:"span",className:"col-align-c"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8757em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.9843em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"o"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"softmax")),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"q"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8913em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"T")))))))),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"v")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3757em"}},(0,s.kt)("span",{parentName:"span"}))))))),(0,s.kt)("span",{parentName:"span",className:"tag"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8757em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.8757em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.8913em"}}),(0,s.kt)("span",{parentName:"span",className:"eqn-num"}))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3757em"}},(0,s.kt)("span",{parentName:"span"}))))))))),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"output \uc740 linear layer \uc640 weight matrix ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"o"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W_o")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"o")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"}))))))))))," \ub97c \ud1b5\ud574 projection \ub41c\ub2e4. \uadf8 \ud6c4 MLP layers \uac00 \uc774\uc5b4\uc9c4\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"self-attention module \uc804\ud6c4\uc5d0 layer normalization \uac00 \uc801\uc6a9\ub418\uba70, \ubaa8\ub4e0 decoder layers \ud6c4\uc5d0 final normalization \uac00 \uc218\ud589\ub41c\ub2e4.")),(0,s.kt)("p",null,"long sequence \uc758 \uacbd\uc6b0, self-attention \ub294 computation cost \uc774 quadratic \uc5d0 \ube44\ub840\ud558\uc5ec \ubb38\uc81c\ub97c \uacaa\ub294\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub294 training procedure \ub97c \uadf9\uc801\uc73c\ub85c \ub2a6\ucd94\uace0 GPU memory costs \ub97c \uc99d\uac00\uc2dc\ud0a8\ub2e4."),(0,s.kt)("h4",{id:"low-rank-adaptation"},"Low-rank Adaptation"),(0,s.kt)("p",null,"LoRA \ub294 pre-trained model \uc758 weights update \uac00 adaptation \uc911\uc5d0 low intrinsic rank \ub97c \uac00\uc9c4\ub2e4\uace0 \uac00\uc815\ud55c\ub2e4. "),(0,s.kt)("p",null,"pre-trained weight matrix ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"W"),(0,s.kt)("mo",{parentName:"mrow"},"\u2208"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup",mathvariant:"double-struck"},"R"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mi",{parentName:"mrow"},"d"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mi",{parentName:"mrow"},"k")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W \\in \\mathbb{R}^{d \\times k}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7224em",verticalAlign:"-0.0391em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathbb"},"R"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"d"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))))))))))))," \ub294 low-rank decomposition ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"W"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u0394"),(0,s.kt)("mi",{parentName:"mrow"},"W"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mi",{parentName:"mrow"},"W"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"B"),(0,s.kt)("mi",{parentName:"mrow"},"A")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W + \\Delta W = W + BA")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"\u0394"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7667em",verticalAlign:"-0.0833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"A")))))," \ub85c \uc5c5\ub370\uc774\ud2b8\ub41c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"B"),(0,s.kt)("mo",{parentName:"mrow"},"\u2208"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup",mathvariant:"double-struck"},"R"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mi",{parentName:"mrow"},"d"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mi",{parentName:"mrow"},"r")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B \\in \\mathbb{R}^{d \\times r}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7224em",verticalAlign:"-0.0391em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathbb"},"R"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"d"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}},"r")))))))))))))," \ubc0f ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"A"),(0,s.kt)("mo",{parentName:"mrow"},"\u2208"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup",mathvariant:"double-struck"},"R"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mi",{parentName:"mrow"},"r"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mi",{parentName:"mrow"},"k")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"A \\in \\mathbb{R}^{r \\times k}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7224em",verticalAlign:"-0.0391em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathbb"},"R"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02778em"}},"r"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))))))))))))),(0,s.kt)("li",{parentName:"ul"},"rank ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"r"),(0,s.kt)("mo",{parentName:"mrow"},"\u226a"),(0,s.kt)("mtext",{parentName:"mrow"},"min"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"d"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"k"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"r \\ll \\text{min}(d, k)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.5782em",verticalAlign:"-0.0391em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"r"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u226a"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"min")),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"d"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03148em"}},"k"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))),(0,s.kt)("li",{parentName:"ul"},"training \uc911\uc5d0\ub294 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"W")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W")))))," \ub294 \uace0\uc815\ub418\uba70 gradient updates \uac00 \uc5c6\uace0, ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"A")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"A")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"A")))))," \uc640 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"B")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B")))))," \ub9cc learnable.",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 LoRA training \uc774 full fine-tuning \ubcf4\ub2e4 \ud6e8\uc52c efficient \uc774\uc720\uc774\ub2e4.")))),(0,s.kt)("p",null,"transformer \uad6c\uc870\uc5d0\uc11c\ub294 LoRA \uac00 attention weights (",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"q"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W_q")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.9694em",verticalAlign:"-0.2861em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"q")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2861em"}},(0,s.kt)("span",{parentName:"span"})))))))))),", ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"k"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W_k")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3361em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),", ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"v"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W_v")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"v")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),", ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"W"),(0,s.kt)("mi",{parentName:"msub"},"o"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W_o")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8333em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"o")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),")\ub9cc \uc801\uc751\ud558\uace0, MLP \ubc0f normalization layers \ub97c \ud3ec\ud568\ud55c \ub2e4\ub978 all layers \ub294 \uace0\uc815\ub41c\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c \ubc29\uc2dd\uc740 simple \ubc0f parameter efficient \uc774\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098, \uc800\uc790\ub294 attention weights \uc5d0 \ub300\ud55c low-rank adaptation \ub9cc\uc73c\ub85c\ub294 long context extension \uc774 \uc798 \uc791\ub3d9\ud558\uc9c0 \uc54a\uc74c\uc744 \uacbd\ud5d8\uc801\uc73c\ub85c \ubcf4\uc5ec\uc900\ub2e4."),(0,s.kt)("h2",{id:"32-shifted-sparse-attention"},"3.2 Shifted Sparse Attention"),(0,s.kt)("p",null,"standard self-attention \ub294 ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"O"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"n"),(0,s.kt)("mn",{parentName:"msup"},"2")),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"O(n^2)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.0641em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"O"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))," \uc758 computation cost \uac00 \ub4dc\ubbc0\ub85c, long sequence \uc5d0\uc11c LLM \uc758 memory costs \uc774 \ub192\uace0 \uc18d\ub3c4\uac00 \ub290\ub824\uc9c4\ub2e4. "),(0,s.kt)("p",null,"\uc774 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574, \uc800\uc790\ub294 Shifted Sparse Attention (S",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn)\uc744 \uc81c\uc548\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774 \ubc29\uc2dd\uc740 Fig. 2 \uc5d0 \ub098\ud0c0\ub098 \uc788\ub2e4."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 2",src:e(11960).Z,width:"1614",height:"795"})),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 3",src:e(21004).Z,width:"1635",height:"723"})),(0,s.kt)("h4",{id:"pilot-study"},"Pilot Study."),(0,s.kt)("p",null,"Tab. 1 \uc5d0\uc11c full attention \uacfc fine-tuning \uc744 \uc0ac\uc6a9\ud558\uc5ec \ud6c8\ub828\ud558\uace0 \ud14c\uc2a4\ud2b8\ud55c standard baseline model \uc744 \uad6c\ucd95\ud558\uc600\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 1",src:e(56801).Z,width:"1594",height:"483"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774 model \uc740 \ub2e4\uc591\ud55c context length \uc5d0\uc11c \uc77c\uad00\ub418\uac8c \uc88b\uc740 \ud488\uc9c8\uc744 \ubcf4\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uccab \ubc88\uc9f8 \uc2dc\ub3c4\ub294 short attention, \uc989 Fig. 2 \uc758 ",(0,s.kt)("em",{parentName:"li"},"pattern")," 1 \ub9cc\uc744 \uc0ac\uc6a9\ud558\uc5ec \ud6c8\ub828\ud558\ub294 \uac83\uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"long context \uc758 \uacbd\uc6b0, high cost \ub294 \uc8fc\ub85c self-attention module \uc5d0\uc11c \ubc1c\uc0dd\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ub530\ub77c\uc11c \uc774 \uc2dc\ub3c4\uc5d0\uc11c\ub294 input \uc774 \uae38\uc5b4 \uc5ec\ub7ec groups \ub85c \ub098\ub204\uc5b4 self-attention \ub97c \uc218\ud589\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, model \uc740 training \uacfc test \ub2e8\uacc4\uc5d0\uc11c 8192 tokens \ub97c input \uc73c\ub85c \uc0ac\uc6a9\ud558\uc9c0\ub9cc, self-attention \ub294 \uac01 group \uc5d0\uc11c 2048 size \ub85c \uc218\ud589\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"group \uc218\ub294  4 \uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 pattern \uc740 \ud6a8\uc728\uc801\uc774\uc9c0\ub9cc very long context \uc5d0\uc11c\ub294 \uc5ec\uc804\ud788 \uc791\ub3d9\ud558\uc9c0 \uc54a\ub294\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"Tab. 1 \uc5d0\uc11c \ubcfc \uc218 \uc788\ub4ef\uc774, context length \uac00 \uc99d\uac00\ud568\uc5d0 \ub530\ub77c perplexity \uac00 \ucee4\uc9c4\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uadf8 \uc774\uc720\ub294 \uc11c\ub85c \ub2e4\ub978 group \uac04\uc758 information exchange \uc774 \uc5c6\uae30 \ub54c\ubb38\uc774\ub2e4.")))),(0,s.kt)("p",null,"information exchange \ub3c4\uc785\uc744 \uc704\ud574, Fig. 2 \uc5d0 \ub098\ud0c0\ub09c shifted pattern \uc744 \ud3ec\ud568\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 group partition \uc744 half self-attention head \uc5d0\uc11c half group size \ub9cc\ud07c shift \ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"8192 context length \ub97c \uc608\ub85c, pattern 1 \uc5d0\uc120 first group \uc774 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"msup"},"1"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mi",{parentName:"mrow"},"s"),(0,s.kt)("mi",{parentName:"mrow"},"t")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"1^{st}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7936em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"1"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.7936em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"s"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t")))))))))))))," \uc5d0\uc11c ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"204"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"msup"},"8"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mi",{parentName:"mrow"},"t"),(0,s.kt)("mi",{parentName:"mrow"},"h")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2048^{th}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"204"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"8"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h")))))))))))))," tokens \uae4c\uc9c0 self-attention \ub97c \uc218\ud589\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"pattern 2 \uc5d0\uc120 group partition \uc774 1024 \ub9cc\ud07c shift \ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"first attention group \uc740 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"102"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"msup"},"5"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mi",{parentName:"mrow"},"t"),(0,s.kt)("mi",{parentName:"mrow"},"h")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"1025^{th}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"102"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"5"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h")))))))))))))," \uc5d0\uc11c ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"307"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"msup"},"2"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mi",{parentName:"mrow"},"t"),(0,s.kt)("mi",{parentName:"mrow"},"h")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"3072^{th}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8491em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"307"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"2"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"t"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"h")))))))))))))," tokens \uae4c\uc9c0 \uc2dc\uc791\ub418\uba70, first \uc640 last 1024 tokens \ub294 \ub3d9\uc77c\ud55c group \uc5d0 \uc18d\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 pattern 1 \uacfc 2 \ub97c \uac01\uac01 half self-attention head \uc5d0\uc11c \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\uc2dd\uc740 additional computation cost \ub97c \uc99d\uac00\uc2dc\ud0a4\uc9c0 \uc54a\uc73c\uba74\uc11c\ub3c4 \uc11c\ub85c \ub2e4\ub978 group \uac04\uc758 information flow \ub97c \uac00\ub2a5\ud558\uac8c \ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\uc2dd\uc774 standard attention baseline \uc5d0 \uac00\uae4c\uc6b4 \uacb0\uacfc\ub97c \uc5bb\ub294\ub2e4\uace0 \ubcf4\uc5ec\uc900\ub2e4.")),(0,s.kt)("h4",{id:"consistency-to-full-attention"},"Consistency to Full Attention."),(0,s.kt)("p",null,"\uae30\uc874 efficient attention \uc124\uacc4\ub294 long context LLM \uc758 \ud6a8\uc728\uc131\uc744 \ud5a5\uc0c1\uc2dc\ud0ac \uc218 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 \ub300\ubd80\ubd84\uc740 long context fine-tuning \uc5d0 \uc801\ud569\ud558\uc9c0 \uc54a\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c transformer \ub294 scratch training \ud558\uae30 \uc704\ud574 \uc124\uacc4\ub418\uc5c8\uae30 \ub54c\ubb38\uc5d0 pre-training \uc5d0\uc11c \uc0ac\uc6a9\ub418\ub294 standard full attention \uacfc \ucc28\uc774\uac00 \uc788\uae30 \ub54c\ubb38\uc774\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Tab. 6 \uc5d0\uc120 S",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc774 efficient fine-tuning \uc744 \uac00\ub2a5\ud558\uac8c \ud560 \ubfd0\ub9cc \uc544\ub2c8\ub77c full attention test \ub3c4 \uc9c0\uc6d0\ud568\uc744 \ubcf4\uc5ec\uc900\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub2e4\ub978 attention \ubc29\uc2dd\ub3c4 long context fine-tuning \uc5d0 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc9c0\ub9cc, model \uc740 fine-tuning \uc911\uc5d0 \uc0ac\uc6a9\ub41c attention \ubc29\uc2dd\uc73c\ub85c\ub9cc \ud14c\uc2a4\ud2b8\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"shift \ubc29\uc2dd\uc740 model \uc774 specific attention pattern \uc5d0 over-fitting \ub428\uc744 \ubc29\uc9c0\ud55c\ub2e4.")),(0,s.kt)("h4",{id:"easy-implementation"},"Easy Implementation."),(0,s.kt)("p",null,"S",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msup"}),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc740 \uad6c\ud604\uc774 \uc27d\ub2e4. \ub450 \uac00\uc9c0 \ub2e8\uacc4\ub9cc \ud3ec\ud568\ub41c\ub2e4: (1) half self-attention head \uc5d0\uc11c tokens shift, (2) token dimension \uc5d0\uc11c batch dimension \uc73c\ub85c feature transposing. "),(0,s.kt)("p",null,"\ub450 \uc904\uc758 \ucf54\ub4dc\uba74 \ucda9\ubd84\ud558\ub2e4. \uc800\uc790\ub294 Algorithm 1 \uc5d0\uc11c PyTorch style \uc758 \ucf54\ub4dc\ub97c \uc81c\uacf5\ud55c\ub2e4."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Algorithm 1",src:e(69149).Z,width:"1709",height:"624"})),(0,s.kt)("h3",{id:"33-long-context-\ub97c-\uc704\ud55c-\uac1c\uc120\ub41c-lora"},"3.3 long context \ub97c \uc704\ud55c \uac1c\uc120\ub41c LoRA"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 2",src:e(94682).Z,width:"1585",height:"521"})),(0,s.kt)("p",null,"LoRA \ub294 LLM \uc744 \ub2e4\ub978 dataset \uc5d0 \uc801\uc751\uc2dc\ud0a4\uae30 \uc704\ud55c \ud6a8\uc728\uc801\uc774\uace0 \uc778\uae30 \uc788\ub294 \ubc29\ubc95\uc774\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub294 full fine-tuning \ubcf4\ub2e4 trainable parameters \uc640 memory costs \ub97c \ud06c\uac8c \uc808\uac10\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 short context length \uc5d0\uc11c long context \ub85c LLM \uc744 \uc801\uc751\uc2dc\ud0a4\ub294 \uac83\uc740 \uc27d\uc9c0 \uc54a\ub2e4. "),(0,s.kt)("p",null,"\uc800\uc790\ub294 LoRA \uc640 full fine-tuning \uac04\uc758 \uba85\ubc31\ud55c \ucc28\uc774\ub97c \uacbd\ud5d8\uc801\uc73c\ub85c \uad00\ucc30\ud588\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Tab. 2 \ucc98\ub7fc, LoRA \uc640 full fine-tuning \uac04\uc758 \ucc28\uc774\ub294 target context length \uac00 \ucee4\uc9c8\uc218\ub85d \ucee4\uc9c4\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uadf8\ub9ac\uace0 larger rank \ub97c \uac00\uc9c4 LoRA \ub3c4 \uc774 \ucc28\uc774\ub97c \uc904\uc77c \uc218 \uc5c6\ub2e4.")),(0,s.kt)("h1",{id:"4-experiment"},"4 Experiment"),(0,s.kt)("h2",{id:"41-experimental-settings"},"4.1 Experimental Settings"),(0,s.kt)("h4",{id:"models"},"Models"),(0,s.kt)("p",null,"\uc800\uc790\ub294 pre-trained 7B, 13B, 70B Llama2 model \uc744 \ud655\uc7a5\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"maximum extended context windows size \ub294 7B model \uc758 \uacbd\uc6b0 100k, 13B model \uc758 \uacbd\uc6b0 65536, 70B model \uc758 \uacbd\uc6b0 32768 \uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 model \ub4e4\uc5d0 \ub300\ud55c position index \ub294 Position Interpolation \uc73c\ub85c \uc7ac\uc870\uc815\ub41c\ub2e4.")),(0,s.kt)("h4",{id:"training-procedure"},"Training Procedure"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 Position Interpolation \uc5d0\uc11c \ub300\ubd80\ubd84\uc758 training hyper-parameters \ub97c \ub530\ub974\uc9c0\ub9cc, \uc77c\ubd80 \uacbd\uc6b0\uc5d0\ub294 single 8\xd7 A100 GPU \uc744 \uc0ac\uc6a9\ud558\ubbc0\ub85c batch size \uac00 \ub354 \uc791\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"all model \uc740 next tokens prediction objective \ub97c \ud1b5\ud574 fine-tuning \ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"AdamW \ub97c \uc0ac\uc6a9\ud558\uba70, ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"\u03b2"),(0,s.kt)("mn",{parentName:"msub"},"1")),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"0.9")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta_1 = 0.9")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0528em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.9")))))," \uc640 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"\u03b2"),(0,s.kt)("mn",{parentName:"msub"},"2")),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"0.95")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta_2 = 0.95")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"-0.0528em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"0.95")))))," \ub97c \uc124\uc815\ud55c\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"learning rate \ub294 7B \ubc0f 13B model \uc5d0\ub294 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"2"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mn",{parentName:"mrow"},"1"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"msup"},"0"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mo",{parentName:"mrow"},"\u2212"),(0,s.kt)("mn",{parentName:"mrow"},"5")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2 \\times 10^{-5}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"2"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"0"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"5"))))))))))))),", 70B model \uc5d0\ub294 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mn",{parentName:"mrow"},"1"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"msup"},"0"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mo",{parentName:"mrow"},"\u2212"),(0,s.kt)("mn",{parentName:"mrow"},"5")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"10^{-5}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1"),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord"},"0"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"5")))))))))))))," \ub85c \uc124\uc815\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c linear learning rate warmup \uc744 \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"weights decay \ub294 0 \uc73c\ub85c \uc124\uc815\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"per-device batch size \ub294 1 \ub85c \uc124\uc815\ud558\uace0, gradient accumulation step \uc740 8 \ub85c \uc124\uc815\ud558\uc5ec, 8 GPUs \ub97c \uc0ac\uc6a9\ud560 \ub54c global batch size \ub294 64 \uac00 \ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 model \uc744 1000 steps \ub3d9\uc548 \ud6c8\ub828\ud55c\ub2e4.")),(0,s.kt)("h4",{id:"dataset"},"Dataset"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 Redpajama dataset \uc744 training \uc5d0 \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 fine-tuned model \uc758 long sequence language modeling \uc131\ub2a5\uc744 \ud3c9\uac00\ud558\uae30 \uc704\ud574, book corpus dataset \uc778 PG19 \uc640 cleaned Arxiv Math proof-pile dataset \uc5d0\uc11c \ud3c9\uac00\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"PG19 \uc758 test split \uc744 \uc0ac\uc6a9\ud558\uba70, \uc774 split \uc740 100 documents \ub85c \uad6c\uc131\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"proof-pile dataset \uc758 \uacbd\uc6b0, \uc774 dataset \uc758 test split \uc744 \ud3c9\uac00\uc5d0 \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"proof-pile data preprocessing \uc5d0\ub294 Position Interpolation \uc744 \ub530\ub978\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 sliding window approach \ub97c \uc0ac\uc6a9\ud558\uc5ec perplexity \ub97c \ud3c9\uac00\ud558\uba70, ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"S"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"256")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"S = 256")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"256")))))," \uc744 \ub530\ub978\ub2e4.")),(0,s.kt)("h2",{id:"42-main-results"},"4.2 Main Results"),(0,s.kt)("h4",{id:"long-sequence-language-modeling"},"Long-sequence Language Modeling."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 3",src:e(24714).Z,width:"1589",height:"1035"})),(0,s.kt)("p",null,"Tab. 3 \uc5d0\uc11c proof-pile \uacfc PG19 dataset \uc5d0\uc11c model \uacfc baseline \uc758 perplexity \ub97c \ubcf4\uace0\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\ud2b9\uc815 training context length \uc5d0\uc11c, \uc800\uc790\uc758 model \uc740 longer context sizes \ub85c \ub354 \ub098\uc740 perplexity \ub97c \ub2ec\uc131\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 \uc800\uc790\uc758 efficient fine-tuning \ubc29\ubc95\uc758 \ud6a8\uacfc\ub97c \ub098\ud0c0\ub0b8\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\ub3d9\uc77c\ud55c training \ubc0f evaluation context length \uc758 \uacbd\uc6b0, context sizes \uac00 \uc99d\uac00\ud568\uc5d0 \ub530\ub77c perplexity \uac00 \uac10\uc18c\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, Llama2 7B model \uc758 \uacbd\uc6b0, context window size \ub97c 8192 \uc5d0\uc11c 32768 \ub85c \uc99d\uac00\uc2dc\ud0a4\uba74 perplexity \uac00 2.72 \uc5d0\uc11c 2.50 \uc73c\ub85c -0.22 \uac10\uc18c\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Llama2 13B model \uc758 \uacbd\uc6b0, perplexity \uac00 -0.28 \uac10\uc18c\ud55c\ub2e4.")))),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 4",src:e(49220).Z,width:"1594",height:"530"})),(0,s.kt)("p",null,"Tab. 4 \uc5d0\uc11c\ub294 single 8\xd7 A100 \uc5d0\uc11c fine-tuning \ud560 \uc218 \uc788\ub294 maximum context length \ub97c \ucd94\uac00\ub85c \uc870\uc0ac\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Llama2 7B, 13B, \ubc0f 70B \ub97c \uac01\uac01 100k, 65536, \ubc0f 32768 context length \ub85c \ud655\uc7a5\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 \uc774\ub7ec\ud55c \uadf9\ub2e8\uc801\uc73c\ub85c \ud070 \uc124\uc815\uc5d0\uc11c \uc720\ub9dd\ud55c \uacb0\uacfc\ub97c \uc5bb\ub294\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, extended model \uc5d0\uc11c \uc791\uc740 context sizes \uc5d0\uc11c \uc57d\uac04\uc758 perplexity \uc800\ud558\ub97c \ubc1c\uacac\ud588\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 Position Interpolation \uc758 \uc54c\ub824\uc9c4 \ud55c\uacc4\uc774\ub2e4.")),(0,s.kt)("h4",{id:"retrieval-based-evaluation"},"Retrieval-based Evaluation."),(0,s.kt)("p",null,"long context \uc5d0\uc11c Retrieval experiments \ub97c \uc218\ud589\ud558\uc600\ub2e4. "),(0,s.kt)("p",null,"Tab. 5 \uc5d0\uc11c\ub294 LongChat \uc5d0\uc11c \ub3c4\uc785\ub41c topic retrieval task \uc5d0\uc11c \ub2e4\ub978 open LLM \uacfc \uc800\uc790\uc758 model \uc744 \ube44\uad50\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774 task \ub294 \ub9e4\uc6b0 long chat \uc5d0\uc11c target topic \uc744 \uac80\uc0c9\ud558\ub294 \uac83\uc774\uba70, length \ub294 3k, 6k, 10k, 13k, 16k \ub85c \ubcc0\ub3d9\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"LongChat \uc758 \uc77c\ubd80 question \uc774 16k \ub97c \ucd08\uacfc\ud558\ubbc0\ub85c, 18k context length \ub85c Llama2 13B \ub97c fine-tuning \ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"training cost \ub294 16k \uc640 \uc720\uc0ac\ud558\ub2e4. ")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 5",src:e(62207).Z,width:"1597",height:"574"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 model \uc740 \uc774 \uc791\uc5c5\uc5d0\uc11c SOTA model \uc778 LongChat-13B \uc640 \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \ub2ec\uc131\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"LongChat-13B \ub294 self-collected long context conversation text \uc5d0\uc11c fully fine-tuned \ubc18\uba74, \uc800\uc790\uc758 model \uc740 next tokens generation \ubc29\uc2dd\uc744 \ud1b5\ud574 RedPajama \uc5d0\uc11c \ud6a8\uc728\uc801\uc73c\ub85c \uc801\uc751\ub418\uc5c8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 model \uc740 16k evaluation \uc5d0\uc11c LongChat-13B \ub97c \uc57d\uac04 \ucd08\uacfc\ud55c\ub2e4.")),(0,s.kt)("p",null,"Fig. 4 \uc5d0\uc120 Landmark Attention \uc744 \ub530\ub974\ub294 passkey retrieval accuracy \ub97c \uc81c\uc2dc\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"model \uc740 long documents \uc5d0\uc11c random passkey \ub97c \ucc3e\ub294 \ud544\uc694\uac00 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 Llama2 7B \uc640 32768 context length \ub85c fine-tuned LongLoRA model \uc744 \uc5f0\uad6c\ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"passkey retrieval accuracy \ub97c 1k to 34k, \ub300\ub7b5 1k \uac04\uaca9\uc73c\ub85c \ud14c\uc2a4\ud2b8\ud558\uc600\ub2e4 (sentence length \ub97c \uc815\ubc00\ud558\uac8c \uc870\uc808\ud560 \uc218 \uc5c6\uae30 \ub54c\ubb38\uc5d0). "),(0,s.kt)("li",{parentName:"ul"},"\uac01 document length \uc5d0 \ub300\ud574 model \uc744 10 \ubc88 \ud14c\uc2a4\ud2b8\ud558\uba70, random passkey value \uac00 \ub2e4\ub974\ub2e4. ")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 4",src:e(26395).Z,width:"1621",height:"648"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 model \uc740 33k \ub610\ub294 34k \uae4c\uc9c0 \ud569\ub9ac\uc801\uc778 passkey retrieval accuracy \ub97c \ub2ec\uc131\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ucd94\uac00 fine-tuning \uc5c6\uc774, max position embeddings \uc744 48k \ub85c \uc218\uc815\ud558\uc5ec position interpolation \uc744 \ud655\uc7a5\ud55c model \uc774 \uc788\ub2e4. \uc774\ub294 Fig. 4 \uc758 Ours 7B (extended PI)\ub85c \ub098\ud0c0\ub0b8\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774 model \uc740 position interpolation \uc744 \ub2e8\uc21c\ud788 \ud655\uc7a5\ud558\uc5ec longer documents \ub97c \ucc98\ub9ac\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Fig. 4 \uc758 \uc8fc\ud669\uc0c9 \uc810\uc120\ucc98\ub7fc, 32k context length \ub85c fine-tuned model \uc740 33k to 45k range \uc5d0\uc11c \uc911\uac04 \uc815\ub3c4\uc758 \uac80\uc0c9 \ub2a5\ub825\uc744 \ubcf4\uc778\ub2e4(60%-90% \uc815\ud655\ub3c4)."))),(0,s.kt)("li",{parentName:"ul"},"position interpolation \uc744 \ud655\uc7a5\ud558\ub354\ub77c\ub3c4, Llama2 7B \ub294 4k context length \uc774\ud6c4\uc5d0 \uae09\uaca9\ud55c \uc815\ud655\ub3c4 \uc800\ud558\ub97c \uacaa\ub294\ub2e4 (\ud30c\ub780\uc0c9 \uc810\uc120).")),(0,s.kt)("h2",{id:"43-ablation-study"},"4.3 Ablation Study"),(0,s.kt)("h4",{id:"ablation-on-fine-tuning-steps"},"Ablation on Fine-tuning Steps."),(0,s.kt)("p",null,"Fig. 5 \uc5d0\uc11c\ub294 PG19 validation set \uc5d0\uc11c 8192 context length \ub85c extended Llama2 7B model \uc758 perplexity \uc640 fine-tuning \ub2e8\uacc4 \uac04\uc758 \uad00\uacc4\ub97c \ubcf4\uace0\ud55c\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 5",src:e(51322).Z,width:"1619",height:"637"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"fine-tuning \uc5c6\uc774, step 0 \uc5d0\uc11c model \uc758 long context \ub2a5\ub825\uc740 \uc81c\ud55c\uc801\uc774\ub2e4(e.g., 15.82 perplexity). "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 perplexity \uac00 \ube60\ub974\uac8c \uac10\uc18c\ud558\ub294 \uac83\uc744 \ubcf4\uc5ec\uc900\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"full fine-tuning \uc740 low-rank training \ubcf4\ub2e4 \ub354 \ube60\ub974\uac8c \uc218\ub834\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub450 \ubc29\ubc95\uc740 200 steps \ud6c4\uc5d0 \uac00\uae4c\uc6cc\uc9c0\uba70, \ub05d\uc5d0\uc11c\ub294 \ud070 \ucc28\uc774\uac00 \uc5c6\ub2e4.")),(0,s.kt)("h4",{id:"attention-patterns"},"Attention Patterns"),(0,s.kt)("p",null,"Tab. 6 \uc5d0\uc11c\ub294 fine-tuning \ub3d9\uc548 \ub2e4\uc591\ud55c attention pattern \uc758 \uc601\ud5a5\uc744 \ubcf4\uc5ec\uc900\ub2e4."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 Llama2 7B model \uc744 32768 context length \ub85c fine-tuning \ud558\uace0 PG19 validation set \uc5d0\uc11c perplexity \ub97c \ud3c9\uac00\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 \ub2e4\uc591\ud55c \uc124\uc815 \uac04\uc758 exchange \ubc29\uc2dd\uc744 \uc870\uc0ac\ud55c\ub2e4.")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 6",src:e(64453).Z,width:"1606",height:"698"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"LongLoRA \uc5d0\uc11c \uc0ac\uc6a9\ud55c shift \uc5f0\uc0b0\uc758 \uacbd\uc6b0, \uc138 \uac00\uc9c0 \uc120\ud0dd\uc774 \uc788\ub2e4: disabling, sequential layers \uac04\uc758 shifting, attention head \uac04\uc758 shifting.",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"layers \uac04 shifting \uc740 \ud5c8\uc6a9\ub418\uc9c0\ub9cc \ucd5c\uc120\uc740 \uc544\ub2c8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, all attention head \ub97c pattern 1 \ub610\ub294 pattern 2 \ub85c \uc124\uc815\ud558\ub294 \uac83\uc740 \uc791\ub3d9\ud558\uc9c0 \uc54a\ub294\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"left or right shifting \uc740 \uc131\ub2a5 \ucc28\uc774\uac00 \ubbf8\ubbf8\ud558\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 \ub610\ud55c dilated attention, block sparse attention, stride sparse attention \ub4f1\uc758 \ub2e4\ub978 efficient attention \uc124\uacc4\ub97c \ud14c\uc2a4\ud2b8\ud558\uc600\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"dilated attention \uc5d0\uc120 attention head \uac04\uc5d0 dilate rate \ub97c 1 to 2 \ub85c \uade0\uc77c\ud558\uac8c \ubcc0\ub3d9\uc2dc\ucf30\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"block sparse attention \uc5d0\uc11c\ub294 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"4")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"n = 4")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"4")))))," block-wise masking matrix \ub97c \uc0ac\uc6a9\ud558\uace0 block \uc744 left shifting \ud558\uc5ec \uc6d0\uc778\uc801 \ubc29\uc2dd\uc73c\ub85c \ub9cc\ub4e4\uc5c8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"stride sparse attention \uc740 local \ubc0f stride pattern \uc744 \ud3ec\ud568\ud55c\ub2e4. \uc774\ub7ec\ud55c \uc124\uc815\uc740 \uc720\uc0ac\ud55c computation cost \uc744 \uacf5\uc720\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c pattern \uc740 training-fromscratch transformers \uc5d0\uc11c \ubc1c\uba85\ub418\uc5c8\ub2e4. "))))),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc2e4\ud5d8\uc740 pre-trained LLM \uc5d0\uc11c long context adaptation \uc744 \uc704\ud55c \uc774\ub4e4\uc758 \ub2a5\ub825\uc744 \uc870\uc0ac\ud558\uae30 \uc704\ud568\uc774\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"dilated attention \uc740 full fine-tuning \uc5d0\uc11c \uc798 \uc791\ub3d9\ud558\uc9c0\ub9cc low-rank adaptation \uc5d0\ub294 \uc798 \ub9de\uc9c0 \uc54a\ub294\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"stride sparse attention \uc73c\ub85c fine-tuning \ud558\ub294 \uac83\uc740 \ud574\ub86d\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub4e4\uc740 full attention \uacfc \ud070 \ucc28\uc774\ub97c \ubcf4\uc774\uba70, \uc774\ub294 pre-training \ub2e8\uacc4\uc5d0\uc11c \uc801\uc6a9\ub41c\ub2e4.")))),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 7",src:e(80244).Z,width:"1336",height:"981"})),(0,s.kt)("h3",{id:"5-\uacb0\ub860"},"5 \uacb0\ub860"),(0,s.kt)("p",null,"\uc774 \uc5f0\uad6c\uc5d0\uc11c\ub294 LLM \uc758 context length \ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ud655\uc7a5\ud560 \uc218 \uc788\ub294 LongLoRA \ub97c \uc81c\uc548\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 standard full fine-tuning \ubcf4\ub2e4 GPU memory costs \uacfc training time \uc744 \ub35c \uc18c\ubaa8\ud558\uba70, accuracy loss \ub97c \ucd5c\uc18c\ud654\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"architecture-level \uc5d0\uc11c, \uc800\uc790\ub294 training \uc911 standard self-attention pattern \uc744 \uadfc\uc0ac\ud654\ud558\uae30 \uc704\ud574 ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"S"),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"S^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc744 \uc81c\uc548\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"S"),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"S^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc740 \uad6c\ud604\uc774 \uc27d\uace0 \ucf54\ub4dc \ub450 \uc904\ub9cc \ud544\uc694\ud558\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"S"),(0,s.kt)("mn",{parentName:"msup"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"S^2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"S"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"-Attn \uc73c\ub85c \ud6c8\ub828\ub41c model \uc740 inference \uc911\uc5d0\ub3c4 original standard attention architecture \ub97c \uc720\uc9c0\ud558\ubbc0\ub85c \ub300\ubd80\ubd84\uc758 \uae30\uc874 \uc778\ud504\ub77c\uc640 \ucd5c\uc801\ud654\ub97c \uc7ac\uc0ac\uc6a9\ud560 \uc218 \uc788\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"training-level \uc5d0\uc11c, \uc800\uc790\ub294 LoRA \uc640 full fine-tuning \uac04\uc758 gap \uc744 trainable normalization \ubc0f embeddings \uc73c\ub85c \uc5f0\uacb0\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 \ubc29\ubc95\uc740 single 8\xd7 A100 \uc5d0\uc11c Llama2 7B \ub97c 100k context length \ub85c, 70B model \uc744 32k context length \ub85c \ud655\uc7a5\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, long instruction dataset \uc778 LongAlpaca \ub97c \uc81c\uc2dc\ud558\uace0 LongLoRA \ub97c \uc0ac\uc6a9\ud558\uc5ec supervision fine-tuning \uc744 \uc218\ud589\ud558\uc600\ub2e4.")))))}o.isMDXComponent=!0},69149:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-33-8684f15fdef7cfec605e5134087424d0.png"},56030:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-34-4e72459d213265927468d291214d9e6f.png"},11960:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-35-9713e42aca4ee28f311ae24e48a64bfc.png"},21004:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-36-f842851e898197f593a61f549d1db7ef.png"},56801:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-37-00684409e6e8d8d11a347083c5fcbea5.png"},94682:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-38-57eedfb0c9d4ce7d1fc6af0da6b3e1c8.png"},24714:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-39-ab91df54f6249bbb8f404e741900e2d0.png"},49220:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-40-61924f3a4a7a54560ad17adf893bb266.png"},62207:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-41-623fd311733687c1dc19b5eae7b735f9.png"},26395:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-42-ab47d621cecb904ae0a0a48383d25e98.png"},51322:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-43-556ad1560ae9a757360c780f80540e81.png"},64453:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-44-7cbe111f3df43cd3b327b98d8fd6bfee.png"},80244:(a,t,e)=>{e.d(t,{Z:()=>n});const n=e.p+"assets/images/image-45-abaacea5f9456009b21d59842fb940f1.png"}}]);