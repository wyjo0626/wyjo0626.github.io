"use strict";(self.webpackChunkWon_Yong_Jo=self.webpackChunkWon_Yong_Jo||[]).push([[3045],{3905:(a,e,t)=>{t.d(e,{Zo:()=>i,kt:()=>h});var s=t(67294);function n(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function m(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,s)}return t}function p(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?m(Object(t),!0).forEach((function(e){n(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function r(a,e){if(null==a)return{};var t,s,n=function(a,e){if(null==a)return{};var t,s,n={},m=Object.keys(a);for(s=0;s<m.length;s++)t=m[s],e.indexOf(t)>=0||(n[t]=a[t]);return n}(a,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(s=0;s<m.length;s++)t=m[s],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(n[t]=a[t])}return n}var l=s.createContext({}),N=function(a){var e=s.useContext(l),t=e;return a&&(t="function"==typeof a?a(e):p(p({},e),a)),t},i=function(a){var e=N(a.components);return s.createElement(l.Provider,{value:e},a.children)},k="mdxType",c={inlineCode:"code",wrapper:function(a){var e=a.children;return s.createElement(s.Fragment,{},e)}},o=s.forwardRef((function(a,e){var t=a.components,n=a.mdxType,m=a.originalType,l=a.parentName,i=r(a,["components","mdxType","originalType","parentName"]),k=N(t),o=n,h=k["".concat(l,".").concat(o)]||k[o]||c[o]||m;return t?s.createElement(h,p(p({ref:e},i),{},{components:t})):s.createElement(h,p({ref:e},i))}));function h(a,e){var t=arguments,n=e&&e.mdxType;if("string"==typeof a||n){var m=t.length,p=new Array(m);p[0]=o;var r={};for(var l in e)hasOwnProperty.call(e,l)&&(r[l]=e[l]);r.originalType=a,r[k]="string"==typeof a?a:n,p[1]=r;for(var N=2;N<m;N++)p[N]=t[N];return s.createElement.apply(null,p)}return s.createElement.apply(null,t)}o.displayName="MDXCreateElement"},72066:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>p,default:()=>c,frontMatter:()=>m,metadata:()=>r,toc:()=>N});var s=t(87462),n=(t(67294),t(3905));const m={slug:"BitNet-a4.8",title:"BitNet a4.8: 4-bit Activations for 1-bit LLMs",tags:["PEFT","Quantization","LLM","1.58-bit","BitNet","BitNet b1.58","1-bit activation","BitNet a4.8"]},p=void 0,r={unversionedId:"Paper/NLP/PEFT/Quantization/Fine-Tuning/2024-11-BitNet-a4.8",id:"Paper/NLP/PEFT/Quantization/Fine-Tuning/2024-11-BitNet-a4.8",title:"BitNet a4.8: 4-bit Activations for 1-bit LLMs",description:"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 :",source:"@site/docs/Paper/NLP/PEFT/Quantization/Fine-Tuning/2024-11-BitNet-a4.8.md",sourceDirName:"Paper/NLP/PEFT/Quantization/Fine-Tuning",slug:"/Paper/NLP/PEFT/Quantization/Fine-Tuning/BitNet-a4.8",permalink:"/docs/Paper/NLP/PEFT/Quantization/Fine-Tuning/BitNet-a4.8",draft:!1,editUrl:"https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/NLP/PEFT/Quantization/Fine-Tuning/2024-11-BitNet-a4.8.md",tags:[{label:"PEFT",permalink:"/docs/tags/peft"},{label:"Quantization",permalink:"/docs/tags/quantization"},{label:"LLM",permalink:"/docs/tags/llm"},{label:"1.58-bit",permalink:"/docs/tags/1-58-bit"},{label:"BitNet",permalink:"/docs/tags/bit-net"},{label:"BitNet b1.58",permalink:"/docs/tags/bit-net-b-1-58"},{label:"1-bit activation",permalink:"/docs/tags/1-bit-activation"},{label:"BitNet a4.8",permalink:"/docs/tags/bit-net-a-4-8"}],version:"current",frontMatter:{slug:"BitNet-a4.8",title:"BitNet a4.8: 4-bit Activations for 1-bit LLMs",tags:["PEFT","Quantization","LLM","1.58-bit","BitNet","BitNet b1.58","1-bit activation","BitNet a4.8"]},sidebar:"tutorialSidebar",previous:{title:"LLM-FP4: 4-Bit Floating-Point Quantized Transformers",permalink:"/docs/Paper/NLP/PEFT/Quantization/Fine-Tuning/LLM-FP4"},next:{title:"Optimizing Large Language Model Training Using FP4 Quantization",permalink:"/docs/Paper/NLP/PEFT/Quantization/Fine-Tuning/fp4"}},l={},N=[{value:"2.1 Architecture",id:"21-architecture",level:2},{value:"2.2 Training",id:"22-training",level:2},{value:"Continue-training from BitNet b1.58",id:"continue-training-from-bitnet-b158",level:4},{value:"Gradient approximation",id:"gradient-approximation",level:4},{value:"2.3 Floating-point quantization",id:"23-floating-point-quantization",level:2},{value:"3 Experiments",id:"3-experiments",level:2},{value:"3.1 Main Results",id:"31-main-results",level:2},{value:"Sparsity",id:"sparsity",level:4},{value:"Low-bit Attention",id:"low-bit-attention",level:4},{value:"3.2 Ablation Study",id:"32-ablation-study",level:2},{value:"Hybrid architecture",id:"hybrid-architecture",level:4},{value:"Down projection of FFN",id:"down-projection-of-ffn",level:4},{value:"Output projection of attention",id:"output-projection-of-attention",level:4},{value:"4-bit quantization",id:"4-bit-quantization",level:4},{value:"3.3 More Training Tokens",id:"33-more-training-tokens",level:3},{value:"4 Conclusion",id:"4-conclusion",level:2}],i={toc:N},k="wrapper";function c(a){let{components:e,...m}=a;return(0,n.kt)(k,(0,s.Z)({},i,m,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 : ",(0,n.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2411.04965"},"https://arxiv.org/pdf/2411.04965")),(0,n.kt)("h1",{id:"abstract"},"Abstract"),(0,n.kt)("p",null,"\ucd5c\uadfc 1-bit Large Language Models (LLMs) \uc5d0 \ub300\ud55c \uc5f0\uad6c, \uc608\ub97c \ub4e4\uc5b4 BitNet b1.58, \ub294 LLM \uc758 inference cost \ub97c \uc904\uc774\uba74\uc11c\ub3c4 \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\ub294 \uc720\ub9dd\ud55c \ubc29\ud5a5\uc744 \uc81c\uc2dc\ud55c\ub2e4. "),(0,n.kt)("p",null,"\ubcf8 \ub17c\ubb38\uc5d0\uc11c\ub294 1-bit LLM \uc744 \uc704\ud55c 4-bit activations \ub97c \uac00\ub2a5\ud558\uac8c \ud558\ub294 ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8")," \uc744 \uc18c\uac1c\ud55c\ub2e4. "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"BitNet a4.8 \uc740 outlier channels \ub85c \uc778\ud574 \ubc1c\uc0dd\ud558\ub294 quantization errors \ub97c \uc904\uc774\uae30 \uc704\ud574 ",(0,n.kt)("strong",{parentName:"li"},"hybrid quantization \ubc0f sparsification \uc804\ub7b5"),"\uc744 \ud65c\uc6a9\ud55c\ub2e4. ",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"\uad6c\uccb4\uc801\uc73c\ub85c, attention \ubc0f feed-forward network (FFN) layer \uc758 inputs \uc5d0 \ub300\ud574 4-bit activation \uc744 \uc0ac\uc6a9\ud558\uace0, intermediate states \ub294 sparsification \ud6c4 8-bit quantization \uc744 \uc801\uc6a9\ud55c\ub2e4."))),(0,n.kt)("li",{parentName:"ul"},"\uad11\ubc94\uc704\ud55c \uc2e4\ud5d8 \uacb0\uacfc, BitNet a4.8 \uc740 BitNet b1.58 \uacfc \ub3d9\ub4f1\ud55c training costs \ub85c \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \ub2ec\uc131\ud558\uba74\uc11c\ub3c4 4-bit (INT4/FP4) kernel \uc744 \ud65c\uc131\ud654\ud558\uc5ec faster inference \ub97c \ubcf4\uc778\ub2e4. "),(0,n.kt)("li",{parentName:"ul"},"\ub610\ud55c, BitNet a4.8 \uc740 \uc804\uccb4 parameter \uc758 55% \ub9cc \ud65c\uc131\ud654\ud558\uba70, 3-bit KV cache \ub97c \uc9c0\uc6d0\ud558\uc5ec large-scale LLM \ubc30\ud3ec \ubc0f \ucd94\ub860\uc758 \ud6a8\uc728\uc131\uc744 \ub354\uc6b1 \ud5a5\uc0c1\uc2dc\ud0a8\ub2e4.  ")),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Figure 1",src:t(28272).Z,width:"1702",height:"1007"})),(0,n.kt)("h1",{id:"1-introduction"},"1 Introduction"),(0,n.kt)("p",null,"\ucd5c\uadfc \uc5f0\uad6c\uc5d0 \ub530\ub974\uba74, ",(0,n.kt)("strong",{parentName:"p"},"1-bit LLM")," \uc740 \ub3d9\uc77c\ud55c parameter \ubc0f training token \uc218\ub97c \uc0ac\uc6a9\ud560 \uacbd\uc6b0 full-precision model \uacfc \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \ubcf4\uc774\uba74\uc11c\ub3c4 ",(0,n.kt)("strong",{parentName:"p"},"latency, memory, throughput, energy consumption")," \uba74\uc5d0\uc11c \uc0c1\ub2f9\ud55c \ube44\uc6a9 \uc808\uac10\uc744 \uac00\ub2a5\ud558\uac8c \ud55c\ub2e4."),(0,n.kt)("p",null,(0,n.kt)("strong",{parentName:"p"},"1.58-bit weight")," (i.e., ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"{"),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mn",{parentName:"mrow"},"0"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"}")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\{-1, 0, 1\\}")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mopen"},"{"),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mord"},"1"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"0"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"1"),(0,n.kt)("span",{parentName:"span",className:"mclose"},"}"))))),") \ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0, inference bottleneck \uc774 \uc81c\ud55c\ub41c memory bandwidth \uc5d0\uc11c high computational cost \ub85c \uc774\ub3d9\ud55c\ub2e4. \ub530\ub77c\uc11c, LLM \uc5d0\uc11c low-bit \ub610\ub294 sparse activation \uc744 \ud65c\uc6a9\ud558\ub294 \uac83\uc740 computational budget \uc744 \ub354\uc6b1 \uc904\uc774\uba74\uc11c\ub3c4 downstream task \uc758 \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\ub294 \uc720\ub9dd\ud55c \uc811\uadfc \ubc29\uc2dd\uc774\ub2e4.  "),(0,n.kt)("p",null,"Sparsification \uc678\uc5d0\ub3c4, ",(0,n.kt)("strong",{parentName:"p"},"activation quantization")," \uc740 matrix multiplication \uc5f0\uc0b0\uc744 \uac00\uc18d\ud558\ub294 \ub610 \ub2e4\ub978 \ubc29\ubc95\uc774\ub2e4.  \uadf8\ub7ec\ub098, low-bit activation \uc744 \uc0ac\uc6a9\ud558\ub294 neural network \ucd5c\uc801\ud654\ub294 \uba87 \uac00\uc9c0 \uc5b4\ub824\uc6c0\uc774 \ub3d9\ubc18\ud55c\ub2e4."),(0,n.kt)("p",null,"\ud2b9\ud788, \ud559\uc2b5\uc774 \uc9c4\ud589\ub418\uace0 model \ud06c\uae30\uac00 \ucee4\uc9c8\uc218\ub85d outlier dimension \uc774 \ub098\ud0c0\ub098\ub294 \ud604\uc0c1\uc774 \ubc1c\uc0dd\ud55c\ub2e4. \uc774\ub7ec\ud55c outlier \ub4e4\uc740 \uc804\uccb4 activation \uc911 \uadf9\ud788 \uc77c\ubd80\uc5d0 \ubd88\uacfc\ud558\uc9c0\ub9cc, much larger magnitude \ub97c \uac00\uc9c0\ubbc0\ub85c quantization error \uac00 \uc99d\uac00\ud558\uba70,",(0,n.kt)("br",{parentName:"p"}),"\n","\uacb0\uacfc\uc801\uc73c\ub85c downstream task \uc758 \uc131\ub2a5 \uc800\ud558\ub97c \ucd08\ub798\ud55c\ub2e4.  "),(0,n.kt)("p",null,"\uae30\uc874 \uc5f0\uad6c\uc5d0\uc11c\ub294 \uc774\ub7ec\ud55c \ubb38\uc81c\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 ",(0,n.kt)("strong",{parentName:"p"},"Hadamard \ub610\ub294 learnable rotary transformation")," \uc744 \ud65c\uc6a9\ud558\uc5ec",(0,n.kt)("br",{parentName:"p"}),"\n",(0,n.kt)("strong",{parentName:"p"},"outlier feature \ub97c other entries \ub85c \ubd84\uc0b0\uc2dc\ud0a4\ub294 \ubc29\ubc95"),"\uc744 \uc0ac\uc6a9\ud588\ub2e4. \uadf8\ub7ec\ub098, \uc774\ub7ec\ud55c \uae30\ubc95\ub4e4\uc740 \uc8fc\ub85c higher precision LLM (e.g., 4-bit) \uc744 \ub300\uc0c1\uc73c\ub85c \uc124\uacc4\ub418\uc5c8\uc73c\uba70, 1-bit LLM \uc5d0\uc11c\ub294 weights bit-width \uac00 \uadf9\ub3c4\ub85c \ub0ae\uae30 \ub54c\ubb38\uc5d0 transformation matrix \ub97c \uc9c1\uc811 weight \uc5d0 \ud761\uc218\ud558\ub294 \uac83\uc774 \uc5b4\ub835\ub2e4. \ub610\ud55c, \uc774\ub7ec\ud55c \ubcc0\ud658\uc744 ",(0,n.kt)("strong",{parentName:"p"},"online transformation")," \uc73c\ub85c \uc801\uc6a9\ud560 \uacbd\uc6b0, \ucd94\uac00\uc801\uc778 \uc5f0\uc0b0 \ube44\uc6a9\uc774 \ubc1c\uc0dd\ud558\uc5ec \uc804\uccb4\uc801\uc778 inference \uc131\ub2a5\uc774 \uc800\ud558\ub418\ub294 \ubb38\uc81c\uac00 \uc788\ub2e4.  "),(0,n.kt)("p",null,"\ubcf8 \uc5f0\uad6c\uc5d0\uc11c\ub294 ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8")," \uc744 \ub3c4\uc785\ud558\uc5ec 1-bit LLM \uc5d0\uc11c 4-bit activation \uc744 \uac00\ub2a5\ud558\uac8c \ud558\ub294 ",(0,n.kt)("strong",{parentName:"p"},"hybrid quantization \ubc0f sparsification \uc804\ub7b5")," \uc744 \uc81c\uc548\ud55c\ub2e4."),(0,n.kt)("p",null,"1-bit LLM \uc758 activation distribution \uc744 \uba74\ubc00\ud788 \ubd84\uc11d\ud55c \ud6c4, activation distribution pattern \uc5d0 \ub530\ub77c 4-bit quantization \ub610\ub294 sparsification \uc744 \uc120\ud0dd\uc801\uc73c\ub85c \uc801\uc6a9\ud55c\ub2e4.  "),(0,n.kt)("p",null,"\uad6c\uccb4\uc801\uc73c\ub85c, ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8")," \uc740 \ub2e4\uc74c\uacfc \uac19\uc740 \ubc29\uc2dd\uc744 \uc0ac\uc6a9\ud55c\ub2e4:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Attention \ubc0f FFN layer \uc758 inputs")," \uc5d0 ",(0,n.kt)("strong",{parentName:"li"},"4-bit activation")," \uc744 \uc801\uc6a9  "),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"intermediate state")," \uc5d0 \ub300\ud574\uc11c\ub294 ",(0,n.kt)("strong",{parentName:"li"},"8-bit sparsification")," \uc744 \uc801\uc6a9  ")),(0,n.kt)("p",null,"\ub610\ud55c, training efficiency \ub97c \ub192\uc774\uae30 \uc704\ud574, BitNet a4.8 \uc740 8-bit activation \uc5d0\uc11c \uc2dc\uc791\ud558\uc5ec 4-bit activation \uc73c\ub85c \uc804\ud658\ud558\ub294 two-stage recipe \ub97c \uc744 \ub530\ub978\ub2e4. \uc774 \uc811\uadfc \ubc29\uc2dd \ub355\ubd84\uc5d0, ",(0,n.kt)("strong",{parentName:"p"},"BitNet b1.58 \uc744 low-bit activation \uc5d0 \ube60\ub974\uac8c \uc801\uc751\uc2dc\ud0a4\uba74\uc11c\ub3c4 few training token \ub9cc\uc73c\ub85c\ub3c4 \ub192\uc740 \uc131\ub2a5\uc744 \uc720\uc9c0")," \ud560 \uc218 \uc788\ub2e4.  "),(0,n.kt)("p",null,"\uad11\ubc94\uc704\ud55c \uc2e4\ud5d8 \uacb0\uacfc, ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8 \uc740 BitNet b1.58 \uacfc \ub3d9\uc77c\ud55c training cost \ub85c \ub3d9\ub4f1\ud55c \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uba74\uc11c\ub3c4 inference  efficiency \uac00 \ud06c\uac8c \ud5a5\uc0c1\ub428"),"\uc744 \ud655\uc778\ud588\ub2e4. \ub610\ud55c, ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8 \uc740 \uc804\uccb4 parameter \uc758 55% \ub9cc \ud65c\uc131\ud654\ud558\uba70, 3-bit KV cache \ub97c \uc9c0\uc6d0"),"\ud558\uc5ec large-scale LLM \ubc30\ud3ec \ubc0f \ucd94\ub860\uc758 \ud6a8\uc728\uc131\uc744 \ub354\uc6b1 \ub192\uc778\ub2e4."),(0,n.kt)("h1",{id:"2-bitnet-a48"},"2 BitNet a4.8"),(0,n.kt)("h2",{id:"21-architecture"},"2.1 Architecture"),(0,n.kt)("p",null,"Fig. 1 \uc5d0\uc11c \ubcfc \uc218 \uc788\ub4ef\uc774, BitNet a4.8 \uc740 BitNet b1.58 \uacfc \ub3d9\uc77c\ud55c \uad6c\uc870\ub97c \ub530\ub978\ub2e4."),(0,n.kt)("p",null,"\uae30\uc874 \uc5f0\uad6c\ub97c \ucc38\uace0\ud558\uc5ec, attention \uacfc feed-forward network (FFN) \uc5d0 \uc788\ub294 linear projections \ub97c ",(0,n.kt)("inlineCode",{parentName:"p"},"BitLinear")," \ub85c \ub300\uccb4\ud558\uc5ec 1.58-bit weights \ub97c \ucc98\uc74c\ubd80\ud130 \ud559\uc2b5\ud560 \uc218 \uc788\ub3c4\ub85d \uc124\uacc4\ud588\ub2e4. \ub610\ud55c, activations \uc5d0 \ub300\ud574 ",(0,n.kt)("strong",{parentName:"p"},"hybrid quantization \ubc0f sparsification \uc804\ub7b5"),"\uc744 \uc801\uc6a9\ud558\uc5ec outlier dimension \uc73c\ub85c \uc778\ud574 \ubc1c\uc0dd\ud558\ub294 \uc624\ub958\ub97c \ucd5c\uc18c\ud654\ud588\ub2e4."),(0,n.kt)("p",null,"Fig. 2 \ub294 7B model size \uc758 BitNet b1.58 model \uc744 \uc0ac\uc6a9\ud558\uc5ec \uac01 \uad6c\uc131 \uc694\uc18c\uc758 input distribution \uc744 \uc2dc\uac01\ud654\ud55c \uacb0\uacfc\ub2e4.  "),(0,n.kt)("p",null,"Attention \ubc0f FFN layer \uc758 input distribution  \uc77c\ubc18\uc801\uc73c\ub85c Gaussian-like \ud55c \ud615\ud0dc\ub97c \ubcf4\uc774\ub294 \ubc18\uba74, FFN down projection \ubc0f self-attention output projection \uc758 \uacbd\uc6b0 outlier channel \uc774 \ub9ce\uace0, \ub300\ubd80\ubd84\uc758 \uac12\uc774 zero \uc8fc\ubcc0\uc5d0 \uc9d1\uc911\ub418\uc5b4 \uc788\ub2e4. \uc774\ub7ec\ud55c \ud604\uc0c1\uc740 full-precision LLM \uc5d0\uc11c\ub3c4 \uc720\uc0ac\ud558\uac8c \uad00\ucc30\ub41c\ub2e4.  "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Figure 3",src:t(33445).Z,width:"1227",height:"904"})),(0,n.kt)("p",null,"Fig. 3 \uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\ub4ef\uc774, \uc774\ub7ec\ud55c intermediate states \uc5d0 \ub300\ud574 low-bit quantization \uc744 \uc9c1\uc811 \uc801\uc6a9\ud558\uba74 \uc2ec\uac01\ud55c quantization error \uac00 \ubc1c\uc0dd\ud560 \uc218 \uc788\ub2e4. \ub530\ub77c\uc11c, Q-Sparse \uae30\ubc95\uc744 \uc0ac\uc6a9\ud558\uc5ec intermediate states \ub97c 8-bit \ub85c \uc720\uc9c0\ud558\uba74\uc11c sparsification \uc744 \uc801\uc6a9\ud558\uc5ec computation bottleneck \uc744 \uc81c\uac70\ud588\ub2e4."),(0,n.kt)("p",null,"Self-attention layers \uc758 output projection \uc5d0 \ub300\ud574\uc11c\ub294 \uc544\ub798\uc640 \uac19\uc740 ",(0,n.kt)("strong",{parentName:"p"},"sparsify-then-quantize function")," \uc744 \uc0ac\uc6a9\ud588\ub2e4:"),(0,n.kt)("div",{className:"math math-display"},(0,n.kt)("span",{parentName:"div",className:"katex-display"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mtable",{parentName:"semantics",rowspacing:"0.16em",columnspacing:"1em"},(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mi",{parentName:"mrow"},"Y"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mtext",{parentName:"msub"},"INT8")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"\u2299"),(0,n.kt)("mi",{parentName:"mrow"},"M"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"\u22c5"),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mi",{parentName:"msub"},"w")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"W"),(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mo",{parentName:"msup",stretchy:"false"},")"),(0,n.kt)("mi",{parentName:"msup"},"T")),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mspace",{parentName:"mrow",width:"1em"}),(0,n.kt)("mi",{parentName:"mrow"},"M"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mtext",{parentName:"msub"},"Top"),(0,n.kt)("mi",{parentName:"msub"},"k")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"}))),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\begin{equation} Y = (Q_\\text{INT8}(X) \\odot M) \\cdot Q_w(W)^T , \\quad M = \\text{Top}_k(|X|) \\end{equation}")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1.2513em",verticalAlign:"-0.3757em"}}),(0,n.kt)("span",{parentName:"span",className:"mtable"},(0,n.kt)("span",{parentName:"span",className:"col-align-c"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8757em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.9843em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"INT8"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u2299"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"M"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u22c5"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02691em"}},"w")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,n.kt)("span",{parentName:"span",className:"mclose"},(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8913em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"T")))))))),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}}),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"M"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"Top")),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.242em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.4559em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03148em"}},"k")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2441em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3757em"}},(0,n.kt)("span",{parentName:"span"}))))))),(0,n.kt)("span",{parentName:"span",className:"tag"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8757em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.8757em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.8913em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3757em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("p",null,"\uc5ec\uae30\uc11c ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mi",{parentName:"msub"},"w")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mo",{parentName:"mrow"},"\u22c5"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"Q_w(\\cdot)")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02691em"}},"w")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u22c5"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))))," \uc640 ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mtext",{parentName:"msub"},"INT8")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mo",{parentName:"mrow"},"\u22c5"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"Q_\\text{INT8}(\\cdot)")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"INT8"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u22c5"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))))," \ub294 \uac01\uac01 weight ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"W")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"W")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W")))))," \uc640 activations ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"X")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X")))))," \uc758 quantization function \uc744 \uc758\ubbf8\ud558\uba70, ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"M")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"M")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"M")))))," \uc740 activations ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"X")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"X")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X")))))," \uc758 abs values \uac00 maximum top-",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"K")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"K")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07153em"}},"K")))))," elements \ub97c \ub098\ud0c0\ub0b4\ub294 mask tensor \uc774\ub2e4. ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mo",{parentName:"mrow"},"\u2299")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\odot")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6667em",verticalAlign:"-0.0833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2299")))))," \ub294 element-wise multiplication \uc744 \uc758\ubbf8\ud55c\ub2e4.  "),(0,n.kt)("p",null,"\ud2b9\ud788, Weight quantization \uacfc activation quantization function \uc740 \uc544\ub798\uc640 \uac19\uc774 \uc815\uc758\ub41c\ub2e4:  "),(0,n.kt)("div",{className:"math math-display"},(0,n.kt)("span",{parentName:"div",className:"katex-display"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mtable",{parentName:"semantics",rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em"},(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mrow",{parentName:"mrow"}),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mi",{parentName:"msub"},"w")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"W"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mi",{parentName:"mrow"},"\u03b1"),(0,n.kt)("mtext",{parentName:"mrow"},"RoundClip"),(0,n.kt)("mrow",{parentName:"mrow"},(0,n.kt)("mo",{parentName:"mrow",fence:"true"},"("),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"mfrac"},"W"),(0,n.kt)("mrow",{parentName:"mfrac"},(0,n.kt)("mi",{parentName:"mrow"},"\u03b1"),(0,n.kt)("mo",{parentName:"mrow"},"+"),(0,n.kt)("mi",{parentName:"mrow"},"\u03f5"))),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow",fence:"true"},")")),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mspace",{parentName:"mrow",width:"1em"}),(0,n.kt)("mi",{parentName:"mrow"},"\u03b1"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mtext",{parentName:"mrow"},"mean"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"W"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"})),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mrow",{parentName:"mrow"}),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mtext",{parentName:"msub"},"INT8")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"mfrac"},"\u03b3"),(0,n.kt)("mn",{parentName:"mfrac"},"127")),(0,n.kt)("mtext",{parentName:"mrow"},"RoundClip"),(0,n.kt)("mrow",{parentName:"mrow"},(0,n.kt)("mo",{parentName:"mrow",fence:"true"},"("),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("mn",{parentName:"mfrac"},"127"),(0,n.kt)("mrow",{parentName:"mfrac"},(0,n.kt)("mi",{parentName:"mrow"},"\u03b3"),(0,n.kt)("mo",{parentName:"mrow"},"+"),(0,n.kt)("mi",{parentName:"mrow"},"\u03f5"))),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mn",{parentName:"mrow"},"128"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mn",{parentName:"mrow"},"127"),(0,n.kt)("mo",{parentName:"mrow",fence:"true"},")")),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mspace",{parentName:"mrow",width:"1em"}),(0,n.kt)("mi",{parentName:"mrow"},"\u03b3"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mi",{parentName:"mrow"},"max"),(0,n.kt)("mo",{parentName:"mrow"},"\u2061"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"})),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mrow",{parentName:"mrow"}),(0,n.kt)("mtext",{parentName:"mrow"},"RoundClip"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mi",{parentName:"mrow"},"a"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mi",{parentName:"mrow"},"b"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mi",{parentName:"mrow"},"min"),(0,n.kt)("mo",{parentName:"mrow"},"\u2061"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"max"),(0,n.kt)("mo",{parentName:"mrow"},"\u2061"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mtext",{parentName:"mrow"},"round"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mi",{parentName:"mrow"},"a"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mi",{parentName:"mrow"},"b"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"}))),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\begin{align} &Q_w(W) = \\alpha \\text{RoundClip} \\left( \\frac{W}{\\alpha + \\epsilon}, -1, 1 \\right), \\quad \\alpha = \\text{mean}(|W|) \\\\ &Q_\\text{INT8}(X) = \\frac{\\gamma}{127} \\text{RoundClip} \\left( \\frac{127}{\\gamma + \\epsilon} X, -128, 127 \\right), \\quad \\gamma = \\max(|X|) \\\\ &\\text{RoundClip}(X, a, b) = \\min(\\max(\\text{round}(X), a), b) \\end{align}")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"6.9001em",verticalAlign:"-3.2em"}}),(0,n.kt)("span",{parentName:"span",className:"mtable"},(0,n.kt)("span",{parentName:"span",className:"col-align-r"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.7em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.7em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"})),(0,n.kt)("span",{parentName:"span",style:{top:"-3em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"})),(0,n.kt)("span",{parentName:"span",style:{top:"-0.91em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.2em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"col-align-l"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.7em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.7em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02691em"}},"w")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.0037em"}},"\u03b1"),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"RoundClip")),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"minner"},(0,n.kt)("span",{parentName:"span",className:"mopen delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},"(")),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.3603em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.0037em"}},"\u03b1"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.7693em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mord"},"1"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"1"),(0,n.kt)("span",{parentName:"span",className:"mclose delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},")"))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}}),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.0037em"}},"\u03b1"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"mean")),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"))),(0,n.kt)("span",{parentName:"span",style:{top:"-3em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"INT8"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.1076em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"127"))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.686em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"RoundClip")),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"minner"},(0,n.kt)("span",{parentName:"span",className:"mopen delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},"(")),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.3214em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"127")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8804em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mord"},"128"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"127"),(0,n.kt)("span",{parentName:"span",className:"mclose delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},")"))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}}),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mop"},"max"),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"))),(0,n.kt)("span",{parentName:"span",style:{top:"-0.91em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"}),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"RoundClip")),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"b"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mop"},"min"),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mop"},"max"),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"round")),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"a"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"b"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.2em"}},(0,n.kt)("span",{parentName:"span"}))))))),(0,n.kt)("span",{parentName:"span",className:"tag"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.7em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.7em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"})),(0,n.kt)("span",{parentName:"span",style:{top:"-3em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"})),(0,n.kt)("span",{parentName:"span",style:{top:"-0.91em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.45em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.2em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("p",null,"FFN \uc5d0 \ub300\ud574\uc11c\ub294 activation sparsity \ub97c \uadf9\ub300\ud654\ud558\uae30 \uc704\ud574 ",(0,n.kt)("strong",{parentName:"p"},"squared ReLU \ubc0f gated linear unit (GLU) \uae30\ubc95")," \uc744 \uc801\uc6a9\ud588\ub2e4:  "),(0,n.kt)("div",{className:"math math-display"},(0,n.kt)("span",{parentName:"div",className:"katex-display"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mtable",{parentName:"semantics",rowspacing:"0.16em",columnspacing:"1em"},(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mtext",{parentName:"msup"},"ReLU"),(0,n.kt)("mn",{parentName:"msup"},"2")),(0,n.kt)("mtext",{parentName:"mrow"},"GLU"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("msubsup",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msubsup"},"W"),(0,n.kt)("mtext",{parentName:"msubsup"},"up"),(0,n.kt)("mi",{parentName:"msubsup"},"T")),(0,n.kt)("mo",{parentName:"mrow"},"\u2299"),(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mtext",{parentName:"msup"},"ReLU"),(0,n.kt)("mn",{parentName:"msup"},"2")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("msubsup",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msubsup"},"W"),(0,n.kt)("mtext",{parentName:"msubsup"},"gate"),(0,n.kt)("mi",{parentName:"msubsup"},"T")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"}))),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\begin{equation} \\text{ReLU}^2\\text{GLU}(X) = XW_{\\text{up}}^T \\odot \\text{ReLU}^2(XW_{\\text{gate}}^T) \\end{equation}")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1.2744em",verticalAlign:"-0.3872em"}}),(0,n.kt)("span",{parentName:"span",className:"mtable"},(0,n.kt)("span",{parentName:"span",className:"col-align-c"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8872em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.9959em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"ReLU")),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8873em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.1362em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"GLU")),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8913em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.453em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"up"))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"T")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3831em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u2299"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"ReLU")),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8873em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.1362em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8913em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.453em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"gate"))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"T")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3831em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3872em"}},(0,n.kt)("span",{parentName:"span"}))))))),(0,n.kt)("span",{parentName:"span",className:"tag"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8872em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.8872em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.8913em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3872em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("p",null,"\uc0ac\uc804 \uc2e4\ud5d8 \uacb0\uacfc, squared ReLU \ub97c \uc801\uc6a9\ud588\uc744 \ub54c FFN down projection \uc758 input sparsity \uac00 80% \uc774\uc0c1 \uc99d\uac00\ud588\uc73c\uba70, \uc131\ub2a5\uc5d0 \ubbf8\uce58\ub294 \uc601\ud5a5\uc740 \ubbf8\ubbf8\ud588\ub2e4. \ub610\ud55c, gate projection \uc758 outputs ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mtext",{parentName:"msup"},"ReLU"),(0,n.kt)("mn",{parentName:"msup"},"2")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("msubsup",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msubsup"},"W"),(0,n.kt)("mtext",{parentName:"msubsup"},"gate"),(0,n.kt)("mi",{parentName:"msubsup"},"T")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\text{ReLU}^2(XW_{\\text{gate}}^T)")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1.2704em",verticalAlign:"-0.3831em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"ReLU")),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8873em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.1362em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8413em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.453em",marginLeft:"-0.1389em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"gate"))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"T")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3831em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))))," \ub3c4 high activation sparsity \ub97c \ubcf4\uc600\ub2e4 (e.g., 7B models \uc5d0\uc11c 67.5%)."),(0,n.kt)("p",null,"\uc774 \ud2b9\uc131\uc744 \ud65c\uc6a9\ud558\uba74 gate projection \uc744 \uba3c\uc800 \uc218\ud589\ud55c \ud6c4, gate \uc5d0\uc11c non-zero \ub85c \uc120\ud0dd\ub41c \ucc44\ub110\uc5d0 \ub300\ud574\uc11c\ub9cc up projection \uc5f0\uc0b0\uc744 \uc218\ud589\ud560 \uc218 \uc788\ub2e4. \uc774\ub85c \uc778\ud574 ",(0,n.kt)("strong",{parentName:"p"},"FFN up projection \uc758 FLOPs \ub97c \ub354\uc6b1 \uac10\uc18c"),"\uc2dc\ud0ac \uc218 \uc788\ub2e4.  "),(0,n.kt)("p",null,"Attention \ubc0f FFN \uc758 input activation \uc740 ",(0,n.kt)("strong",{parentName:"p"},"outlier features \uac00 \ud6e8\uc52c \uc801\uc73c\ubbc0\ub85c")," 4-bit integers \ub85c quantize \ud558\ub294 absmean function \uc744 \uc0ac\uc6a9\ud588\ub2e4:  "),(0,n.kt)("div",{className:"math math-display"},(0,n.kt)("span",{parentName:"div",className:"katex-display"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mtable",{parentName:"semantics",rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em"},(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mrow",{parentName:"mrow"}),(0,n.kt)("mi",{parentName:"mrow"},"Y"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mtext",{parentName:"msub"},"INT4")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"\u22c5"),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mi",{parentName:"msub"},"w")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"W"),(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mo",{parentName:"msup",stretchy:"false"},")"),(0,n.kt)("mi",{parentName:"msup"},"T"))))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"})),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mrow",{parentName:"mrow"}),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mtext",{parentName:"msub"},"INT4")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"mfrac"},"\u03b2"),(0,n.kt)("msqrt",{parentName:"mfrac"},(0,n.kt)("mn",{parentName:"msqrt"},"7"))),(0,n.kt)("mtext",{parentName:"mrow"},"RoundClip"),(0,n.kt)("mrow",{parentName:"mrow"},(0,n.kt)("mo",{parentName:"mrow",fence:"true"},"("),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("msqrt",{parentName:"mfrac"},(0,n.kt)("mn",{parentName:"msqrt"},"7")),(0,n.kt)("mrow",{parentName:"mfrac"},(0,n.kt)("mi",{parentName:"mrow"},"\u03b2"),(0,n.kt)("mo",{parentName:"mrow"},"+"),(0,n.kt)("mi",{parentName:"mrow"},"\u03f5"))),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mn",{parentName:"mrow"},"8"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mn",{parentName:"mrow"},"7"),(0,n.kt)("mo",{parentName:"mrow",fence:"true"},")")),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mspace",{parentName:"mrow",width:"1em"}),(0,n.kt)("mi",{parentName:"mrow"},"\u03b2"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mtext",{parentName:"mrow"},"mean"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"}))),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\begin{align} &Y = Q_\\text{INT4}(X) \\cdot Q_w(W)^T\\\\ &Q_\\text{INT4}(X) = \\frac{\\beta}{\\sqrt{7}} \\text{RoundClip} \\left( \\frac{\\sqrt{7}}{\\beta + \\epsilon} X, -8, 7 \\right), \\quad \\beta = \\text{mean}(|X|) \\end{align}")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"4.8514em",verticalAlign:"-2.1757em"}}),(0,n.kt)("span",{parentName:"span",className:"mtable"},(0,n.kt)("span",{parentName:"span",className:"col-align-r"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.6757em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.5343em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.75em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.1243em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.75em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.1757em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"col-align-l"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.6757em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.5343em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.75em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.22222em"}},"Y"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"INT4"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u22c5"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02691em"}},"w")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.13889em"}},"W"),(0,n.kt)("span",{parentName:"span",className:"mclose"},(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8913em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.13889em"}},"T")))))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.1243em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.75em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"INT4"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.3714em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.2028em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord sqrt"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.9072em"}},(0,n.kt)("span",{parentName:"span",className:"svg-align",style:{top:"-3em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord",style:{paddingLeft:"0.833em"}},(0,n.kt)("span",{parentName:"span",className:"mord"},"7"))),(0,n.kt)("span",{parentName:"span",style:{top:"-2.8672em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"hide-tail",style:{minWidth:"0.853em",height:"1.08em"}},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.08em",viewBox:"0 0 400000 1080",preserveAspectRatio:"xMinYMin slice"},(0,n.kt)("path",{parentName:"svg",d:"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"}))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1328em"}},(0,n.kt)("span",{parentName:"span"}))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.93em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"RoundClip")),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"minner"},(0,n.kt)("span",{parentName:"span",className:"mopen delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size4"},"(")),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.5842em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"\u03f5"))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord sqrt"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.9072em"}},(0,n.kt)("span",{parentName:"span",className:"svg-align",style:{top:"-3em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord",style:{paddingLeft:"0.833em"}},(0,n.kt)("span",{parentName:"span",className:"mord"},"7"))),(0,n.kt)("span",{parentName:"span",style:{top:"-2.8672em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"hide-tail",style:{minWidth:"0.853em",height:"1.08em"}},(0,n.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.08em",viewBox:"0 0 400000 1080",preserveAspectRatio:"xMinYMin slice"},(0,n.kt)("path",{parentName:"svg",d:"M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z"}))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1328em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8804em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mord"},"8"),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"7"),(0,n.kt)("span",{parentName:"span",className:"mclose delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size4"},")"))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}}),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"mean")),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.1757em"}},(0,n.kt)("span",{parentName:"span"}))))))),(0,n.kt)("span",{parentName:"span",className:"tag"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.6757em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.5343em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.75em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.1243em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.75em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.1757em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("h2",{id:"22-training"},"2.2 Training"),(0,n.kt)("h4",{id:"continue-training-from-bitnet-b158"},"Continue-training from BitNet b1.58"),(0,n.kt)("p",null,"BitNet a4.8 \uc740 W1.58A8 \uc5d0\uc11c W1.58A4 \ub85c \ubcc0\ud658\ud558\ub294 two-stage recipe \ub85c \ud559\uc2b5\ub41c\ub2e4."),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"1 stage : ",(0,n.kt)("strong",{parentName:"li"},"8-bit activation \ubc0f ReLU",(0,n.kt)("span",{parentName:"strong",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mrow",{parentName:"msup"}),(0,n.kt)("mn",{parentName:"msup"},"2"))),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"^2")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8141em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span"}),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8141em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2")))))))))))),"GLU")," \ub97c \uc0ac\uc6a9\ud558\uc5ec \ubaa8\ub378\uc744 \ud559\uc2b5\ud55c\ub2e4.  "),(0,n.kt)("li",{parentName:"ol"},"2 stage : ",(0,n.kt)("strong",{parentName:"li"},"Sec. 2.1 \uc5d0\uc11c \uc124\uba85\ud55c hybrid quantization \ubc0f sparsification \uae30\ubc95")," \uc744 \uc801\uc6a9\ud55c\ub2e4.")),(0,n.kt)("p",null,"\uc774\ub7ec\ud55c \ud559\uc2b5 \uacfc\uc815 \ub355\ubd84\uc5d0, BitNet a4.8 \uc740 few training token \ub9cc\uc73c\ub85c\ub3c4 4-bit \ubc0f sparse activation \uc5d0 \ube60\ub974\uac8c \uc801\uc751\ud558\uba70,",(0,n.kt)("br",{parentName:"p"}),"\n","\uc131\ub2a5 \uc800\ud558\ub294 \uac70\uc758 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4.  "),(0,n.kt)("h4",{id:"gradient-approximation"},"Gradient approximation"),(0,n.kt)("p",null,"\uae30\uc874 \uc5f0\uad6c\ub97c \ucc38\uace0\ud558\uc5ec, BitNet a4.8 \uc758 gradient approximation \uc744 \uc218\ud589\ud558\uae30 \uc704\ud574 ",(0,n.kt)("strong",{parentName:"p"},"straight-through estimator (STE)")," \ub97c \uc0ac\uc6a9\ud55c\ub2e4. \ub610\ud55c, ",(0,n.kt)("strong",{parentName:"p"},"mixed precision training")," \uae30\ubc95\uc744 \uc801\uc6a9\ud558\uc5ec parameter \ub97c \uc5c5\ub370\uc774\ud2b8\ud55c\ub2e4.  "),(0,n.kt)("p",null,"Backward propagation \uc2dc, ",(0,n.kt)("strong",{parentName:"p"},"quantization function \ubc0f top-K sparsification function \uacfc \uac19\uc740 non-differentiable functions")," \ub4e4\uc744 \uc9c1\uc811 \uc6b0\ud68c\ud55c\ub2e4. \uc989, \uc774\ub7ec\ud55c \ud568\uc218\ub4e4\uc758 gradient \ub294 \uadf8\ub300\ub85c \uc804\ub2ec\ub418\uc9c0 \uc54a\uace0, STE \ub97c \uc0ac\uc6a9\ud558\uc5ec \uadfc\uc0ac\uc801\uc73c\ub85c \uc804\ud30c\ub41c\ub2e4."),(0,n.kt)("p",null,"Mixed precision training \uc744 \uc704\ud574, ",(0,n.kt)("strong",{parentName:"p"},"full-precision latent weight")," \ub97c \uc720\uc9c0\ud558\uba70 parameter update \ub97c \ub204\uc801\ud55c\ub2e4. Forward pass \ub3d9\uc548, ",(0,n.kt)("strong",{parentName:"p"},"latent weight \ub97c 1.58-bit \ub85c on-the-fly quantization")," \ud558\uc5ec \uc5f0\uc0b0\uc744 \uc218\ud589\ud55c\ub2e4."),(0,n.kt)("h2",{id:"23-floating-point-quantization"},"2.3 Floating-point quantization"),(0,n.kt)("p",null,"Floating-point quantization \uc740 ",(0,n.kt)("strong",{parentName:"p"},"integer-based quantization \ubcf4\ub2e4 broader dynamic range")," \ub97c \uc81c\uacf5\ud558\uba70, \uc774\ub294 ",(0,n.kt)("strong",{parentName:"p"},"long-tailed activation distribution \uc744 \ucc98\ub9ac\ud558\ub294 \ub370 \ud544\uc218\uc801")," \uc774\ub2e4."),(0,n.kt)("p",null,"BitNet a4.8 \uc740 ",(0,n.kt)("strong",{parentName:"p"},"FFN down projection \uc758 inputs \ub97c 8-bit integers \ub85c \uc720\uc9c0")," \ud558\uace0, \ub098\uba38\uc9c0 activation \uc740 ",(0,n.kt)("strong",{parentName:"p"},"FP4")," \ub85c quantize \ud55c\ub2e4."),(0,n.kt)("p",null,"\uc774\ub97c \uc704\ud574 ",(0,n.kt)("strong",{parentName:"p"},"MinMax quantizer")," \ub97c \uc0ac\uc6a9\ud558\uba70, \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ub41c\ub2e4:  "),(0,n.kt)("div",{className:"math math-display"},(0,n.kt)("span",{parentName:"div",className:"katex-display"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mtable",{parentName:"semantics",rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em"},(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mrow",{parentName:"mrow"}),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub"},"Q"),(0,n.kt)("mtext",{parentName:"msub"},"FP4")),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"mfrac"},"\u03b3"),(0,n.kt)("msup",{parentName:"mfrac"},(0,n.kt)("mn",{parentName:"msup"},"2"),(0,n.kt)("mrow",{parentName:"msup"},(0,n.kt)("mi",{parentName:"mrow"},"M"),(0,n.kt)("mo",{parentName:"mrow"},"+"),(0,n.kt)("mi",{parentName:"mrow"},"b")))),(0,n.kt)("mtext",{parentName:"mrow"},"Round"),(0,n.kt)("mrow",{parentName:"mrow"},(0,n.kt)("mo",{parentName:"mrow",fence:"true"},"("),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("msup",{parentName:"mfrac"},(0,n.kt)("mn",{parentName:"msup"},"2"),(0,n.kt)("mrow",{parentName:"msup"},(0,n.kt)("mi",{parentName:"mrow"},"M"),(0,n.kt)("mo",{parentName:"mrow"},"+"),(0,n.kt)("mi",{parentName:"mrow"},"b"))),(0,n.kt)("mi",{parentName:"mfrac"},"\u03b3")),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mo",{parentName:"mrow",fence:"true"},")")),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mspace",{parentName:"mrow",width:"1em"}),(0,n.kt)("mi",{parentName:"mrow"},"\u03b3"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mn",{parentName:"msup"},"2"),(0,n.kt)("mrow",{parentName:"msup"},(0,n.kt)("mi",{parentName:"mrow"},"max"),(0,n.kt)("mo",{parentName:"mrow"},"\u2061"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"\u230a"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"\u230a"),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mrow",{parentName:"msub"},(0,n.kt)("mi",{parentName:"mrow"},"log"),(0,n.kt)("mo",{parentName:"mrow"},"\u2061")),(0,n.kt)("mn",{parentName:"msub"},"2")),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"\u230b"),(0,n.kt)("mo",{parentName:"mrow"},"+"),(0,n.kt)("mi",{parentName:"mrow"},"b"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"\u230b"),(0,n.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"})),(0,n.kt)("mtr",{parentName:"mtable"},(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"}))),(0,n.kt)("mtd",{parentName:"mtr"},(0,n.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,n.kt)("mrow",{parentName:"mstyle"},(0,n.kt)("mrow",{parentName:"mrow"}),(0,n.kt)("mi",{parentName:"mrow"},"b"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mrow",{parentName:"msub"},(0,n.kt)("mi",{parentName:"mrow"},"log"),(0,n.kt)("mo",{parentName:"mrow"},"\u2061")),(0,n.kt)("mn",{parentName:"msub"},"2")),(0,n.kt)("mrow",{parentName:"mrow"},(0,n.kt)("mo",{parentName:"mrow",fence:"true"},"("),(0,n.kt)("mfrac",{parentName:"mrow"},(0,n.kt)("mrow",{parentName:"mfrac"},(0,n.kt)("mn",{parentName:"mrow"},"2"),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mn",{parentName:"msup"},"2"),(0,n.kt)("mrow",{parentName:"msup"},(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mi",{parentName:"mrow"},"M")))),(0,n.kt)("mrow",{parentName:"mfrac"},(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("msub",{parentName:"mrow"},(0,n.kt)("mi",{parentName:"msub",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"msub"},"max"),(0,n.kt)("mo",{parentName:"msub"},"\u2061")))),(0,n.kt)("mo",{parentName:"mrow",fence:"true"},")")),(0,n.kt)("mo",{parentName:"mrow"},"+"),(0,n.kt)("msup",{parentName:"mrow"},(0,n.kt)("mn",{parentName:"msup"},"2"),(0,n.kt)("mi",{parentName:"msup"},"E")),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mn",{parentName:"mrow"},"1")))),(0,n.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,n.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"}))),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\begin{align} &Q_\\text{FP4}(X) = \\frac{\\gamma}{2^{M+b}} \\text{Round} \\left( \\frac{2^{M+b}}{\\gamma} X \\right), \\quad \\gamma = 2^{\\max(\\lfloor \\lfloor \\log_2 |X| \\rfloor + b \\rfloor,1)}\\\\ &b = \\log_2 \\left( \\frac{2 - 2^{-M}}{|X|_{\\max}} \\right) + 2^E - 1 \\end{align}")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"5.5445em",verticalAlign:"-2.5222em"}}),(0,n.kt)("span",{parentName:"span",className:"mtable"},(0,n.kt)("span",{parentName:"span",className:"col-align-r"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.0222em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.0222em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5261em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"})),(0,n.kt)("span",{parentName:"span",style:{top:"-2.2539em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5261em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.5222em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"col-align-l"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.0222em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.0222em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5261em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"Q"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3283em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord text mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"FP4"))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.1076em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.7751em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.989em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"M"),(0,n.kt)("span",{parentName:"span",className:"mbin mtight"},"+"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b"))))))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.686em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"Round")),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"minner"},(0,n.kt)("span",{parentName:"span",className:"mopen delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},"(")),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.5261em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8491em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"M"),(0,n.kt)("span",{parentName:"span",className:"mbin mtight"},"+"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b")))))))))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8804em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mclose delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},")"))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mpunct"},","),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"1em"}}),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05556em"}},"\u03b3"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.938em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mop mtight"},(0,n.kt)("span",{parentName:"span",className:"mtight"},"m"),(0,n.kt)("span",{parentName:"span",className:"mtight"},"a"),(0,n.kt)("span",{parentName:"span",className:"mtight"},"x")),(0,n.kt)("span",{parentName:"span",className:"mopen mtight"},"(\u230a\u230a"),(0,n.kt)("span",{parentName:"span",className:"mop mtight"},(0,n.kt)("span",{parentName:"span",className:"mop mtight"},(0,n.kt)("span",{parentName:"span",className:"mtight"},"l"),(0,n.kt)("span",{parentName:"span",className:"mtight"},"o"),(0,n.kt)("span",{parentName:"span",className:"mtight",style:{marginRight:"0.01389em"}},"g")),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1944em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.2341em",marginRight:"0.0714em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2659em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mspace mtight",style:{marginRight:"0.1952em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mclose mtight"},"\u230b"),(0,n.kt)("span",{parentName:"span",className:"mbin mtight"},"+"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"b"),(0,n.kt)("span",{parentName:"span",className:"mclose mtight"},"\u230b"),(0,n.kt)("span",{parentName:"span",className:"mpunct mtight"},","),(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"1"),(0,n.kt)("span",{parentName:"span",className:"mclose mtight"},")"))))))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-2.2539em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5261em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal"},"b"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mop"},(0,n.kt)("span",{parentName:"span",className:"mop"},"lo",(0,n.kt)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.207em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.4559em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2441em"}},(0,n.kt)("span",{parentName:"span"})))))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.kt)("span",{parentName:"span",className:"minner"},(0,n.kt)("span",{parentName:"span",className:"mopen delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},"(")),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mopen nulldelimiter"}),(0,n.kt)("span",{parentName:"span",className:"mfrac"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.5183em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.314em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.1514em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mop mtight"},(0,n.kt)("span",{parentName:"span",className:"mtight"},"m"),(0,n.kt)("span",{parentName:"span",className:"mtight"},"a"),(0,n.kt)("span",{parentName:"span",className:"mtight"},"x")))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,n.kt)("span",{parentName:"span"})))))))),(0,n.kt)("span",{parentName:"span",style:{top:"-3.23em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"frac-line",style:{borderBottomWidth:"0.04em"}})),(0,n.kt)("span",{parentName:"span",style:{top:"-3.677em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8413em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"M")))))))))))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.936em"}},(0,n.kt)("span",{parentName:"span"}))))),(0,n.kt)("span",{parentName:"span",className:"mclose nulldelimiter"})),(0,n.kt)("span",{parentName:"span",className:"mclose delimcenter",style:{top:"0em"}},(0,n.kt)("span",{parentName:"span",className:"delimsizing size3"},")"))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"msupsub"},(0,n.kt)("span",{parentName:"span",className:"vlist-t"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8913em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-3.113em",marginRight:"0.05em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,n.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,n.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.05764em"}},"E")))))))),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"1")))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.5222em"}},(0,n.kt)("span",{parentName:"span"}))))))),(0,n.kt)("span",{parentName:"span",className:"tag"},(0,n.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"3.0222em"}},(0,n.kt)("span",{parentName:"span",style:{top:"-5.0222em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5261em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"})),(0,n.kt)("span",{parentName:"span",style:{top:"-2.2539em"}},(0,n.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.5261em"}}),(0,n.kt)("span",{parentName:"span",className:"eqn-num"}))),(0,n.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,n.kt)("span",{parentName:"span",className:"vlist-r"},(0,n.kt)("span",{parentName:"span",className:"vlist",style:{height:"2.5222em"}},(0,n.kt)("span",{parentName:"span"}))))))))),(0,n.kt)("p",null,"\uc5ec\uae30\uc11c, ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"E")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"E")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05764em"}},"E")))))," \uc640 ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"M")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"M")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"M")))))," \uc740 \uac01\uac01 exponent \uc640 mantissa \uc758 bit-width \ub97c \ub098\ud0c0\ub0b8\ub2e4."),(0,n.kt)("p",null,"\uc800\uc790\ub294 ",(0,n.kt)("strong",{parentName:"p"},"E2M1 format")," \uc744 \uc0ac\uc6a9\ud558\uba70, \uc774\ub294 larger dynamic range \ub97c \uc81c\uacf5\ud55c\ub2e4.  "),(0,n.kt)("p",null,"Tab. 1 \uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\ub4ef\uc774, ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8 \uc5d0 FP4 quantization \uc744 \uc801\uc6a9\ud55c \uacbd\uc6b0, hybrid quantization \ubc0f sparsification \uae30\ubc18 integer quantization \uacfc \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \ubcf4\uc778\ub2e4"),".  "),(0,n.kt)("h2",{id:"3-experiments"},"3 Experiments"),(0,n.kt)("p",null,"BitNet a4.8 \uc744 BitNet b1.58 \ubc0f \uc800\uc790\uac00 \uc7ac\ud604\ud55c FP16 LLaMA LLM \uacfc \ube44\uad50\ud588\ub2e4."),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"1.58-bit model \uc758 \uacbd\uc6b0, BitNet b1.58 \uc758 training recipe \ub97c \ub530\ub974\uba70 two-stage weight decay \ubc0f learning rate scheduling \uc744 \uc801\uc6a9\ud588\ub2e4. \uc790\uc138\ud55c \uc0ac\ud56d\uc740 Appendix A \uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\ub2e4.  "),(0,n.kt)("li",{parentName:"ul"},"all models \ub294 RedPajama dataset \uc5d0\uc11c 100B training tokens \uc744 \uc0ac\uc6a9\ud558\uc5ec \ud559\uc2b5\ub418\uc5c8\ub2e4."),(0,n.kt)("li",{parentName:"ul"},"BitNet a4.8 \uc758 \uacbd\uc6b0, ",(0,n.kt)("strong",{parentName:"li"},"8-bit activations")," \ub85c ",(0,n.kt)("strong",{parentName:"li"},"95B tokens")," \ud559\uc2b5\ud55c \ud6c4, optimizer state \ub97c \uc7ac\uc0ac\uc6a9\ud558\uc5ec ",(0,n.kt)("strong",{parentName:"li"},"hybrid quantization \ubc0f sparsification")," \uc744 \uc801\uc6a9\ud558\ub294 ",(0,n.kt)("strong",{parentName:"li"},"5B tokens \ucd94\uac00 \ud559\uc2b5")," \uc744 \uc218\ud589\ud588\ub2e4."),(0,n.kt)("li",{parentName:"ul"},"\ub610\ud55c, attention output projection \uc5d0 \ub300\ud55c ",(0,n.kt)("strong",{parentName:"li"},"Top-K sparsification \ube44\uc728\uc744 50%")," \ub85c \uc124\uc815\ud588\ub2e4.  ")),(0,n.kt)("p",null,"\ubaa8\ub378 \uc131\ub2a5 \ud3c9\uac00\ub97c \uc704\ud574 ",(0,n.kt)("strong",{parentName:"p"},"lm-evaluation-harness toolkit")," \uc744 \uc0ac\uc6a9\ud558\uc5ec \ub2e4\uc591\ud55c ",(0,n.kt)("strong",{parentName:"p"},"zero-shot language task")," \uc5d0 \ub300\ud55c \uc815\ud655\ub3c4\ub97c \uce21\uc815\ud588\ub2e4."),(0,n.kt)("p",null,"\uc0ac\uc6a9\ud55c task \ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4:  "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"ARC-Easy (ARCe)  "),(0,n.kt)("li",{parentName:"ul"},"ARC-Challenge (ARCc)  "),(0,n.kt)("li",{parentName:"ul"},"HellaSwag (HS)  "),(0,n.kt)("li",{parentName:"ul"},"Winogrande (WGe)  "),(0,n.kt)("li",{parentName:"ul"},"PIQA (PQ)  "),(0,n.kt)("li",{parentName:"ul"},"C4 validation set \uc5d0 \ub300\ud55c perplexity \ub3c4 \uce21\uc815\ud588\ub2e4.  ")),(0,n.kt)("h2",{id:"31-main-results"},"3.1 Main Results"),(0,n.kt)("p",null,"Tab. 1 \uc5d0 BitNet a4.8, BitNet b1.58, FP16 LLaMA LLM \uc758 \ud3c9\uac00 \uacb0\uacfc\ub97c \uc815\ub9ac\ud588\ub2e4."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Table 1",src:t(87327).Z,width:"1325",height:"815"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\ubaa8\ub378 \ud06c\uae30\uac00 \uc99d\uac00\ud560\uc218\ub85d, ",(0,n.kt)("strong",{parentName:"li"},"full-precision (FP16) LLaMA LLM \uacfc BitNet b1.58 \uac04\uc758 \uc131\ub2a5 \ucc28\uc774")," \uac00 \uc810\uc810 \uc881\ud600\uc9c0\ub294 \uacbd\ud5a5\uc744 \ubcf4\uc778\ub2e4."),(0,n.kt)("li",{parentName:"ul"},"\ud2b9\ud788, ",(0,n.kt)("strong",{parentName:"li"},"7B model \uc758 \uacbd\uc6b0 BitNet b1.58 \uc740 LLaMA LLM \uacfc perplexity \ubc0f downstream task average accuracy \uce21\uba74\uc5d0\uc11c \uac70\uc758 \ub3d9\uc77c\ud55c \uc131\ub2a5")," \uc744 \ub2ec\uc131\ud55c\ub2e4.  "),(0,n.kt)("li",{parentName:"ul"},"\ub610\ud55c, ",(0,n.kt)("strong",{parentName:"li"},"BitNet a4.8 \uc740 BitNet b1.58 \uacfc \ub3d9\ub4f1\ud55c \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uba74\uc11c\ub3c4 inference efficiency \uac00 \ud06c\uac8c \ud5a5\uc0c1")," \ub41c\ub2e4.  ")),(0,n.kt)("h4",{id:"sparsity"},"Sparsity"),(0,n.kt)("p",null,"Tab. 2 \ub294 BitNet a4.8, BitNet b1.58, FP16 LLaMA LLM \uc758 \uac01 component \ubcc4 sparsity \ub97c \ubcf4\uc5ec\uc900\ub2e4. \uc5ec\uae30\uc11c sparsity \ub294 C4 validation set \uc5d0\uc11c non-embedding parameter \ub97c \uae30\uc900\uc73c\ub85c \uacc4\uc0b0\ub418\uc5c8\ub2e4.  "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Table 3",src:t(40922).Z,width:"1415",height:"716"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"BitNet a4.8 \uc740 ",(0,n.kt)("strong",{parentName:"li"},"BitNet b1.58 \ubc0f LLaMA LLM \ubcf4\ub2e4 \ud6e8\uc52c higher sparsity")," \ub97c \ub2ec\uc131\ud588\ub2e4.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"\uc608\ub97c \ub4e4\uc5b4, 7B model \uc758 \uacbd\uc6b0 BitNet a4.8 \uc740 overall sparsity \uac00 44.5% \uc774\uba70, \uc624\uc9c1 3.4B active parameters \uc5d0 \ubd88\uacfc\ud558\ub2e4."),(0,n.kt)("li",{parentName:"ul"},"\ud2b9\ud788, FFN down projection \uc758 inputs \ub294 \ub9e4\uc6b0 \ub192\uc740 sparsity \ub97c \ubcf4\uc600\uc73c\uba70, \uc774\ub294 intermediate state disbributions \uc774 0 \uc744 \uc911\uc2ec\uc73c\ub85c \uae09\uaca9\ud558\uac8c \uc3e0\ub9ac\ub294 \ud604\uc0c1\uacfc \uc77c\uce58\ud55c\ub2e4."))),(0,n.kt)("li",{parentName:"ul"},"\ub610\ud55c, ",(0,n.kt)("strong",{parentName:"li"},"gate projection output sparsity \uac00 \ub192\uc544 up projection \uc758 sparsity \ub3c4 \ud568\uaed8 \uc99d\uac00")," \ud558\ub294 \uacbd\ud5a5\uc744 \ubcf4\uc600\ub2e4. ",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"\uc608\ub97c \ub4e4\uc5b4, 7B BitNet a4.8 \uc758 \uacbd\uc6b0:  ",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"Gate projection \ucd9c\ub825 sparsity: 67.5%"),(0,n.kt)("li",{parentName:"ul"},"Up projection \uc785\ub825 sparsity: 12.0%"),(0,n.kt)("li",{parentName:"ul"},"\ub530\ub77c\uc11c up projection \uc804\uccb4 sparsity \ub294: ",(0,n.kt)("span",{parentName:"li",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mn",{parentName:"mrow"},"12.0"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"%"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"\xd7"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mn",{parentName:"mrow"},"1"),(0,n.kt)("mo",{parentName:"mrow"},"\u2212"),(0,n.kt)("mn",{parentName:"mrow"},"67.5"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"%"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mn",{parentName:"mrow"},"71.4"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"%")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"1 - (1 - 12.0\\%) \\times (1 - 67.5\\%) = 71.4\\%")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7278em",verticalAlign:"-0.0833em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"1"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"1"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"12.0%"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\xd7"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"1"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.kt)("span",{parentName:"span",className:"mbin"},"\u2212"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"67.5%"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8056em",verticalAlign:"-0.0556em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"71.4%"))))))))))),(0,n.kt)("h4",{id:"low-bit-attention"},"Low-bit Attention"),(0,n.kt)("p",null,"Tab. 3 \uc5d0\ub294 3B \ubc0f 7B model size \uc758 BitNet a4.8 \uc5d0 \ub300\ud574 low-bit attention \uc744 \uc801\uc6a9\ud55c \uacb0\uacfc\ub97c \uc815\ub9ac\ud588\ub2e4. "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Table 3",src:t(84538).Z,width:"1478",height:"559"})),(0,n.kt)("p",null,"Low-bit attention \uc740 long sequence \ub97c \ud6a8\uc728\uc801\uc73c\ub85c modeling \ud558\ub294 \ub370 \ud544\uc218\uc801\uc774\ub2e4. \uc774\ub294 KV cache \uc758 memory usage \ub97c \uc904\uc774\uace0 I/O \ube44\uc6a9\uc744 \ub0ae\ucd94\uba70, attention \uc5f0\uc0b0\uc744 \uac00\uc18d\uc2dc\ud0a8\ub2e4. \uc2e4\ud5d8\uc5d0\uc11c\ub294 ",(0,n.kt)("strong",{parentName:"p"},"post-RoPE quantization")," \uc744 \uc801\uc6a9\ud588\ub2e4."),(0,n.kt)("p",null,"QKV head \ub294 \ubcc4\ub3c4\uc758 calibration dataset \uc5c6\uc774 absmax function \uc744 \uc0ac\uc6a9\ud558\uc5ec unsigned integer \ub85c quantize \ud588\ub2e4. \ub610\ud55c, 3-bit KV quantization \uc2dc\uc5d0\ub294 bos token head \ub97c 4-bit \ub85c \uc720\uc9c0\ud558\uc5ec outlier feature \ub97c \ubcf4\uc874\ud588\ub2e4.  "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Tab. 3 \uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\ub4ef\uc774, BitNet a4.8 \uc740 3B \ubc0f 7B model \uc5d0\uc11c 4-bit KV \ub610\ub294 QKV head \ub97c \uc801\uc6a9\ud574\ub3c4 \uc815\ud655\ub3c4 \uac10\uc18c\uac00 \uac70\uc758 \uc5c6\uc74c\uc744 \ubcf4\uc778\ub2e4.  "),(0,n.kt)("li",{parentName:"ul"},"\ub610\ud55c, KV cache \ub97c 3-bit \uc815\uc218\ub85c quantize \ud574\ub3c4 \ud3c9\uade0 \uc815\ud655\ub3c4 \uc800\ud558\uac00 \uac70\uc758 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4.  ")),(0,n.kt)("h2",{id:"32-ablation-study"},"3.2 Ablation Study"),(0,n.kt)("h4",{id:"hybrid-architecture"},"Hybrid architecture"),(0,n.kt)("p",null,"Fig. 4 \ub294 700M BitNet a4.8 \uc5d0 \ub300\ud574 full INT4/FP4 quantization \uacfc hybrid quantization, sparsification \uc744 \uc801\uc6a9\ud588\uc744 \ub54c\uc758 training loss curve \ub97c \ubcf4\uc5ec\uc900\ub2e4. "),(0,n.kt)("p",null,"\uc774 \ubaa8\ub378\ub4e4\uc740 RedPajama dataset \uc758 25B tokens \uc5d0 \ub300\ud574 first-stage scheduling \uc73c\ub85c \ud559\uc2b5\ud588\ub2e4. full INT4 \uc640 FP4 quantization \uc744 \uc704\ud574 \uac01\uac01 absmean quantizer \uc640 MinMax quantizer \ub97c \uc0ac\uc6a9\ud588\ub2e4. \uac8c\ub2e4\uac00 full INT4 quantization \uc758 \uacbd\uc6b0, FFN \uc758 down projection \uc5d0\ub294 inputs \uc758 larger outliers \ub85c \uc778\ud574 ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"\u03b2"),(0,n.kt)("mo",{parentName:"mrow"},"="),(0,n.kt)("mn",{parentName:"mrow"},"2"),(0,n.kt)("mtext",{parentName:"mrow"},"mean"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta = 2\\text{mean}(|X|)")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2"),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,n.kt)("span",{parentName:"span",className:"mrel"},"="),(0,n.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"mean")),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))))," \ub97c \uc801\uc6a9\ud55c absmean quantizer \ub97c \uc0ac\uc6a9\ud588\ub2e4."),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Figure 4",src:t(51105).Z,width:"1268",height:"597"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Fig. 4 \uc5d0\uc11c \ubcf4\uc774\ub4ef, full INT4 quantization \uc740 divergence \ub85c \uc774\uc5b4\uc9c4\ub2e4. "),(0,n.kt)("li",{parentName:"ul"},"\ub610\ud55c hybrid architecture \ub294 training perplexity \uce21\uba74\uc5d0\uc11c full FP4 architecture \ubcf4\ub2e4 \ud6e8\uc52c \uc6b0\uc218\ud55c \uc131\ub2a5\uc744 \ubcf4\uc778\ub2e4.")),(0,n.kt)("h4",{id:"down-projection-of-ffn"},"Down projection of FFN"),(0,n.kt)("p",null,"1.3B BitNet a4.8 \uc744 \ub300\uc0c1\uc73c\ub85c FFN \uc758 down projection \uc5d0\uc11c \uc0ac\uc6a9\ud558\ub294 quantization \uc774\ub098 activation function \uc744 \ub2ec\ub9ac\ud588\uc744 \ub54c\ub97c \ube44\uad50\ud588\ub2e4. \ubaa8\ub4e0 \ubaa8\ub378\uc740 RedPajama dataset \uc758 50B tokens \uc5d0 \ub300\ud574 first-stage scheduling \uc73c\ub85c \ud559\uc2b5\ud588\ub2e4. "),(0,n.kt)("p",null,"\uacf5\uc815\ud55c \ube44\uad50\ub97c \uc704\ud574 \ub2e4\ub978 activations \uc740 8-bits \ub85c \uc720\uc9c0\ud588\ub2e4. INT8 quantization \uc5d0\ub294 absmax quantizer \ub97c, FP4 quantization \uc5d0\ub294 MinMax quantizer \ub97c \uc0ac\uc6a9\ud588\ub2e4. absmean quantizer \uc758 ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mi",{parentName:"mrow"},"\u03b2")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\beta")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"0.8889em",verticalAlign:"-0.1944em"}}),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05278em"}},"\u03b2")))))," \uac12\uc740 ",(0,n.kt)("span",{parentName:"p",className:"math math-inline"},(0,n.kt)("span",{parentName:"span",className:"katex"},(0,n.kt)("span",{parentName:"span",className:"katex-mathml"},(0,n.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,n.kt)("semantics",{parentName:"math"},(0,n.kt)("mrow",{parentName:"semantics"},(0,n.kt)("mn",{parentName:"mrow"},"2"),(0,n.kt)("mtext",{parentName:"mrow"},"mean"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mi",{parentName:"mrow"},"X"),(0,n.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,n.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,n.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"2\\text{mean}(|X|)")))),(0,n.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,n.kt)("span",{parentName:"span",className:"base"},(0,n.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.kt)("span",{parentName:"span",className:"mord"},"2"),(0,n.kt)("span",{parentName:"span",className:"mord text"},(0,n.kt)("span",{parentName:"span",className:"mord"},"mean")),(0,n.kt)("span",{parentName:"span",className:"mopen"},"("),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.07847em"}},"X"),(0,n.kt)("span",{parentName:"span",className:"mord"},"\u2223"),(0,n.kt)("span",{parentName:"span",className:"mclose"},")")))))," \ub85c \uc124\uc815\ud588\ub2e4. "),(0,n.kt)("p",null,"Fig. 5 \ub294 \uc774\ub7ec\ud55c \ubaa8\ub378\ub4e4\uc758 training loss curve \ub97c \ubcf4\uc5ec\uc900\ub2e4. "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Figure 5",src:t(35675).Z,width:"1468",height:"643"})),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Squared ReLU \ub294 Swish \uc640 \ube44\uad50\ud588\uc744 \ub54c, higher sparsity \ub97c \uac00\ub2a5\ud558\uac8c \ud558\uba74\uc11c\ub3c4 \uc57d\uac04 \ub354 \ub098\uc740 training perplexity \ub97c \ub2ec\uc131\ud55c\ub2e4. "),(0,n.kt)("li",{parentName:"ul"},"\ub610\ud55c down projection \uc758 \uc785\ub825\uc5d0 FP4 quantization \uc744 \uc801\uc6a9\ud558\uba74 \uc131\ub2a5\uc774 \ud06c\uac8c \uc800\ud558\ub418\uba70, INT4 activations \uc5d0 STE \ub97c \uc801\uc6a9\ud558\uba74 divergence \uac00 \ubc1c\uc0dd\ud55c\ub2e4.")),(0,n.kt)("h4",{id:"output-projection-of-attention"},"Output projection of attention"),(0,n.kt)("p",null,"Tab. 4 \ub294 attention \uc758 output projection \uc5d0 \ub4e4\uc5b4\uac00\ub294 \uc785\ub825\uc5d0 \ub300\ud574 Top-K sparsification \uc744 \uc801\uc6a9\ud588\uc744 \ub54c\uc640 \uc801\uc6a9\ud558\uc9c0 \uc54a\uc558\uc744 \ub54c\uc758 3B BitNet a4.8 \uacb0\uacfc\ub97c \uc790\uc138\ud788 \ubcf4\uc5ec\uc900\ub2e4. "),(0,n.kt)("p",null,"\ub450 \ubaa8\ub378 \ubaa8\ub450 8-bit \uc5d0\uc11c 4-bit activations \ub85c \uc804\ud658\ud558\ub294 \ub3d9\uc77c\ud55c two stage recipe \ub85c \ud559\uc2b5\ud588\ub2e4. sparsification \uc758 K \ub294 50% \ub85c \uc124\uc815\ud588\ub2e4. baseline \uc740 output projection \uc758 \uc785\ub825\uc5d0 \ub300\ud574 INT8 absmax quantizer \ub97c \uc0ac\uc6a9\ud588\ub2e4. "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Table 4",src:t(3604).Z,width:"1456",height:"272"})),(0,n.kt)("p",null,"\uacb0\uacfc\uc5d0 \ub530\ub974\uba74, TopK sparsification \uc740 perplexity \uc640 accuracy \uc758 \uc190\uc2e4\uc744 \ubb34\uc2dc\ud560 \uc218 \uc788\uc744 \uc815\ub3c4\ub85c \ubbf8\ubbf8\ud558\uac8c \ub9cc\ub4e0\ub2e4."),(0,n.kt)("h4",{id:"4-bit-quantization"},"4-bit quantization"),(0,n.kt)("p",null,"3B BitNet a4.8 \uc758 attention \uacfc FFN \uc5d0 \ub4e4\uc5b4\uac00\ub294 \uc785\ub825\uc5d0 \ub300\ud574 \uc11c\ub85c \ub2e4\ub978 4-bit quantizer \ub97c \uc801\uc6a9\ud588\uc744 \ub54c\uc758 loss curves \ub97c Fig. 6 \uc5d0 \uc81c\uc2dc\ud588\ub2e4. "),(0,n.kt)("p",null,"BitNet a4.8 \uc744 MinMax quantizer \ub85c E2M1 \uacfc E1M2 format \uc758 floating-point quantization \uacfc absmax, absmean quantizer \ub97c \uc0ac\uc6a9\ud55c integer quantization \uc73c\ub85c \ube44\uad50\ud588\ub2e4. "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Figure 6",src:t(85263).Z,width:"548",height:"561"})),(0,n.kt)("p",null,"Fig. 6 \uc5d0\uc11c \ubcf4\uc774\ub4ef, FP4 quantization \uc758 E2M1 format \uacfc absmean quantizer \ub97c \uc0ac\uc6a9\ud55c INT4 \uac00 \uc791\uc740 \ud06c\uae30\uc758 activation entries \ub97c \ub2e4\ub8e8\ub294 \ub370 \uc720\ub9ac\ud558\uc5ec, \uc57d\uac04 \ub354 \ub098\uc740 training perplexity \ub97c \ub2ec\uc131\ud55c\ub2e4."),(0,n.kt)("h3",{id:"33-more-training-tokens"},"3.3 More Training Tokens"),(0,n.kt)("p",null,"\uc774\uc804 \uc5f0\uad6c\uc5d0\uc11c\ub294 training token \uc218\uac00 \uc99d\uac00\ud560\uc218\ub85d activation outlier \uc758 \ube48\ub3c4\ub3c4 \uc99d\uac00\ud55c\ub2e4\ub294 \uc0ac\uc2e4\uc744 \ubcf4\uace0\ud588\ub2e4."),(0,n.kt)("p",null,"BitNet a4.8 \uc758 ",(0,n.kt)("strong",{parentName:"p"},"scalability")," \ub97c \uac80\uc99d\ud558\uae30 \uc704\ud574, 2B parameter \ubaa8\ub378\uc744 2T tokens \ub85c \ud559\uc2b5\ud558\ub294 \ucd94\uac00 \uc2e4\ud5d8\uc744 \uc218\ud589\ud588\ub2e4. \ub3d9\uc77c\ud55c training data \ubc0f \uc124\uc815\uc744 \uc720\uc9c0\ud558\uba74\uc11c BitNet b1.58 \uacfc \ube44\uad50\ud588\ub2e4.  "),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Table 5",src:t(46796).Z,width:"1450",height:"252"})),(0,n.kt)("p",null,"Tab. 5 \uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\ub4ef\uc774, BitNet a4.8 \uc740 4-bit activation compression \uc744 \uc801\uc6a9\ud55c \uc0c1\ud0dc\uc5d0\uc11c\ub3c4 BitNet b1.58 \uacfc \uac70\uc758 \ub3d9\uc77c\ud55c \uc815\ud655\ub3c4\ub97c \uc720\uc9c0\ud55c\ub2e4. \uc774\ub294 large-scale training token \ud658\uacbd\uc5d0\uc11c\ub3c4 hybrid quantization \ubc0f sparsification \uae30\ubc95\uc774 \ud6a8\uacfc\uc801\uc784\uc744 \ubcf4\uc5ec\uc900\ub2e4.  "),(0,n.kt)("h2",{id:"4-conclusion"},"4 Conclusion"),(0,n.kt)("p",null,"\ubcf8 \ub17c\ubb38\uc5d0\uc11c\ub294 ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8")," \uc744 \uc81c\uc548\ud558\uc5ec ",(0,n.kt)("strong",{parentName:"p"},"1-bit LLM \uc744 \uc704\ud55c 4-bit activation")," \uc744 \uac00\ub2a5\ud558\uac8c \ud588\ub2e4."),(0,n.kt)("p",null,"BitNet a4.8 \uc740 ",(0,n.kt)("strong",{parentName:"p"},"hybrid quantization \ubc0f sparsification")," \uae30\ubc95\uc744 \ud65c\uc6a9\ud558\uc5ec activation \uc758 ",(0,n.kt)("strong",{parentName:"p"},"outlier channel \ub85c \uc778\ud574 \ubc1c\uc0dd\ud558\ub294 quantization error \ub97c \uc904\uc774\ub294 \uc0c8\ub85c\uc6b4 \uc544\ud0a4\ud14d\ucc98"),"\ub97c \uc0ac\uc6a9\ud588\ub2e4.  "),(0,n.kt)("p",null,"\ud2b9\ud788, \ub2e4\uc74c \ubc29\uc2dd\uc744 \ub3c4\uc785\ud588\ub2e4.  "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"Attention \ubc0f FFN layers \uc758 input")," \uc5d0\ub294 ",(0,n.kt)("strong",{parentName:"li"},"4-bit quantization")," \uc801\uc6a9  "),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"intermediate state")," \uc5d0\ub294 ",(0,n.kt)("strong",{parentName:"li"},"8-bit sparsification")," \uc801\uc6a9  ")),(0,n.kt)("p",null,"BitNet a4.8 \uc740 W1.58A8 \ubaa8\ub378\uc744 W1.58A4 \ubaa8\ub378\ub85c continue-training \ud558\ub294 \ubc29\uc2dd\uc73c\ub85c \ud559\uc2b5\ub418\uc5c8\ub2e4."),(0,n.kt)("p",null,"\uc2e4\ud5d8 \uacb0\uacfc, ",(0,n.kt)("strong",{parentName:"p"},"BitNet a4.8 \uc740 BitNet b1.58 \uacfc \ub3d9\uc77c\ud55c training \ube44\uc6a9\uc73c\ub85c \ub3d9\ub4f1\ud55c \uc131\ub2a5\uc744 \ub2ec\uc131")," \ud558\uba74\uc11c\ub3c4, ",(0,n.kt)("strong",{parentName:"p"},"inference efficiency \uac00 \ud06c\uac8c \ud5a5\uc0c1\ub428"),"\uc744 \ud655\uc778\ud588\ub2e4.  "),(0,n.kt)("h1",{id:"a-hyper-parameters"},"A Hyper-parameters"),(0,n.kt)("p",null,(0,n.kt)("img",{alt:"Table 6, 7",src:t(73485).Z,width:"1386",height:"834"})))}c.isMDXComponent=!0},28272:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-28-295f03e80ae8e66eefdea1f7144219d9.png"},33445:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-29-d9144041e5f52130023b79d09ad88837.png"},87327:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-30-a90ca1b8fade013ccfb86e98c8755b7b.png"},40922:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-31-966abe886c4d640fd72987bbc0e028f4.png"},84538:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-32-991e5b95b945ab5e99736ec683513591.png"},51105:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-33-0615af620f7495df5e69ab66a9e0d7cc.png"},35675:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-34-4ceade63198377eef8d55a3eef45f7a9.png"},85263:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-35-ba1f3bb36d523e7c265feeb76971e8e3.png"},3604:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-36-7e17f95e13b1a533c7cd5d51c821ff8b.png"},46796:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-37-410e0dfd1fdcbbdf78088d24d4df8473.png"},73485:(a,e,t)=>{t.d(e,{Z:()=>s});const s=t.p+"assets/images/image-38-36675e4ae74ec31958943b3b28e8e949.png"}}]);