"use strict";(self.webpackChunkWon_Yong_Jo=self.webpackChunkWon_Yong_Jo||[]).push([[657],{3905:(a,e,t)=>{t.d(e,{Zo:()=>N,kt:()=>h});var n=t(67294);function s(a,e,t){return e in a?Object.defineProperty(a,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):a[e]=t,a}function m(a,e){var t=Object.keys(a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(a);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.push.apply(t,n)}return t}function p(a){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?m(Object(t),!0).forEach((function(e){s(a,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(t,e))}))}return a}function l(a,e){if(null==a)return{};var t,n,s=function(a,e){if(null==a)return{};var t,n,s={},m=Object.keys(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||(s[t]=a[t]);return s}(a,e);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(a);for(n=0;n<m.length;n++)t=m[n],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(a,t)&&(s[t]=a[t])}return s}var r=n.createContext({}),i=function(a){var e=n.useContext(r),t=e;return a&&(t="function"==typeof a?a(e):p(p({},e),a)),t},N=function(a){var e=i(a.components);return n.createElement(r.Provider,{value:e},a.children)},o="mdxType",k={inlineCode:"code",wrapper:function(a){var e=a.children;return n.createElement(n.Fragment,{},e)}},c=n.forwardRef((function(a,e){var t=a.components,s=a.mdxType,m=a.originalType,r=a.parentName,N=l(a,["components","mdxType","originalType","parentName"]),o=i(t),c=s,h=o["".concat(r,".").concat(c)]||o[c]||k[c]||m;return t?n.createElement(h,p(p({ref:e},N),{},{components:t})):n.createElement(h,p({ref:e},N))}));function h(a,e){var t=arguments,s=e&&e.mdxType;if("string"==typeof a||s){var m=t.length,p=new Array(m);p[0]=c;var l={};for(var r in e)hasOwnProperty.call(e,r)&&(l[r]=e[r]);l.originalType=a,l[o]="string"==typeof a?a:s,p[1]=l;for(var i=2;i<m;i++)p[i]=t[i];return n.createElement.apply(null,p)}return n.createElement.apply(null,t)}c.displayName="MDXCreateElement"},73570:(a,e,t)=>{t.r(e),t.d(e,{assets:()=>r,contentTitle:()=>p,default:()=>k,frontMatter:()=>m,metadata:()=>l,toc:()=>i});var n=t(87462),s=(t(67294),t(3905));const m={slug:"SinkLoRA",title:"SinkLoRA: Enhanced Efficiency and Chat Capabilities for Long-Context Large Language Models",tags:["SinkLoRA","LoRA","PEFT","Low-Rank","Shifted Sparse Attention","S2-Attn","SF-Attn"]},p=void 0,l={unversionedId:"Paper/NLP/PEFT/Composition/2024-06-SinkLoRA",id:"Paper/NLP/PEFT/Composition/2024-06-SinkLoRA",title:"SinkLoRA: Enhanced Efficiency and Chat Capabilities for Long-Context Large Language Models",description:"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 :",source:"@site/docs/Paper/NLP/PEFT/Composition/2024-06-SinkLoRA.md",sourceDirName:"Paper/NLP/PEFT/Composition",slug:"/Paper/NLP/PEFT/Composition/SinkLoRA",permalink:"/docs/Paper/NLP/PEFT/Composition/SinkLoRA",draft:!1,editUrl:"https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/NLP/PEFT/Composition/2024-06-SinkLoRA.md",tags:[{label:"SinkLoRA",permalink:"/docs/tags/sink-lo-ra"},{label:"LoRA",permalink:"/docs/tags/lo-ra"},{label:"PEFT",permalink:"/docs/tags/peft"},{label:"Low-Rank",permalink:"/docs/tags/low-rank"},{label:"Shifted Sparse Attention",permalink:"/docs/tags/shifted-sparse-attention"},{label:"S2-Attn",permalink:"/docs/tags/s-2-attn"},{label:"SF-Attn",permalink:"/docs/tags/sf-attn"}],version:"current",frontMatter:{slug:"SinkLoRA",title:"SinkLoRA: Enhanced Efficiency and Chat Capabilities for Long-Context Large Language Models",tags:["SinkLoRA","LoRA","PEFT","Low-Rank","Shifted Sparse Attention","S2-Attn","SF-Attn"]},sidebar:"tutorialSidebar",previous:{title:"RoseLoRA: Row and Column-wise Sparse Low-rank Adaptation of Pre-trained Language Model for Knowledge Editing and Fine-tuning",permalink:"/docs/Paper/NLP/PEFT/Composition/RoseLoRA"},next:{title:"GIFT-SW: Gaussian noise Injected Fine-Tuning of Salient Weights for LLMs",permalink:"/docs/Paper/NLP/PEFT/Composition/GIFT-SW"}},r={},i=[{value:"Motivation 1: Elevating Attention Scores for Initial Tokens Prior studies have demonstrated the Attention Sink phenomeno",id:"motivation-1-elevating-attention-scores-for-initial-tokens-prior-studies-have-demonstrated-the-attention-sink-phenomeno",level:4},{value:"Motivation 2: Maintaining Initial Tokens During Fine-Tuning",id:"motivation-2-maintaining-initial-tokens-during-fine-tuning",level:4},{value:"Motivation 3: Flexible Deployment of Inference Strategy",id:"motivation-3-flexible-deployment-of-inference-strategy",level:4},{value:"2.1 Long-context Transformers",id:"21-long-context-transformers",level:2},{value:"2.2 Long-context LLMs",id:"22-long-context-llms",level:2},{value:"2.3 KV-Cache Compression",id:"23-kv-cache-compression",level:2},{value:"3.1 Background",id:"31-background",level:2},{value:"LongLoRA.",id:"longlora",level:4},{value:"Attention Sink.",id:"attention-sink",level:4},{value:"Heavy-Hitter Oracle.",id:"heavy-hitter-oracle",level:4},{value:"3.2 Applying Sink Fixed Attention to Improve Fine Tune Progress",id:"32-applying-sink-fixed-attention-to-improve-fine-tune-progress",level:2},{value:"3.2.1 Pilot study",id:"321-pilot-study",level:3},{value:"3.2.2 Sink Fixed Attention",id:"322-sink-fixed-attention",level:3},{value:"Segmentation &amp; Reassembly Algorithm.",id:"segmentation--reassembly-algorithm",level:4},{value:"Global Attention.",id:"global-attention",level:4},{value:"3.3 Applying KV Cache Algorithm to Accelerate Inference Process",id:"33-applying-kv-cache-algorithm-to-accelerate-inference-process",level:2},{value:"4.1 Experimental Settings",id:"41-experimental-settings",level:2},{value:"4.1.1 Environments",id:"411-environments",level:3},{value:"4.1.2 Models",id:"412-models",level:3},{value:"4.1.3 Training Procedure",id:"413-training-procedure",level:3},{value:"4.1.4 Datasets",id:"414-datasets",level:3},{value:"4.1.5 Metrics",id:"415-metrics",level:3},{value:"Perplexity",id:"perplexity",level:4},{value:"Passkey Retrieval",id:"passkey-retrieval",level:4},{value:"LongBench",id:"longbench",level:4},{value:"4.2 Main Results",id:"42-main-results",level:2},{value:"Perplexity Result.",id:"perplexity-result",level:4},{value:"Passkey Retrieval Result.",id:"passkey-retrieval-result",level:4},{value:"LongBench Result.",id:"longbench-result",level:4},{value:"H_2O Inference Result",id:"h_2o-inference-result",level:4},{value:"4.3 Ablation Study",id:"43-ablation-study",level:2},{value:"Ablation on SF-Attn training steps.",id:"ablation-on-sf-attn-training-steps",level:4},{value:"Ablation on SF-Attn Varation.",id:"ablation-on-sf-attn-varation",level:4},{value:"5.1 The Failure of Shift Operation",id:"51-the-failure-of-shift-operation",level:2},{value:"5.2 The Success of Making Sink Attention Tokens Globally Operative",id:"52-the-success-of-making-sink-attention-tokens-globally-operative",level:2},{value:"5.3 The Convenience of Applying KV Cache Compression Function",id:"53-the-convenience-of-applying-kv-cache-compression-function",level:2},{value:"5.4 The Good Result of Chatbot",id:"54-the-good-result-of-chatbot",level:2}],N={toc:i},o="wrapper";function k(a){let{components:e,...m}=a;return(0,s.kt)(o,(0,n.Z)({},N,m,{components:e,mdxType:"MDXLayout"}),(0,s.kt)("p",null,"\ub17c\ubb38 \ubc0f \uc774\ubbf8\uc9c0 \ucd9c\ucc98 : ",(0,s.kt)("a",{parentName:"p",href:"https://arxiv.org/pdf/2406.05678"},"https://arxiv.org/pdf/2406.05678")),(0,s.kt)("h1",{id:"abstract"},"Abstract"),(0,s.kt)("p",null,"Transformer model \uc758 \uae30\ub2a5\uc744 \ud655\uc7a5\ud558\uc5ec longer sequence length \ub97c \uc218\uc6a9\ud558\ub294 \uac83\uc740 \uc911\uc694\ud55c \ub3c4\uc804 \uacfc\uc81c\uac00 \ub418\uc5c8\ub2e4. "),(0,s.kt)("p",null,"\uc774 \ud655\uc7a5\uc740 language translation \uacfc long-context \ucc98\ub9ac \uac19\uc740 task \ub97c \uac1c\uc120\ud558\ub294 \ub370\ubfd0\ub9cc \uc544\ub2c8\ub77c, chatbot, code generation, multimedia content creation \uac19\uc740 \uc0c8\ub85c\uc6b4 \uc751\uc6a9 \ud504\ub85c\uadf8\ub7a8\uc744 \uac00\ub2a5\ud558\uac8c \ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc8fc\uc694 \uc7a5\uc560\ubb3c\uc740 self-attention \uba54\ucee4\ub2c8\uc998\uc73c\ub85c, \uc774\ub294 sequence length \uc5d0 \ub300\ud574 computation time \uacfc memory requirements \uac00 \uc81c\uacf1\uc801\uc73c\ub85c \uc99d\uac00\ud55c\ub2e4. "),(0,s.kt)("p",null,"LongLoRA \ub294 Shifted Sparse Attention (S2-Attn)\uc744 \uc81c\uc548\ud558\uc5ec context extension \uc744 \ud6a8\uacfc\uc801\uc73c\ub85c \uac00\ub2a5\ud558\uac8c \ud558\uace0, vanilla attention \uacfc \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uba74\uc11c \uc0c1\ub2f9\ud55c \uacc4\uc0b0 \uc808\uc57d\uc744 \uc81c\uacf5\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 LongLoRA \ub294 \uc5ec\uc804\ud788 vanilla attention \uc5d0 \ube44\ud574 \ud6a8\uc728\uc801\uc774\uc9c0 \uc54a\uc73c\uba70, full attention \uc5d0 \ube44\ud574 \uc624\uc9c1 39% \uc758 perplexity \uac1c\uc120\ub9cc\uc744 \ub2ec\uc131\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c \ube44\ud6a8\uc728\uc131\uc740 attention head pattern \ub0b4\uc5d0\uc11c \uc801\uc6a9\ub41c cyclic shift \uac00 attention head \uad6c\uc870\uc5d0 \ud63c\ub780\uc744 \uc77c\uc73c\ud0a4\uac70\ub098 token group \uac04\uc758 \ubd88\ud544\uc694\ud55c information exchange \ub97c \ucd08\ub798\ud558\uae30 \ub54c\ubb38\uc774\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574, \uc800\uc790\ub294 \ub354 \ub098\uc740 work partitioning \uc744 \ud2b9\uc9d5\uc73c\ub85c \ud558\ub294 SinkLoRA \ub97c \uc81c\uc548\ud55c\ub2e4. \uad6c\uccb4\uc801\uc73c\ub85c, "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},'\uc800\uc790\ub294 cyclically shifted attention head groups \uc744 "sink attention tokens" \uc758 global attention \uc73c\ub85c un-shifted state \ub97c \ube44\ub840\uc801\uc73c\ub85c \ubc18\ud658\ud558\ub294 segmentation \ubc0f reassembly algorithm \uc744 \uac16\ucd98 SF-Attn \uc744 \uac1c\ubc1c\ud558\uc600\uc73c\uba70, \uc774\ub294 full attention \uc5d0 \ube44\ud574 92%\uc758 perplexity \uac1c\uc120\uc744 \ub2ec\uc131\ud55c\ub2e4'),(0,s.kt)("li",{parentName:"ul"},"inference \uac00\uc18d\ud654\ub97c \uc704\ud574 SOTA KV cache compression algorithm \uc778 H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \ub97c \uc801\uc6a9\ud558\uc600\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, \uc800\uc790\uc758 self-collected LongAlpaca-plus dataset \uc744 \uc0ac\uc6a9\ud558\uc5ec SinkLoRA \ub97c supervied fine-tuning \ud55c\ub2e4. ")),(0,s.kt)("h1",{id:"1-introduction"},"1. Introduction"),(0,s.kt)("p",null,"Transformer model \uc758 \uae30\ub2a5\uc744 \ud5a5\uc0c1\uc2dc\ucf1c longer sequence length \ub97c \ucc98\ub9ac\ud558\ub294 \uac83\uc740 language translation, long-context \ucc98\ub9ac, chatbot, code generation, multimedia content creation \ub4f1 \ub2e4\uc591\ud55c \uc751\uc6a9 \ubd84\uc57c\uc5d0\uc11c \uc911\uc694\ud558\ub2e4. "),(0,s.kt)("p",null,"\uc8fc\uc694 \ub3c4\uc804 \uacfc\uc81c\ub294 self-attention \uba54\ucee4\ub2c8\uc998\uc73c\ub85c, \uc774\ub294 sequence length \uc5d0 \ub300\ud574 \uc81c\uacf1\uc801\uc73c\ub85c \uc99d\uac00\ud558\uc5ec \ub9c9\ub300\ud55c computation time \uacfc memory requirements \ub97c \ucd08\ub798\ud55c\ub2e4."),(0,s.kt)("p",null,"\uc774\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 \uc5ec\ub7ec \uc811\uadfc \ubc29\uc2dd\uc774 \uc81c\uc548\ub418\uc5c8\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Longformer \uc640 BigBird \ub294 local, global, sparse attention \uba54\ucee4\ub2c8\uc998\uc744 \uc870\ud569\ud558\uc5ec long-context \ub97c \ucc98\ub9ac\ud558\uba70, complexity \ub97c ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"O"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"O(n)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"O"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))," \uc73c\ub85c \uc904\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Reformer \ub294 locality-sensitive hashing (LSH)\uc744 \ub3c4\uc785\ud558\uc5ec similar token \uc744 same buckets \ub85c hashing \ud558\uc5ec attention \uc744 \uadfc\uc0ac\ud654\ud558\uace0, computational complexity \ub97c \uc904\uc778\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"LSG Attention \uc740 local, sparse, global attention \uc744 \uacb0\ud569\ud558\uc5ec long-context \ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \ucc98\ub9ac\ud558\uba70 computational overhead \ub97c minimizing \ud55c\ub2e4.")),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c \ubc1c\uc804\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0, \uc2e4\uc81c \uc751\uc6a9 \ud504\ub85c\uadf8\ub7a8\uc5d0\uc11c long-context \uc0c1\ud638\uc791\uc6a9\uc744 \uad00\ub9ac\ud558\ub294 \uac83\uc740 \uc5ec\uc804\ud788 \ud070 \ub3c4\uc804 \uacfc\uc81c\uc774\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\ucd5c\uadfc LongLoRA \uac00 Position Interpolation \uc744 \uc0ac\uc6a9\ud558\uc5ec LLaMA2\uc758 context window \ub97c 4096 to 32768 tokens \ub85c \ud655\uc7a5\ud558\uc600\uc9c0\ub9cc, GPU \ub098 TPU \uc790\uc6d0\uc744 \ub9ce\uc774 \uc18c\ubaa8\ud558\uc9c0 \uc54a\uc558\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\uadf8\ub7ec\ub098 LongLoRA \uc758 \ud6a8\uc728\uc131\uc740 \uc81c\ud55c\uc801\uc774\uba70, full attention \uc5d0 \ube44\ud574 \uc624\uc9c1 39% \uc758 perplexity \uac1c\uc120\ub9cc\uc744 \ub2ec\uc131\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 attention head \uad6c\uc870\uc758 \ud63c\ub780\uacfc token groups \uac04\uc758 \ubd88\ud544\uc694\ud55c information exchange \ub54c\ubb38\uc774\ub2e4.")),(0,s.kt)("p",null,"\uc774\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574, \uc800\uc790\ub294 \ub354 \ub098\uc740 work partitioning \uc744 \uc81c\uacf5\ud558\ub294 SinkLoRA \ub97c \uc81c\uc548\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},'SF-Attn \uc744 \uac1c\ubc1c\ud558\uc5ec a segmentation and reassembly algorithm \uacfc "sink attention tokens" \uc758 global attention \ub97c \uacb0\ud569\ud558\uc5ec full attention \uc5d0 \ube44\ud574 92% \uc758 perplexity \uac1c\uc120\uc744 \ub2ec\uc131\ud55c\ub2e4'),(0,s.kt)("li",{parentName:"ul"},"inference \uac00\uc18d\ud654\ub97c \uc704\ud574 \ucd5c\uc2e0 KV cache compression algorithm \uc778 Heavy Hitter Oracle(H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O)\uc744 \uc801\uc6a9\ud558\uc600\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 \ub610\ud55c self-collected LongAlpacaPlus dataset \uc744 \uc0ac\uc6a9\ud558\uc5ec SinkLoRA \ub97c supervied fine-tuning \ud558\uc600\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774 dataset \uc740 Natural Questions, RedPajama, Book Summarization, LongQA \ub4f1 \ub2e4\uc591\ud55c \ucd9c\ucc98\uc5d0\uc11c 28,000 entries \ub97c \ud3ec\ud568\ud558\uba70, long instruction tuning \uc744 \uc704\ud55c \ub2e4\uc591\ud55c \uc885\ud569\uc801\uc778 \uceec\ub809\uc158\uc744 \ubcf4\uc7a5\ud55c\ub2e4.")))),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 1",src:t(19016).Z,width:"2495",height:"1561"})),(0,s.kt)("p",null,"\uc694\uc57d\ud558\uba74, \uc800\uc790\uc758 \uc5f0\uad6c \uae30\uc5ec\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"SinkLoRA \ub97c \uc81c\uc2dc\ud558\uba70, \uc774\ub294 LLaMA2 \ubc0f LLaMA3 \uc758 context length \ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ud655\uc7a5\ud558\ub294 \ubc29\ubc95\uc73c\ub85c, LongLoRA \ub97c \uc644\uc804\ud788 \uc5c5\ub370\uc774\ud2b8\ud558\uc600\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\ubc95\uc740 fine-tuning \ud6a8\uc728\uc131\uc744 \uac1c\uc120\ud558\uace0 flexible deployment inference \uc804\ub7b5\uc744 \uc81c\uacf5\ud55c\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},"SF-Attn \uc744 \ub3c4\uc785\ud558\uba70, \uc774\ub294 a segmentation and reassembly algorithm \uacfc global attention \ub97c \uacb0\ud569\ud55c fine-tuning \ubc29\ubc95\uc774\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\ubc95\uc740 \uad6c\ud604\uc774 \uc27d\uace0 \uc815\ud655\ud558\uba70 \uba54\ubaa8\ub9ac \ud6a8\uc728\uc801\uc774\uba70, computational complexity \ub97c \uc99d\uac00\uc2dc\ud0a4\uc9c0 \uc54a\ub294\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"SF-Attn \uc740 attention pattern \uc744 \uc9c1\uc811 \uc218\uc815\ud558\uc5ec token groups \uac04\uc758 \ubd88\ud544\uc694\ud55c \uac15\uc870\ub97c \uc904\uc778\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},"Heavy Hitter Oracle (H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O) KV caching \ubc29\ubc95\uc744 \uc0ac\uc6a9\ud558\uc5ec computationally intensive large language models (LLMs)\uc758 efficient deployment \ub97c \ub2ec\uc131\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\ubc95\uc740 \uc774\uc804\uc5d0 \uc0dd\uc131\ub41c token \uc758 key-value state \ub97c \uc800\uc7a5\ud558\uc5ec \ubc18\ubcf5\uc801\uc778 \uacc4\uc0b0\uc758 \ud544\uc694\uc131\uc744 \ud06c\uac8c \uc904\uc778\ub2e4"),(0,s.kt)("li",{parentName:"ul"},"autoregressive generation \uc758 latency \ub97c \ub0ae\ucd98\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uac1c\uc120\uc740 \uc720\uc5f0\ud558\uace0 efficient inference \uc804\ub7b5\uc744 \uac00\ub2a5\ud558\uac8c \ud558\uba70, computational overhead \ub97c \uc904\uc774\uba74\uc11c \ubaa8\ub378 \uc131\ub2a5\uc744 \uc720\uc9c0\ud55c\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},"SinkLoRA \ub294 SOTA \uc640 \ube44\uad50\ud558\uc5ec \uc720\ub9ac\ud55c \uc131\ub2a5\uc744 \ubcf4\uc778\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 PG19, Proof-pile, LongBench dataset \uc5d0\uc11c \uc131\ub2a5\uc744 \ud3c9\uac00\ud558\uc600\uc73c\uba70, \ud2b9\ud788 LLaMA2 7B \uc758 \uacbd\uc6b0, SinkLoRA \ub294 LongLoRA \ub97c \ucd08\uacfc\ud558\uba70 LongChat-13B \uc640 \uacbd\uc7c1\ub825 \uc788\ub294 \uc131\ub2a5\uc744 \ubcf4\uc778\ub2e4.")))),(0,s.kt)("h1",{id:"11-motivation-for-the-research"},"1.1 Motivation for the Research"),(0,s.kt)("h4",{id:"motivation-1-elevating-attention-scores-for-initial-tokens-prior-studies-have-demonstrated-the-attention-sink-phenomeno"},"Motivation 1: Elevating Attention Scores for Initial Tokens Prior studies have demonstrated the Attention Sink phenomeno"),(0,s.kt)("p",null,"\uc774\uc804 \uc5f0\uad6c\uc5d0\uc11c\ub294 Attention Sink \ud604\uc0c1\uc774 \ub098\ud0c0\ub09c\ub2e4\uace0 \ubcf4\uc5ec\uc900\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774 \ud604\uc0c1\uc5d0\uc11c\ub294 \uc8fc\ub85c sequence \uc758 initial tokens \uac00 \ubaa8\ub378\uc758 \uacc4\uc0b0 \uacfc\uc815\uc5d0\uc11c \ube44\ub840\uc801\uc73c\ub85c high attention scores \ub97c \ubc1b\ub294\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 \uc774\ub7ec\ud55c tokens \ub294 \uc774\ud6c4 all tokens \uc5d0 \ub300\ud574 \ubcf4\uc774\uae30 \ub54c\ubb38\uc5d0 \ubc1c\uc0dd\ud558\uba70, \uc774\ub85c \uc778\ud574 semantic importance \uac00 \ubd80\uc871\ud558\ub354\ub77c\ub3c4 \uc0c1\ub2f9\ud55c attention \uc744 \ubc1b\ub294\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\ud2b9\ud788 autoregressive language model \uc5d0\uc11c \uc774\ub7f0 \ud604\uc0c1\uc774 \ub450\ub4dc\ub7ec\uc9c4\ub2e4.")),(0,s.kt)("p",null,"LongLoRA \uc5d0\uc11c \uad6c\ud604\ub41c Sparse Shifted Attention \uba54\ucee4\ub2c8\uc998\uc740 \uc774\ub7ec\ud55c initial tokens \uc758 high attention scores \ub97c \uc774\uc804\uc5d0 low attention \uc744 \ubc1b\uc558\ub358 other tokens \ub85c shifting \ud558\uc5ec initial tokens \uc5d0 \ub300\ud55c \uacfc\ub3c4\ud55c \uac15\uc870\ub97c \uc904\uc774\ub824\uace0 \uc2dc\ub3c4\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub97c \ub354 \uac1c\uc120\ud558\uae30 \uc704\ud574, \uc800\uc790\ub294 attention pattern \uc744 \uc9c1\uc811 \uc218\uc815\ud558\ub294 \ubc29\ubc95\uc744 \uac1c\ubc1c\ud560 \ud544\uc694\uac00 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uc774 \uae30\uc220\uc744 \uc801\uc6a9\ud558\uba74 attention scores \ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc7ac\ubd84\ubc30\ud560 \uc218 \uc788\uc73c\uba70, \ub2e4\uc591\ud55c token groups \uac04\uc5d0 initial tokens \uc5d0 \ub300\ud55c \ubd88\ud544\uc694\ud55c \uac15\uc870\ub97c \uc904\uc77c \uc218 \uc788\ub2e4."),(0,s.kt)("h4",{id:"motivation-2-maintaining-initial-tokens-during-fine-tuning"},"Motivation 2: Maintaining Initial Tokens During Fine-Tuning"),(0,s.kt)("p",null,"attention sinks \uac1c\ub150\uc740 Streaming LLM \uc5d0\uc11c\ub3c4 \uc0ac\uc6a9\ub418\uc5b4 \ubaa8\ub378\uc758 long text \ucc98\ub9ac \ub2a5\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\ub294\ub370 \uae30\uc5ec\ud55c\ub2e4. "),(0,s.kt)("p",null,"few initial tokens (attention sinks) \uc640 \uac00\uc7a5 \ucd5c\uadfc tokens \uc758 Key-Value (KV) pairs \ub97c \uc720\uc9c0\ud568\uc73c\ub85c\uc368 model \uc740 extended sequence \uc5d0\uc11c\ub3c4 \uc548\uc815\uc801\uc778 attention scores \uc640 \uc131\ub2a5\uc744 \ubcf4\uc7a5\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c \uc811\uadfc \ubc29\uc2dd\uc744 fine-tuning \uc5d0\uc11c inference \ub2e8\uacc4\ub85c \uac00\uc838\uc624\ub294 \uac83\uc744 \ubaa9\ud45c\ub85c \ud558\uace0 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uc800\uc790\uc758 \uc5f0\uad6c\ub294 fine-tuning \uacfc\uc815\uc5d0\uc11c initial tokens \uac00 other all tokens \uc5d0 attending \ud558\uc5ec \ub354 \ub9ce\uc740 attention scores \ub97c \ucd95\uc801\ud558\uace0, \ubaa8\ub378\uc758 long sequence \ucc98\ub9ac \ub2a5\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\ub3c4\ub85d \uc218\uc815\ud558\ub824 \ud55c\ub2e4."),(0,s.kt)("h4",{id:"motivation-3-flexible-deployment-of-inference-strategy"},"Motivation 3: Flexible Deployment of Inference Strategy"),(0,s.kt)("p",null,"computationally intensive large language models (LLMs)\uc758 efficient deployment \ub294 \uc885\uc885 Key-Value (KV) caching \uc5d0 \uc758\uc874\ud55c\ub2e4. "),(0,s.kt)("p",null,"KV caching \uc740 \uc774\uc804\uc5d0 \uc0dd\uc131\ub41c tokens \uc758 key-value state \ub97c \uc800\uc7a5\ud558\uc5ec repetitive computations \ub97c \ud06c\uac8c \uc904\uc774\uace0, \ub530\ub77c\uc11c autoregressive generation \uc758 latency \ub97c \ub0ae\ucd98\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 LongLoRA \ub294 inference \ub3d9\uc548 original standard self-attention \uba54\ucee4\ub2c8\uc998\ub9cc\uc744 \uc720\uc9c0\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774 \ud55c\uacc4\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574, optional KV cache \uae30\ub2a5\uc744 \uc801\uc6a9\ud560 \ud544\uc694\uac00 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uc774 \uac1c\uc120\uc740 \ub354 \uc720\uc5f0\ud558\uace0 efficient inference \uc804\ub7b5\uc744 \uac00\ub2a5\ud558\uac8c \ud558\uba70, \ubaa8\ub378 \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uba74\uc11c computational overhead \ub97c \uc904\uc778\ub2e4."),(0,s.kt)("h1",{id:"2-related-work"},"2 Related Work"),(0,s.kt)("h2",{id:"21-long-context-transformers"},"2.1 Long-context Transformers"),(0,s.kt)("p",null,"Transformer model \uc744 \ud655\uc7a5\ud558\uc5ec longer sequence length \ub97c \ucc98\ub9ac\ud558\ub294 \ub370 \uc788\uc5b4 \uc8fc\uc694 \uc7a5\uc560\ubb3c\uc740 self-attention \uba54\ucee4\ub2c8\uc998\uc774\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 sequence length \uc5d0 \ub300\ud574 \uc81c\uacf1\uc801\uc73c\ub85c \uc99d\uac00\ud558\uc5ec computation time \uacfc memory requirements \uc774 \ud06c\uac8c \ub298\uc5b4\ub09c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc81c\uacf1 \uacc4\uc0b0 \ubd80\ub2f4\uc744 \ud574\uacb0\ud558\uae30 \uc704\ud574 more efficient sparse Transformer model \uac1c\ubc1c\uc5d0 \ub300\ud55c \uc5f0\uad6c\uac00 \uc9c4\ud589\ub418\uc5c8\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Longformer \uc640 BigBird \ub294 local, global, sparse attention \uba54\ucee4\ub2c8\uc998\uc744 \uc870\ud569\ud558\uc5ec long-context \ub97c \uad00\ub9ac\ud558\uace0 complexity \ub97c ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"O"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"O(n)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"O"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))," \uc73c\ub85c \uc904\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c \ubaa8\ub378\ub4e4\uc740 \ucda9\ubd84\ud55c context \ub97c \uc720\uc9c0\ud558\uba74\uc11c\ub3c4 \uacc4\uc0b0 \ubd80\ud558\ub97c \uad00\ub9ac\ud558\ub294 \uade0\ud615\uc744 \uc774\ub8e8\uc5c8\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"O"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mi",{parentName:"mrow"},"log"),(0,s.kt)("mo",{parentName:"mrow"},"\u2061"),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"O(n \\log n)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"O"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mop"},"lo",(0,s.kt)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))," complexity \ub97c \ub2ec\uc131\ud558\uae30 \uc704\ud574 \uba87 \uac00\uc9c0 \uc811\uadfc \ubc29\uc2dd\uc774 \uc81c\uc548\ub418\uc5c8\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"Fixed Window Attention \uc740 fixed-size window \ub97c \uc0ac\uc6a9\ud558\uc5ec attention computation \uc744 limited context window \uc73c\ub85c \uc81c\ud55c\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Reformer \ub294 similar tokens \ub97c same buckets \ub85c hashing \ud558\ub294 locality-sensitive hashing (LSH)\uc744 \ub3c4\uc785\ud558\uc5ec attention \uc744 \uadfc\uc0ac\ud654\ud558\uace0 computational complexity \ub97c \uc904\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"LSG Attention \uc740 BigBird \uc5d0\uc11c \uc801\uc751\ub418\uc5b4 local, sparse, global attention \uc744 \uacb0\ud569\ud558\uc5ec long-context \ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \ucc98\ub9ac\ud558\uace0 computational overhead \ub97c \ucd5c\uc18c\ud654\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Equipping Transformer \uc740 documents \uc758 all tokens \uc744 \uac80\ud1a0\ud560 \ud544\uc694 \uc5c6\uc774 long document \ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ucc98\ub9ac\ud560 \uc218 \uc788\ub294 random access \ub77c\ub294 novel reading \uc804\ub7b5\uc744 \uc81c\uc548\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\ubc95\uc740 pre-training, fine-tuning \ubc0f inference \ub2e8\uacc4\uc5d0\uc11c \uc720\ub9dd\ud55c \uacb0\uacfc\ub97c \ubcf4\uc774\uba70, extended context \ub97c \ucc98\ub9ac\ud558\ub294 \ub370 \ud6a8\uacfc\uc801\uc784\uc744 \ubcf4\uc5ec\uc900\ub2e4. ")))))),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c \ubc1c\uc804\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0, \uc774\ub7ec\ud55c \ubc29\ubc95\ub4e4\uc774 chat applications \uc5d0\uc11c \uc694\uad6c\ub418\ub294 long-context \uc0c1\ud638\uc791\uc6a9\uc744 \uad00\ub9ac\ud558\ub294 \ub2a5\ub825\uc5d0\ub294 \uc5ec\uc804\ud788 \ud55c\uacc4\uac00 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub294 \uc0c1\ud638\uc791\uc6a9\uc801\uc774\uace0 real-time applications \uc744 \uc704\ud55c Transformer model \uc758 context \ucc98\ub9ac \ub2a5\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\ub294 \ub370 \uc788\uc5b4 \uc9c0\uc18d\uc801\uc778 \ub3c4\uc804 \uacfc\uc81c\ub97c \uac15\uc870\ud55c\ub2e4."),(0,s.kt)("h2",{id:"22-long-context-llms"},"2.2 Long-context LLMs"),(0,s.kt)("p",null,"large language model(LLMs)\uc758 \ucd5c\uadfc \ubc1c\uc804\uc740 long-context input \uc744 \ucc98\ub9ac\ud558\ub294 \ub2a5\ub825\uc744 \ud06c\uac8c \ud655\uc7a5\ud558\uc600\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Math Word Problems (MWPs) \ub294 LLMs \ub97c \uc0ac\uc6a9\ud558\uc5ec mathematical questions \ub97c \ud574\uacb0\ud558\ub294 \ub370\uc5d0\uc11c \ub450\ub4dc\ub7ec\uc9c4 \uc131\ub2a5\uc744 \ubcf4\uc5ec\uc8fc\uc5c8\ub2e4.",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, SQL query \uc5d0\uc11c LLMs \ub97c \ud65c\uc6a9\ud558\ub294 \uac83\ub3c4 resource allocation \uc744 \ucd5c\uc801\ud654\ud558\ub294 \ub370 \uc720\ub9dd\ud558\ub098, traditional relational databases \uc5d0 \ube44\ud574 \ud6a8\uc728\uc131\uc740 \ub5a8\uc5b4\uc9c4\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 Position Interpolation \uc744 \uc0ac\uc6a9\ud558\uc5ec Llama 2 \uc758 context window \ub97c 4096 to 32768 token \uc73c\ub85c \ud655\uc7a5\ud558\ub294 \ub370 \uc131\uacf5\ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Meta \uc758 Llama 3\uc740 \ucd5c\ub300 70 billions parameter \ub97c \uac00\uc9c0\uba70, computational efficiency, trust \ubc0f safety tools, \uc8fc\uc694 \ud50c\ub7ab\ud3fc\uacfc\uc758 \ud611\uc5c5\uc5d0\uc11c \uac1c\uc120\uc744 \uc81c\uacf5\ud558\ub294 open-source LLM \uc758 \uc911\uc694\ud55c \ubc1c\uc804\uc744 \ub098\ud0c0\ub0b8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"BLOOM, OPT, Falcon \uac19\uc740 open-source models \uc740 \uc5ec\uc804\ud788 closed-source model \uacfc \uacbd\uc7c1\ud558\uace0 \uc788\uc73c\uba70, Vicuna \ubc0f Alpaca \uac19\uc740 \ubaa8\ub378\uc740 \ud2b9\uc815 \uce21\uba74\uc5d0\uc11c closed-source model \uc5d0 \ube44\ud574 \ub4a4\ucc98\uc9c4\ub2e4. ")),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c \ubc1c\uc804\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0, long-context \uc0c1\ud638\uc791\uc6a9\uc744 \ud6a8\uacfc\uc801\uc73c\ub85c \uad00\ub9ac\ud558\ub294 \uac83\uc740 \uc5ec\uc804\ud788 \uc911\uc694\ud55c \ub3c4\uc804 \uacfc\uc81c\uc774\uba70, long-context LLM \uc751\uc6a9 \ud504\ub85c\uadf8\ub7a8\uc758 complexity \ub97c \ud574\uacb0\ud558\uae30 \uc704\ud55c \uc9c0\uc18d\uc801\uc778 \uc5f0\uad6c\uc640 \uac1c\ubc1c\uc774 \ud544\uc694\ud558\ub2e4."),(0,s.kt)("h2",{id:"23-kv-cache-compression"},"2.3 KV-Cache Compression"),(0,s.kt)("p",null,"KV cache size \uc758 compressing \uc740  weight size \ub97c \uc904\uc774\ub294 \uac83\ubcf4\ub2e4 \uc5b4\ub835\ub2e4. \uc65c\ub0d0\ud558\uba74 KV \ub294 model input \uc5d0 \ub354 \ubbfc\uac10\ud558\uace0 \uc758\uc874\uc801\uc774\uae30 \ub54c\ubb38\uc774\ub2e4. "),(0,s.kt)("p",null,"KV cache compression \uc744 \uc704\ud55c cost-effective method \ub294 token dropping \uc774\ub2e4. "),(0,s.kt)("p",null,"\uc774 \ubc29\ubc95\uc740 \uc911\uc694\ub3c4 \uc815\ucc45\uc744 \uc124\uc815\ud558\uc5ec \uc911\uc694\ud55c KV \ub97c \uc720\uc9c0\ud558\uace0 \uc911\uc694\ud558\uc9c0 \uc54a\uc740 \uac83\uc744 \uc81c\uac70\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Jiang et al. \uacfc Xiao et al. \ub294 current sequence position \uc5d0 \uadfc\uc811\ud55c tokens \ub97c \uc720\uc9c0\ud558\ub294 \uac83\uc774 \uc0dd\uc131\uc5d0 \uc911\uc694\ud558\ub2e4\uace0 \uc81c\uc548\ud558\uc600\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc608\ub97c \ub4e4\uc5b4, H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \uc640 FastGen \uc740 attention scores \ub97c \uae30\uc900\uc73c\ub85c tokens \ub97c dropping \ud558\uc5ec KV cache \ud06c\uae30\ub97c \uc904\uc774\ub294 \ubc29\ubc95\uc744 \uc81c\uc548\ud558\uc600\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\ube44\uc2b7\ud558\uac8c, SparQ \ub294 attention scores sparsity \ub97c \uae30\uc900\uc73c\ub85c tokens \ub97c dopping \ud558\uba70, pruned value cache \uc5d0\uc11c\uc758 error \ub97c \uace0\ub824\ud558\uae30\ub3c4 \ud55c\ub2e4.")),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c pruning methods \ub294 summarization tasks \ubc0f zero-shot inference \uc5d0\uc11c \uc77c\ubc18\uc801\uc73c\ub85c \ud6a8\uacfc\uc801\uc774\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Zhang et al. \uacfc Liu et al. \ub294 \uc0dd\uc131 \ud488\uc9c8\uc744 \uc720\uc9c0\ud558\uae30 \uc704\ud574 \uc601\ud5a5\ub825 \uc788\ub294 \uc18c\uc218\uc758 tokens, \uc989 heavy-hitters \ub97c \uc2dd\ubcc4\ud558\ub294 \uac83\uc744 \uad8c\uc7a5\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Ge et al. \uc740 \uc11c\ub85c \ub2e4\ub978 attention head \uac00 \uc11c\ub85c \ub2e4\ub978 tokens \uc5d0 \uc6b0\uc120 \uc21c\uc704\ub97c \ub450\uba70, KV \ub97c \uc81c\uac70\ud558\uae30 \uc704\ud55c  adaptive importance policy \ub97c \uac1c\ubc1c\ud558\uc600\ub2e4.")),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 \uc774\ub7ec\ud55c \uc811\uadfc \ubc29\uc2dd\uc740 pruned KV \uc5d0 \ud3ec\ud568\ub41c context \uac00 \uc644\uc804\ud788 \ud3d0\uae30\ub418\uae30 \ub54c\ubb38\uc5d0 \uc2ec\uac01\ud55c \ubb38\uc81c\ub97c \uc77c\uc73c\ud0ac \uc218 \uc788\ub2e4."),(0,s.kt)("h1",{id:"3-our-method-sinklora"},"3 Our Method: SinkLoRA"),(0,s.kt)("h2",{id:"31-background"},"3.1 Background"),(0,s.kt)("h4",{id:"longlora"},"LongLoRA."),(0,s.kt)("p",null,"LongLoRA \ub294 Chen et al. (2023) \uc758 fine-tuning \ubc29\ubc95\ub860\uc73c\ub85c, large language model(LLM)\uc758 context window size \ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ud655\uc7a5\ud558\ub294 \uac83\uc744 \ubaa9\ud45c\ub85c \ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"LongLoRA \ub294 Position Interpolation \uc744 \ud65c\uc6a9\ud558\uc5ec LoRA \uc5d0\uc11c \ub3c4\uc785\ub41c low-rank adaptation \uc744 \uae30\ubc18\uc73c\ub85c \ud558\uba70, Shifted Sparse Attention (S2-Attn) \uc744 \ud1b5\ud569\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"S2-Attn \uc740 Swin Transformer \uc5d0\uc11c \uc601\uac10\uc744 \ubc1b\uc544, total context \ub97c multiple groups \ub85c \ub098\ub204\uace0 \uac01 group \ub0b4\uc5d0\uc11c independently attention computation \uc744 \uc218\ud589\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"continuity \ub97c \ubcf4\uc7a5\ud558\uae30 \uc704\ud574, half attention head \uc744 half group size \ub9cc\ud07c shifting \ud55c\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\ubc95\uc740 training \uc911 short attention spans \ub97c \uc0ac\uc6a9\ud558\uc5ec long-context task \uc744 \uc2dc\ubbac\ub808\uc774\uc158\ud558\ubbc0\ub85c, computational overhead \ub97c \ud06c\uac8c \uc99d\uac00\uc2dc\ud0a4\uc9c0 \uc54a\uace0\ub3c4 larger contexts \ub97c \ucc98\ub9ac\ud560 \uc218 \uc788\uac8c \ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c LongLoRA \ub294 Flash-Attention2 \uac19\uc740 \uae30\uc874 LLM optimization \uae30\uc220 \ubc0f \uc778\ud504\ub77c\uc640 \ud638\ud658\ub418\ub3c4\ub85d \uc124\uacc4\ub418\uc5b4 \uc2dc\uc2a4\ud15c \uc218\uc815 \uc5c6\uc774\ub3c4 \uc720\uc6a9\ud558\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc811\uadfc \ubc29\uc2dd\uc740 parameter \ud65c\uc6a9\uc758 \ud6a8\uc728\uc131\uc744 \uac15\uc870\ud558\uc5ec, \uc804\uccb4 model parameters \uc758 \uc791\uc740 \ubd80\ubd84\uc744 \ucc28\uc9c0\ud558\ub294 learnable embedding \ubc0f normalization layers \uc5d0 \ucd5c\uc18c\ud55c\uc758 \uc870\uc815\ub9cc \ud544\uc694\ud558\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c \ud6a8\uc728\uc131\uc740 larger models \ub85c \ud655\uc7a5\ud558\uba74\uc11c\ub3c4 LongLoRA \uc758 \uc2e4\uc81c\uc801\uc778 \uc131\ub2a5 \ud5a5\uc0c1\uc744 \uc720\uc9c0\ud558\ub294 \ub370 \uc911\uc694\ud558\ub2e4.")))),(0,s.kt)("h4",{id:"attention-sink"},"Attention Sink."),(0,s.kt)("p",null,'autoregressive large language model (LLM)\uc5d0\uc11c\ub294 initial tokens \uac00 task \uc640 semantic relevanmce \uac00 \uc5c6\uc774 \ubd88\uade0\ud615\uc801\uc778 high attention scores \ub97c \ubc1b\ub294 "attention sink" \ud604\uc0c1\uc774 \uad00\ucc30\ub41c\ub2e4. '),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c initial tokens \uc740 semantic importance \ub294 \ubd80\uc871\ud558\uc9c0\ub9cc high attention scores \ub97c \uac00\uc18d\ud654\ud558\ub294 \uacbd\ud5a5\uc774 \uc788\ub2e4"),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ud604\uc0c1\uc740 \ubaa8\ub378\uc758 Softmax function \uc758 \ud2b9\uc131\uc73c\ub85c \uc778\ud574 all tokens \uc758 attention score \ud569\uc774 1\uc774 \ub418\ub3c4\ub85d \ubcf4\uc7a5\ud558\ub294 attention ap \ucee4\ub2c8\uc998\uc774 \uc0ac\uc6a9\ub418\uae30 \ub54c\ubb38\uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"current query \uc640 \uac15\ud558\uac8c \uad00\ub828\ub41c tokens \uac00 \uba87 \uac1c\ubc16\uc5d0 \uc5c6\ub294 \uacbd\uc6b0 model \uc740 availabe tokens \uc5d0 attention \uc744 \ubd84\uc0b0\uc2dc\ud0a4\ub294 \uacbd\ud5a5\uc774 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},'LLM \uc758 autoregressive \ud2b9\uc131 \ub54c\ubb38\uc5d0 initial tokens \uc740 \uac70\uc758 \ubaa8\ub4e0 subsequent tokens \uc5d0 \ud56d\uc0c1 \ubcf4\uc774\ubbc0\ub85c, training \uc911 \uc790\uc5f0\uc2a4\ub7fd\uac8c target attention \uc73c\ub85c \uc120\ud638\ub418\uba70 "attention sinks" \uc5ed\ud560\uc744 \ud55c\ub2e4. ')),(0,s.kt)("p",null,"\uc774 \ud1b5\ucc30\ub825\uc740 autoregressive models \uc758 attention \uba54\ucee4\ub2c8\uc998\uc5d0\uc11c \uadfc\ubcf8\uc801\uc778 \uc5b4\ub824\uc6c0\uc744 \uac15\uc870\ud558\uba70, language modeling \uc5d0\uc11c attention distribution \uc804\ub7b5\uc744 \uac1c\uc120\ud560 \uc218 \uc788\ub294 \uc601\uc5ed\uc744 \uc81c\uc2dc\ud55c\ub2e4."),(0,s.kt)("h4",{id:"heavy-hitter-oracle"},"Heavy-Hitter Oracle."),(0,s.kt)("p",null,"Heavy-Hitter Oracle (H",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O) \uc740 language model \uc758 KV cache memory size \ub97c \uc904\uc774\ub294 \ubb38\uc81c\ub97c \ud574\uacb0\ud558\ub294 \ucd5c\uc2e0 \uae30\uc220\uc774\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\ubc95\uc740 \u201cHeavy Hitters\u201d (H2) \ub77c\ub294 small tokens subset \uc774 language model \uc758 \uc804\uccb4 attention scores \uc5d0 \uc0c1\ub2f9\ud55c \uae30\uc5ec\ub97c \ud55c\ub2e4\ub294 \uad00\ucc30\uc744 \uae30\ubc18\uc73c\ub85c \ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ubd84\uc11d \uacb0\uacfc, \uc774\ub7ec\ud55c H2 tokens \ub294 text \ub0b4\uc5d0\uc11c \uc790\uc8fc \uacf5\uc874\ud558\uba70, text structure \uc758 \uc790\uc5f0\uc2a4\ub7ec\uc6b4 \uacb0\uacfc\ub85c \ub098\ud0c0\ub09c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc2e4\ud5d8\uc5d0\uc11c\ub294 \uc774\ub7ec\ud55c tokens \ub97c \uc81c\uac70\ud558\uba74 \ubaa8\ub378 \uc131\ub2a5\uc5d0 \uc0c1\ub2f9\ud55c \uc601\ud5a5\uc744 \ubbf8\uce5c\ub2e4\ub294 \uc810\uc774 \uac15\uc870\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \uc811\uadfc\ubc95\uc740 \uc774 \uc774\ud574\ub97c dynamic cache eviction policy \ub97c \uacb0\ud569\ud558\uc5ec current tokens \uc640 \uc911\uc694\ud55c H2 tokens \uc758 \ubcf4\uc720\ub97c \ucd5c\uc801\ud654\ud558\uba70, efficient memory \uc0ac\uc6a9\uc744 \ubcf4\uc7a5\ud558\uace0 \ubaa8\ub378 \uc131\ub2a5\uc5d0 \ud544\uc694\ud55c \uacc4\uc0b0 \uc5ed\ud559\uc744 \uc720\uc9c0\ud55c\ub2e4.")),(0,s.kt)("h2",{id:"32-applying-sink-fixed-attention-to-improve-fine-tune-progress"},"3.2 Applying Sink Fixed Attention to Improve Fine Tune Progress"),(0,s.kt)("h3",{id:"321-pilot-study"},"3.2.1 Pilot study"),(0,s.kt)("p",null,"\uc800\uc790\uc758 \uc811\uadfc \ubc29\uc2dd\uc744 \ud655\uc778\ud558\uae30 \uc704\ud574, \ub2e4\uc591\ud55c context length \uc5d0\uc11c \uc5ec\ub7ec attention \uba54\ucee4\ub2c8\uc998\uc758 \ud6a8\uacfc\ub97c \ud3c9\uac00\ud558\ub294 pilot study \ub97c \uc218\ud589\ud55c\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 1",src:t(99027).Z,width:"2962",height:"1118"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Tab. 1 \uc5d0\uc120 full attention \ubc0f fine-tuning \uacfc \ud568\uaed8 training \ubc0f test \ub97c \uc218\ud589\ud558\uc5ec standard baseline \uc744 \uc124\uc815\ud558\uba70, \uc774\ub294 \ub2e4\uc591\ud55c context length \uc5d0\uc11c \uc77c\uad00\ub418\uac8c \uc88b\uc740 \ud488\uc9c8\uc744 \uc81c\uacf5\ud55c\ub2e4. ")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 2",src:t(82361).Z,width:"2596",height:"1350"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uba3c\uc800 short attention (Sparse Shifted Attention)\ub97c \uc0ac\uc6a9\ud558\uc5ec training \uc744 \uc9c4\ud589\ud588\uc73c\uba70, \uc774 pattern \uc740 Fig. 2(a) \uc5d0 \ub098\ud0c0\ub098 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"long-context \uc5d0 \ub300\ud55c self-attention module \uc758 \ub192\uc740 computational costs \uc744 \uace0\ub824\ud558\uc5ec, group window attention \uc5d0 Sink Fixed Attention (SF-Attn) \uc7ac\uc870\ub9bd\uc744 \ub3c4\uc785\ud588\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ub2e8\uacc4\ub294 Fig. 2(b) \uc5d0 \ub098\ud0c0\ub098 \uc788\uc73c\uba70, attention pattern \uc744 \uc7ac\uc870\ub9bd\ud558\uc5ec token \uac04\uc758 continuity \uc640 interaction \uc744 \uac1c\uc120\ud55c\ub2e4 (Fig. 2(c)). "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ubc29\ubc95\uc740 initial tokens \uac00 all tokens \uc5d0 attending \ud558\uac8c \ud558\uc5ec global attention \uc744 \uc81c\uacf5\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uacb0\uacfc\uc801\uc73c\ub85c, SF-Attn \uc740 Sparse Shifted Attention \uc5d0 \ube44\ud574 \uc0c1\ub2f9\ud55c \uac1c\uc120\uc744 \ubcf4\uc5ec\uc8fc\uba70, \ud2b9\ud788 8192 tokens \uc5d0\uc11c perplexity \ub97c \ud604\uc800\ud788 \uc904\uc600\ub2e4.")),(0,s.kt)("p",null,"\uc774 pilot study \uc758 \uacb0\uacfc\ub294 SF-Attn \uc774 \uc7ac\uc870\ub9bd \ubc0f global attention \uc870\uc815\uc744 \ud1b5\ud574 \uc131\ub2a5\uacfc computational efficiency \uc758 \uade0\ud615\uc744 \ud6a8\uacfc\uc801\uc73c\ub85c \ub9de\ucd98\ub2e4\ub294 \uac83\uc744 \ub098\ud0c0\ub0b8\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub294 large language model \uc758 context length \ub97c \ud655\uc7a5\ud558\ub294 \ub370 \uc720\ub9dd\ud55c \ud574\uacb0\ucc45\uc774 \ub41c\ub2e4."),(0,s.kt)("h3",{id:"322-sink-fixed-attention"},"3.2.2 Sink Fixed Attention"),(0,s.kt)("p",null,"Sink Fixed Attention \uc740 \ub450 \uac00\uc9c0 \uc8fc\uc694 \ubd80\ubd84\uc73c\ub85c \uad6c\uc131\ub41c\ub2e4: Segmentation & Reassembly Algorithm \uacfc Global Attention \uc774\ub2e4."),(0,s.kt)("h4",{id:"segmentation--reassembly-algorithm"},"Segmentation & Reassembly Algorithm."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 4",src:t(66625).Z,width:"3735",height:"1756"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Fig. 4 \ucc98\ub7fc, input tensor \ub294 two parts \ub85c \ub098\ub25c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"second half \ub294 \ub2e4\uc2dc two parts \ub85c \ub098\ub25c\ub2e4: \ud558\ub098\ub294 \uc81c\uc790\ub9ac\uc5d0 \ub0a8\uc544\uc788\uace0 \ub2e4\ub978 \ud558\ub098\ub294 shifting \ud558\uc5ec \uac10\uc2f8\uc9c4\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c parts \ub294 \uc0c8\ub85c\uc6b4 \uc21c\uc11c\ub85c \ub2e4\uc2dc \uacb0\ud569\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc7ac\uc870\ub9bd\ub41c tensor \ub294 standard self-attention \uba54\ucee4\ub2c8\uc998\uc744 \ud1b5\ud574 \ucc98\ub9ac\ub41c\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\ucd5c\uc885\uc801\uc73c\ub85c output tensor \ub294 similar splitting, shifting, \ubc0f recombining process \ub97c \uac70\uccd0 feed forward operation \uc744 \uc218\ud589\ud558\uc5ec final output \uc744 \uc0dd\uc131\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc811\uadfc \ubc29\uc2dd\uc740 attention computation \uc744 \ub2e8\uc21c\ud654\ud558\uace0 \uc785\ub825\uc758 \ud575\uc2ec \uc601\uc5ed\uc5d0 \uc9d1\uc911\ud568\uc73c\ub85c\uc368 \ubaa8\ub378 \uc131\ub2a5\uc744 \ud5a5\uc0c1\uc2dc\ud0a8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 sparse shifted attention \uc774 fixed window attention \uacfc \uc720\uc0ac\ud558\uac8c \uc791\ub3d9\ud558\ub3c4\ub85d \ub9cc\ub4e0\ub2e4.")),(0,s.kt)("p",null,"PyTorch \uc2a4\ud0c0\uc77c\uc758 \ucf54\ub4dc\ub294 algorithm 1\uc5d0\uc11c \uc81c\uacf5\ub41c\ub2e4."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Algorithm 1",src:t(76129).Z,width:"2025",height:"1634"})),(0,s.kt)("h4",{id:"global-attention"},"Global Attention."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},'\ucc98\uc74c 4 initial tokens \uc744 "sink attention tokens" \ub85c \uc120\ud0dd\ud55c\ub2e4. '),(0,s.kt)("li",{parentName:"ul"},"Llama-2-7B \ubc0f Llama-3-8B \ubaa8\ub378\uc744 \ud6c8\ub828\ud560 \ub54c, \uc774 \uc124\uc815\uc740 StreamingLLM \uc758 \uad6c\uc870\ub97c \ub530\ub978\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Longformer \uc640 BigBird \uc758 global attention \uc804\ub7b5\uc744 \uc0ac\uc6a9\ud558\uc5ec, sink attention tokens \uac00 sequence \uc804\uc5ed\uc758 all tokens \uc5d0 attending \ud558\uace0, sequence \uc758 all tokens \uac00 sink attention tokens \uc5d0 attending \ud558\uac8c \ud55c\ub2e4"),(0,s.kt)("li",{parentName:"ul"},"\uad6c\uccb4\uc801\uc73c\ub85c, Segmentation & Reassembly Algorithm \ud6c4\uc5d0\ub294 current fixed window \ub0b4\uc758 all tokens \uc5d0 \ub300\ud55c attention scores map \uc744 shifed back version \uc73c\ub85c \uc5bb\ub294\ub2e4.")),(0,s.kt)("hr",null),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"g")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"g")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.625em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"g")))))," new tokens (sink attention tokens)\ub97c current sequence \uc5d0 \ucd94\uac00\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uadf8\uc5d0 \ub530\ub77c new adjacency matrix ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"B"),(0,s.kt)("mo",{parentName:"mrow"},"\u2208"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"["),(0,s.kt)("mn",{parentName:"mrow"},"0"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mn",{parentName:"mrow"},"1"),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mo",{parentName:"msup",stretchy:"false"},"]"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"N"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"g"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mo",{parentName:"mrow"},"\xd7"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"N"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"g"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B \\in [0, 1]^{(N+g) \\times (N+g)}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.7224em",verticalAlign:"-0.0391em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.138em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"["),(0,s.kt)("span",{parentName:"span",className:"mord"},"0"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1"),(0,s.kt)("span",{parentName:"span",className:"mclose"},(0,s.kt)("span",{parentName:"span",className:"mclose"},"]"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.888em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.063em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"+"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"g"),(0,s.kt)("span",{parentName:"span",className:"mclose mtight"},")"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"\xd7"),(0,s.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"+"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.03588em"}},"g"),(0,s.kt)("span",{parentName:"span",className:"mclose mtight"},")")))))))))))))," \uc744 \uad6c\uc131\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow"},"\u2208"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"{"),(0,s.kt)("mn",{parentName:"mrow"},"1"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mn",{parentName:"mrow"},"2"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mo",{parentName:"mrow"},"\u2026"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"g"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"}")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"i \\in \\{1, 2, \\ldots, g\\}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6986em",verticalAlign:"-0.0391em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"{"),(0,s.kt)("span",{parentName:"span",className:"mord"},"1"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"2"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"minner"},"\u2026"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"g"),(0,s.kt)("span",{parentName:"span",className:"mclose"},"}")))))," \uc77c \ub54c, ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"B"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"g"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"g"),(0,s.kt)("mo",{parentName:"mrow"},"+"),(0,s.kt)("mi",{parentName:"mrow"},"j"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mi",{parentName:"mrow"},"A"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"j"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2200"),(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"j"),(0,s.kt)("mo",{parentName:"mrow"},"\u2208"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"{"),(0,s.kt)("mn",{parentName:"mrow"},"1"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mo",{parentName:"mrow"},"\u2026"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"N"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"}")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B(g+i, g+j) = A(i, j) \\forall i, j \\in \\{1, \\ldots, N\\}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"g"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.854em",verticalAlign:"-0.1944em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.03588em"}},"g"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}}),(0,s.kt)("span",{parentName:"span",className:"mbin"},"+"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2222em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05724em"}},"j"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"A"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05724em"}},"j"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mord"},"\u2200"),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05724em"}},"j"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"\u2208"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mopen"},"{"),(0,s.kt)("span",{parentName:"span",className:"mord"},"1"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"minner"},"\u2026"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N"),(0,s.kt)("span",{parentName:"span",className:"mclose"},"}")))))," \uc744 \ub9cc\uc871\ud558\uba70, ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"B"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mo",{parentName:"mrow"},":"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B(i, :) = 1")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},":")),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1")))))," \uacfc ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"B"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mo",{parentName:"mrow"},":"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"1")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"B(:, i) = 1")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.05017em"}},"B"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mrel"},":")),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mpunct"},","),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"i"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}})),(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6444em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},"1")))))," \uc774 \ub41c\ub2e4.")),(0,s.kt)("p",null,"\uc774\ub807\uac8c \ud558\uba74, sink attention tokens \uc774 hidden layer \ub0b4\ubd80\ub85c \ub4e4\uc5b4\uac00\uae30 \uc804\uc5d0 attention scores \uacc4\uc0b0\uc5d0\uc11c \uacc4\uc18d attending \ud558\uac8c \ub41c\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub7ec\ud55c tokens \uc218\uac00 ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"n")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"n")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n")))))," \uc5d0 \ube44\ud574 \uc791\uace0 \ub3c5\ub9bd\uc801\uc774\ubbc0\ub85c, combined local \ubc0f global attention \uc758 complexity \ub294 \uc5ec\uc804\ud788 ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"O"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mi",{parentName:"mrow"},"log"),(0,s.kt)("mo",{parentName:"mrow"},"\u2061"),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"O(n \\log n)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"O"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mop"},"lo",(0,s.kt)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))," \uc774\ub2e4."),(0,s.kt)("h2",{id:"33-applying-kv-cache-algorithm-to-accelerate-inference-process"},"3.3 Applying KV Cache Algorithm to Accelerate Inference Process"),(0,s.kt)("p",null,"\uc774 \uc139\uc158\uc5d0\uc11c H",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O algorithm \uc744 LongLoRA \uc5d0 \uc801\uc6a9\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"LongLoRA codebase \ub294 inference stage \uc5d0\uc11c full attention \uc194\ub8e8\uc158\ub9cc\uc744 \uc81c\uacf5\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O aviction system \uc744 \ud1b5\ud569\ud558\uc5ec KV cache value \ub97c \uba54\ubaa8\ub9ac\uc5d0\uc11c \uad00\ub9ac\ud558\ub294 new class \ub97c \uc0dd\uc131\ud558\uc5ec inference process \ub97c optimization \ud55c\ub2e4. (Fig. 3)")),(0,s.kt)("p",null,"Tab. 2 \ub294 proof-pile test split \uc758 perplexity \ud3c9\uac00\ub97c \ubcf4\uc5ec\uc900\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 2",src:t(29317).Z,width:"2694",height:"1382"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"S2-Attn \uc740 Shifted Sparse Attention \uc744 \uc758\ubbf8\ud558\uba70, SF-Attn \uc740 Sink Fixed Attention \uc744 \uc758\ubbf8\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\ub294 LongAlpaca dataset \uc744 \uc0ac\uc6a9\ud558\uc5ec Llama2 \uc640 Llama3 \uc758 7B \ubc0f 8B model size \uc5d0\uc11c 8k-32k context length \ub85c supervied fine-tuning \uc744 \uc9c4\ud589\ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 \ubc29\ubc95\uc740 full attention \ub610\ub294 FFT baseline \uacfc \ube44\uad50\ud560 \ub54c \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \ub2ec\uc131\ud558\uba74\uc11c\ub3c4 \ub354 \ub098\uc740 \ud6a8\uc728\uc131\uc744 \ubcf4\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ud3c9\uac00\uc5d0\ub294 Sec. 4.1 \uc758 PG19 \uc5d0\uc11c \ud3c9\uac00\ub41c \ubaa8\ub378\uacfc \ub3d9\uc77c\ud55c training settings \ub97c \uc0ac\uc6a9\ud558\uc600\ub2e4.")),(0,s.kt)("h1",{id:"4-experiment"},"4. Experiment"),(0,s.kt)("h2",{id:"41-experimental-settings"},"4.1 Experimental Settings"),(0,s.kt)("h3",{id:"411-environments"},"4.1.1 Environments"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\ubaa8\ub4e0 \uc2e4\ud5d8\uc740 2\xd7 A100 GPU \uc5d0\uc11c \uc218\ud589\ub418\uc5c8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"model training \uc744 \uc704\ud574 PyTorch \uc744 \uc8fc\uc694 \ud504\ub808\uc784\uc6cc\ud06c\ub85c \uc0ac\uc6a9\ud558\uba70, DeepSpeed \uc640 Flash-Attention2 \uc744 \ud1b5\ud569\ud558\uc5ec \uc131\ub2a5\uc744 \ucd5c\uc801\ud654\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uae30\ubcf8\uc801\uc73c\ub85c DeepSpeed \ub294 stage 2 \uc5d0\uc11c \uc0ac\uc6a9\ub418\uba70, stage 3 \uc740 \ucd5c\ub300 context length \uc640 \uad00\ub828\ub41c \uc2e4\ud5d8\uc5d0 \uc608\uc57d\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uba54\ubaa8\ub9ac \uad00\ub9ac\ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ud558\uae30 \uc704\ud574 Peft codebase \uc5d0\uc11c \ud45c\uc900 \uae30\uc220\uc778 Gradient checkpointing \uc774 \uc0ac\uc6a9\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ub300\ubd80\ubd84\uc758 \uc2e4\ud5d8\uc740 2\xd7 A100 GPU \ub97c \uc0ac\uc6a9\ud588\uc9c0\ub9cc, 7B \ubaa8\ub378\uc744 8192 context \ud06c\uae30\ub85c fine-tuning \ud558\ub294 \uc791\uc5c5\uc5d0\ub294 RTX 4090 GPU \ub97c \uc0ac\uc6a9\ud558\ub294 \uac83\ub3c4 \uac00\ub2a5\ud558\ub2e4.")),(0,s.kt)("h3",{id:"412-models"},"4.1.2 Models"),(0,s.kt)("p",null,"pre-trained Llama2 \uc758 7B chat-version Llama3 \uc758 8B \ubaa8\ub378\uc744 \ud655\uc7a5\ud558\uc5ec \uc0ac\uc6a9\ud55c\ub2e4."),(0,s.kt)("h3",{id:"413-training-procedure"},"4.1.3 Training Procedure"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"model training \uc744 \uc704\ud574 Llama-2\uc640 Llama-3 model \uc744 bf16 precision \uc73c\ub85c \ud65c\uc131\ud654\ud558\uace0, \ucd5c\ub300 sequence length \ub294 \uc694\uad6c \uc0ac\ud56d\uc5d0 \ub530\ub77c \uc124\uc815\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Flash Attention \uc744 \uc0ac\uc6a9\ud558\uc5ec \ud6a8\uc728\uc801\uc778 \uacc4\uc0b0\uc744 \uc218\ud589\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Low-rank training \uc774 \ud65c\uc131\ud654\ub418\uba70, model \uc740 batch size 1 \ub85c \ud6c8\ub828\uc744 3 epochs \ub3d9\uc548 \uc218\ud589\ud558\uace0, \ud3c9\uac00\ub97c \uc704\ud574 batch size 2 \ub97c \uc0ac\uc6a9\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Gradient accumulation \uc740 1 step \uc73c\ub85c \uc124\uc815\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ud3c9\uac00 \uc804\ub7b5\uc740 \ube44\ud65c\uc131\ud654\ub418\uba70, model \uc740 512 steps \ub9c8\ub2e4 \uc800\uc7a5\ub418\uba70 \ucd1d 2 checkpoint \uac00 \uc800\uc7a5\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"learning rate \uc740 2e-5\ub85c \uc124\uc815\ub418\uba70, weight decay \ub294 \uc5c6\uace0, 20 steps \uc758 warmup phase \uac00 \ud3ec\ud568\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"learning rate \uc740 warmup \uc774 \ud3ec\ud568\ub41c constant schedule \uc5d0 \ub530\ub978\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"log \ub294 \ub9e4 step \ub9c8\ub2e4 \uae30\ub85d\ub418\uba70, training process \ub294 DeepSpeed \uad6c\uc131 (stage2.json) \uc744 \uc0ac\uc6a9\ud558\uc5ec tf32 precision \uc774 \ud65c\uc131\ud654\ub41c \uc0c1\ud0dc\uc5d0\uc11c \ucd5c\uc801\ud654\ub41c\ub2e4.")),(0,s.kt)("h3",{id:"414-datasets"},"4.1.4 Datasets"),(0,s.kt)("p",null,'"LongAlpaca-Plus" dataset \uc740 28,000 entries \ub85c \uad6c\uc131\ub418\uba70, LongAlpaca \uc758 \uc5c5\ub370\uc774\ud2b8 \ubc84\uc804\uc73c\ub85c \ub2e4\uc591\ud55c \ucd9c\ucc98\uc5d0 \uc911\uc810\uc744 \ub450\uace0 \uc788\ub2e4. '),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"dataset \uc758 44% \ub294 Natural Questions \uc73c\ub85c, \ucd1d 12,320 entries \uc774 \ud3ec\ud568\ub418\uba70, Natural Questions data \uc758 subset \uc5d0 \ucd9c\ucc98\ub97c \ub450\uace0 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"RedPajama \ub294 dataset \uc758 27% \ub97c \ucc28\uc9c0\ud558\uba70, 7,560 entries \ud3ec\ud568. "),(0,s.kt)("li",{parentName:"ul"},"Book Summarization \uc740 dataset \uc758 18% \ub97c \ucc28\uc9c0\ud558\uba70, 5,040 entries \ud3ec\ud568."),(0,s.kt)("li",{parentName:"ul"},"LongQA \ub294 \uac00\uc7a5 \uc791\uc740 \ubd80\ubd84\uc744 \ucc28\uc9c0\ud558\uba70 11% \ub85c, 3,080 entries \ud3ec\ud568. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c \ubd84\ud3ec\ub294 long instruction task \ub97c \uc704\ud55c \ub2e4\uc591\ud558\uace0 \ud3ec\uad04\uc801\uc778 dataset \uc744 \ubcf4\uc7a5\ud55c\ub2e4.")),(0,s.kt)("h3",{id:"415-metrics"},"4.1.5 Metrics"),(0,s.kt)("h4",{id:"perplexity"},"Perplexity"),(0,s.kt)("p",null,"Perplexity \ub294 NLP \uc5d0\uc11c \uc911\uc694\ud55c metric \uc73c\ub85c, language model \uc758 \uc608\uce21 \ubd88\ud655\uc2e4\uc131\uc744 \uc815\ub7c9\ud654\ud558\uba70, \uc2e4\uc81c \ub2e8\uc5b4 sequence \uc5d0 \ud560\ub2f9\ub41c \ud655\ub960\uacfc \ubc18\ube44\ub840\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc815\ubcf4 \uc774\ub860\uc5d0\uc11c \uc720\ub798\ub41c perplexity \ub294 \ud1b5\uc2e0 \uc2dc\uc2a4\ud15c\uc758 \ud6a8\uc728\uc131\uc744 \uce21\uc815\ud558\uba70, NLP \uc5d0\uc11c\ub294 language model \uc774 language pattern \uc744 \uc5bc\ub9c8\ub098 \uc798 \uc774\ud574\ud558\ub294\uc9c0\ub97c \ubc18\uc601\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc218\ud559\uc801\uc73c\ub85c, perplexity \ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc815\uc758\ub41c\ub2e4:"),(0,s.kt)("div",{className:"math math-display"},(0,s.kt)("span",{parentName:"div",className:"katex-display"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mtable",{parentName:"semantics",rowspacing:"0.16em",columnspacing:"1em"},(0,s.kt)("mtr",{parentName:"mtable"},(0,s.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,s.kt)("mtd",{parentName:"mtr"},(0,s.kt)("mstyle",{parentName:"mtd",scriptlevel:"0",displaystyle:"true"},(0,s.kt)("mrow",{parentName:"mstyle"},(0,s.kt)("mtext",{parentName:"mrow"},"Perplexity"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("msup",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msup"},"e"),(0,s.kt)("mrow",{parentName:"msup"},(0,s.kt)("mo",{parentName:"mrow"},"\u2212"),(0,s.kt)("mfrac",{parentName:"mrow"},(0,s.kt)("mn",{parentName:"mfrac"},"1"),(0,s.kt)("mi",{parentName:"mfrac"},"N")),(0,s.kt)("munderover",{parentName:"mrow"},(0,s.kt)("mo",{parentName:"munderover"},"\u2211"),(0,s.kt)("mrow",{parentName:"munderover"},(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow"},"="),(0,s.kt)("mn",{parentName:"mrow"},"1")),(0,s.kt)("mi",{parentName:"munderover"},"N")),(0,s.kt)("mi",{parentName:"mrow"},"log"),(0,s.kt)("mo",{parentName:"mrow"},"\u2061"),(0,s.kt)("mi",{parentName:"mrow"},"p"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"w"),(0,s.kt)("mi",{parentName:"msub"},"i")),(0,s.kt)("mi",{parentName:"mrow",mathvariant:"normal"},"\u2223"),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"w"),(0,s.kt)("mrow",{parentName:"msub"},(0,s.kt)("mi",{parentName:"mrow"},"i"),(0,s.kt)("mo",{parentName:"mrow"},"\u2212"),(0,s.kt)("mn",{parentName:"mrow"},"1"))),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("mo",{parentName:"mrow"},"\u2026"),(0,s.kt)("mo",{parentName:"mrow",separator:"true"},","),(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mi",{parentName:"msub"},"w"),(0,s.kt)("mn",{parentName:"msub"},"1")),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")))))),(0,s.kt)("mtd",{parentName:"mtr",className:"mtr-glue"}),(0,s.kt)("mtd",{parentName:"mtr",className:"mml-eqn-num"}))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"\\begin{equation} \\text{Perplexity} = e^{-\\frac{1}{N} \\sum_{i=1}^{N} \\log p(w_i | w_{i-1}, \\ldots, w_1)} \\end{equation}")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1.4164em",verticalAlign:"-0.4582em"}}),(0,s.kt)("span",{parentName:"span",className:"mtable"},(0,s.kt)("span",{parentName:"span",className:"col-align-c"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.9582em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.9582em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.0564em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord text"},(0,s.kt)("span",{parentName:"span",className:"mord"},"Perplexity")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mrel"},"="),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.2778em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"e"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"1.0564em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-3.413em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"\u2212"),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mopen nulldelimiter sizing reset-size3 size6"}),(0,s.kt)("span",{parentName:"span",className:"mfrac"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.8443em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.656em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N")))),(0,s.kt)("span",{parentName:"span",style:{top:"-3.2255em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"frac-line mtight",style:{borderBottomWidth:"0.049em"}})),(0,s.kt)("span",{parentName:"span",style:{top:"-3.384em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.344em"}},(0,s.kt)("span",{parentName:"span"}))))),(0,s.kt)("span",{parentName:"span",className:"mclose nulldelimiter sizing reset-size3 size6"})),(0,s.kt)("span",{parentName:"span",className:"mspace mtight",style:{marginRight:"0.1952em"}}),(0,s.kt)("span",{parentName:"span",className:"mop mtight"},(0,s.kt)("span",{parentName:"span",className:"mop op-symbol small-op mtight",style:{position:"relative",top:"0em"}},"\u2211"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.9191em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.1786em",marginLeft:"0em",marginRight:"0.0714em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"i"),(0,s.kt)("span",{parentName:"span",className:"mrel mtight"},"="),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1")))),(0,s.kt)("span",{parentName:"span",style:{top:"-2.931em",marginRight:"0.0714em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.10903em"}},"N"))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3214em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mspace mtight",style:{marginRight:"0.1952em"}}),(0,s.kt)("span",{parentName:"span",className:"mop mtight"},(0,s.kt)("span",{parentName:"span",className:"mtight"},"l"),(0,s.kt)("span",{parentName:"span",className:"mtight"},"o"),(0,s.kt)("span",{parentName:"span",className:"mtight",style:{marginRight:"0.01389em"}},"g")),(0,s.kt)("span",{parentName:"span",className:"mspace mtight",style:{marginRight:"0.1952em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"p"),(0,s.kt)("span",{parentName:"span",className:"mopen mtight"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02691em"}},"w"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3281em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"-0.0269em",marginRight:"0.0714em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"i")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.143em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"\u2223"),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02691em"}},"w"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3281em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"-0.0269em",marginRight:"0.0714em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight"},"i"),(0,s.kt)("span",{parentName:"span",className:"mbin mtight"},"\u2212"),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1"))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.2025em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mpunct mtight"},","),(0,s.kt)("span",{parentName:"span",className:"minner mtight"},"\u2026"),(0,s.kt)("span",{parentName:"span",className:"mpunct mtight"},","),(0,s.kt)("span",{parentName:"span",className:"mord mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mathnormal mtight",style:{marginRight:"0.02691em"}},"w"),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3173em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.357em",marginLeft:"-0.0269em",marginRight:"0.0714em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.5em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size3 size1 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"1")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.143em"}},(0,s.kt)("span",{parentName:"span"})))))),(0,s.kt)("span",{parentName:"span",className:"mclose mtight"},")")))))))))))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.4582em"}},(0,s.kt)("span",{parentName:"span"}))))))),(0,s.kt)("span",{parentName:"span",className:"tag"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.9582em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.9582em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"3.0564em"}}),(0,s.kt)("span",{parentName:"span",className:"eqn-num"}))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.4582em"}},(0,s.kt)("span",{parentName:"span"}))))))))),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"p"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"x"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"p(x)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"p"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"x"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))," : all possible sequiences ",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"x")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"x")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4306em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"x")))))," \uc5d0 \ub300\ud55c probability distribution"),(0,s.kt)("li",{parentName:"ul"},"perplexity \ub294 \ucd08\uae30 n-gram \ubd80\ud130 DNN \uae4c\uc9c0, language model \uc744 \ud3c9\uac00\ud558\ub294 \ub370 \uad11\ubc94\uc704\ud558\uac8c \uc0ac\uc6a9\ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 \ubaa8\ub378 \uc131\ub2a5 \ube44\uad50, \uac1c\ubc1c \uc911 \uc870\uc815, \uae30\uacc4 \ubc88\uc5ed \ubc0f \ud14d\uc2a4\ud2b8 \uc0dd\uc131 \uc791\uc5c5 \ud5a5\uc0c1\uc5d0 \ub3c4\uc6c0\uc744 \uc8fc\uba70, \ubaa8\ub378 \uac1c\uc120 \ubc0f \ub2e4\uc591\ud55c \uad6c\uc131\uc758 \ud6a8\uacfc\uc131\uc744 \ud3c9\uac00\ud558\ub294 \ub370 \ud544\uc218\uc801\uc778 \ub3c4\uad6c\uc774\ub2e4.")),(0,s.kt)("h4",{id:"passkey-retrieval"},"Passkey Retrieval"),(0,s.kt)("p",null,"Passkey Retrieval \uc5d0\uc11c\ub294 LongLoRA \uc5d0\uc11c \uc81c\uacf5\ud558\ub294 \ud615\uc2dd\uc744 \uc720\uc0ac\ud558\uac8c \uc0ac\uc6a9\ud558\uc5ec passkey \ub97c \uac80\uc0c9\ud55c\ub2e4. "),(0,s.kt)("p",null,"\ubb38\uc11c\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \uad6c\uc870\ub97c \ub530\ub978\ub2e4:"),(0,s.kt)("p",null,"\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\uaf43\uc774 \ud53c\uc5b4 \uc788\ub2e4. \ub098\ubb34\uac00 \ud06c\ub2e4. \uac15\uc774 \ud750\ub978\ub2e4. \uadf8\ub0e5 \uacc4\uc18d \uac00\ub77c. \uc55e\uc73c\ub85c \ub098\uc544\uac00\ub77c.",(0,s.kt)("br",{parentName:"p"}),"\n","(",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"M")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"M")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"M")))))," \ubc88 \ubc18\ubcf5)",(0,s.kt)("br",{parentName:"p"}),"\n","\uc911\uc694 \uba54\ubaa8: passkey \ub294 84729 \uc774\ub2e4. \uc774 \uc22b\uc790\ub97c \uae30\uc5b5\ud558\ub77c. 84729 \uac00 passkey \uc774\ub2e4.",(0,s.kt)("br",{parentName:"p"}),"\n","\uaf43\uc774 \ud53c\uc5b4 \uc788\ub2e4. \ub098\ubb34\uac00 \ud06c\ub2e4. \uac15\uc774 \ud750\ub978\ub2e4. \uadf8\ub0e5 \uacc4\uc18d \uac00\ub77c. \uc55e\uc73c\ub85c \ub098\uc544\uac00\ub77c.",(0,s.kt)("br",{parentName:"p"}),"\n","(",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"N")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," \ubc88 \ubc18\ubcf5)",(0,s.kt)("br",{parentName:"p"}),"\n","passkey \ub294 \ubb34\uc5c7\uc778\uac00? passkey \ub294. . .",(0,s.kt)("br",{parentName:"p"}),"\n","\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014"),(0,s.kt)("p",null,"document length \ub294 ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"M")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"M")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"M")))))," \uacfc ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"N")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"N")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.6833em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.10903em"}},"N")))))," value \uc5d0 \ub530\ub77c \ub2ec\ub77c\uc9c4\ub2e4. "),(0,s.kt)("p",null,"passkey \ubc88\ud638, \uc598\ub877 84729 \ub294 \uc784\uc758\ub85c \uc0dd\uc131\ub418\uba70 \uac01 text \ub9c8\ub2e4 \ubcc0\uacbd\ub41c\ub2e4."),(0,s.kt)("h4",{id:"longbench"},"LongBench"),(0,s.kt)("p",null,"LongBench \ub294 large language model (LLM)\uc758 long-context understanding capabilities \uc744 \ud3c9\uac00\ud558\uae30 \uc704\ud574 \uc124\uacc4\ub41c \uc774\uc911 \uc5b8\uc5b4, \uba40\ud2f0\ud0dc\uc2a4\ud06c \ubca4\uce58\ub9c8\ud06c\uc774\ub2e4. "),(0,s.kt)("p",null,"\uc601\uc5b4\uc640 \uc911\uad6d\uc5b4\uc5d0\uc11c extended text input \uc744 \ucc98\ub9ac\ud558\ub294 \ubaa8\ub378\uc758 \uc131\ub2a5\uc744 \ud3c9\uac00\ud558\ub294 \ub370 \uc911\uc810\uc744 \ub450\uba70, \ub2e4\uc74c 6 task categories \ub97c \ud3ec\ud568\ud558\ub294 21 dataset \uc744 \ud3ec\ud568\ud55c\ub2e4: single-document QA, multi-document QA, summarization, few-shot learning, synthetic tasks, code completion."),(0,s.kt)("h2",{id:"42-main-results"},"4.2 Main Results"),(0,s.kt)("h4",{id:"perplexity-result"},"Perplexity Result."),(0,s.kt)("p",null,"Tab. 2\uc640 Tab. 3\uc758 \ub370\uc774\ud130\ub97c \ubd84\uc11d\ud55c \uacb0\uacfc\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4: Tab. 2 \ub294 proof-pile test split \uc5d0 \ub300\ud55c perplexity \ud3c9\uac00\ub97c \uc81c\uacf5\ud558\uba70, 3 types attention \uba54\ucee4\ub2c8\uc998: Full-Attn, S2-Attn, SF-Attn \uc774 7B \ubc0f 8B model size \uc5d0\uc11c \uc0ac\uc6a9\ub418\uc5c8\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 2",src:t(29317).Z,width:"2694",height:"1382"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"7B-Llama2 model \uc5d0\uc11c 8192 \uc758 training context length \ub97c \uc0ac\uc6a9\ud588\uc744 \ub54c, SF-Attn \uba54\ucee4\ub2c8\uc998\uc774 all target context length (4096, 6144, 8192)\uc5d0\uc11c \ub2e4\ub978 attention \uba54\ucee4\ub2c8\uc998\ubcf4\ub2e4 \uc77c\uad00\ub418\uac8c \uc6b0\uc218\ud55c \uc131\ub2a5\uc744 \ubcf4\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uad6c\uccb4\uc801\uc73c\ub85c, SF-Attn \uc758 perplexity \uac12\uc740 \uac01\uac01 8.60, 8.17, 7.85 \ub85c, \ub354 \ud6a8\uc728\uc801\uc778 \uc131\ub2a5\uc744 \ub098\ud0c0\ub0b8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ube44\uc2b7\ud558\uac8c, \uac19\uc740 context length \ub85c \ud6c8\ub828\ub41c 8B-Llama3 model \uc740 SF-Attn \uba54\ucee4\ub2c8\uc998\uc744 \uc0ac\uc6a9\ud560 \ub54c \ub0ae\uc740 perplexity \uc810\uc218\ub97c \uae30\ub85d\ud55c\ub2e4: 4096, 6144, 8192 \uc758 target context length \uc5d0 \ub300\ud574 \uac01\uac01 5.11, 4.86, 4.66 \uc744 \uae30\ub85d\ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 SF-Attn \uba54\ucee4\ub2c8\uc998\uc774 Full-Attn \ubc0f S2-Attn \ubcf4\ub2e4 perplexity \uc5d0\uc11c \uc8fc\ubaa9\ud560 \ub9cc\ud55c \uac1c\uc120\uc744 \uc81c\uacf5\ud568\uc744 \ub098\ud0c0\ub0b8\ub2e4.")),(0,s.kt)("p",null,"Tab. 3\uc740 \ub2e8\uc77c 2\xd7 A100 \uc744 \uc0ac\uc6a9\ud558\uc5ec \ub2e4\uc591\ud55c model size \uc5d0 \ub300\ud574 fine-tuning \ud560 \uc218 \uc788\ub294 \ucd5c\ub300 context length \ub97c \uc694\uc57d\ud558\uace0 \uc788\ub2e4."),(0,s.kt)("p",null,"Llama2\uc640 Llama3 model \uc740 \ub3d9\uc77c\ud55c training settings \ub97c \uc0ac\uc6a9\ud558\uc5ec \ud3c9\uac00\ub418\uc5c8\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 3",src:t(59329).Z,width:"2415",height:"813"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"7B-Llama2 model \uc740 \ud3c9\uac00 context length 2048, 4096, 8192, 12288, 16384 \uc5d0 \ub300\ud574 \uac01\uac01 8.73, 8.55, 8.30, 8.13, 8.05 \uc758 perplexity \uacb0\uacfc\ub97c \ubcf4\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"8B-Llama3 model \uc740 \uac19\uc740 \ud3c9\uac00 context length \uc5d0 \ub300\ud574 5.11, 5.02, 4.89, 4.77, 4.72 \uc758 perplexity \uac12\uc744 \uae30\ub85d\ud55c\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uacb0\uacfc\ub4e4\uc740 SF-Attn \uba54\ucee4\ub2c8\uc998\uc774 perplexity \uba74\uc5d0\uc11c Full-Attn \ubc0f S2-Attn \uba54\ucee4\ub2c8\uc998\ubcf4\ub2e4 \uc6b0\uc218\ud558\ub2e4\ub294 \uac83\uc744 \ub098\ud0c0\ub0b4\uba70, \ud2b9\ud788 larger context length \uc5d0\uc11c \ub354\uc6b1 \ub450\ub4dc\ub7ec\uc9c4\ub2e4.",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 LongLoRA \ud504\ub808\uc784\uc6cc\ud06c \ub0b4\uc5d0\uc11c H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O algorithm \uc758 \ud6a8\uc728\uc131\uacfc \ud6a8\uacfc\uc131\uc744 \uac80\uc99d\ud55c\ub2e4.")))),(0,s.kt)("h4",{id:"passkey-retrieval-result"},"Passkey Retrieval Result."),(0,s.kt)("p",null,"Tab. 4\uc640 Fig. 5\uc758 \ub370\uc774\ud130\ub97c \ubd84\uc11d\ud55c \uacb0\uacfc\ub294 \ub2e4\uc74c\uacfc \uac19\ub2e4:"),(0,s.kt)("p",null,"Tab. 4 \ub294 LongChat \uc744 \uc0ac\uc6a9\ud55c \uc8fc\uc81c \uac80\uc0c9 \ud3c9\uac00\ub97c \uc81c\uc2dc\ud55c\ub2e4. \uc774 task \ub294 3k, 6k, 10k, 13k, 16k \uc758 context length \uc5d0\uc11c very long dialog \uc5d0\uc11c \ubaa9\ud45c \uc8fc\uc81c\ub97c \uac80\uc0c9\ud558\ub294 \uac83\uc774\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 4",src:t(95416).Z,width:"2407",height:"1052"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 model \uc740 Llama3 8B \ub85c fine-tuning \ub418\uc5c8\uc73c\uba70, SOTA LongChat-13B \uc640 \ube44\uad50\ud558\uc5ec low fine-tuning cost \ub85c \uc720\uc0ac\ud55c \uc131\ub2a5\uc744 \ub2ec\uc131\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uad6c\uccb4\uc801\uc73c\ub85c, \uc800\uc790\uc758 \ubaa8\ub378\uc740 10k \uae4c\uc9c0\uc758 context length \uc5d0\uc11c 1.00 \uc758 \uc815\ud655\ub3c4\ub97c \uc720\uc9c0\ud558\uba70, 13k \ubc0f 16k context length \uc5d0\uc11c\ub294 \uac01\uac01 0.98 \ubc0f 0.96 \uc73c\ub85c \uc57d\uac04 \uac10\uc18c\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 long-context retrieval tasks \ub97c \ucc98\ub9ac\ud558\ub294 \ub370 \uc788\uc5b4 \ubaa8\ub378\uc758 \uac15\uac74\uc131\uacfc \ud6a8\uc728\uc131\uc744 \ubcf4\uc5ec\uc900\ub2e4.")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 5",src:t(3010).Z,width:"2421",height:"1253"})),(0,s.kt)("p",null,"Fig. 5 \ub294 Llama2 7B, LongLoRA 7B, \uadf8\ub9ac\uace0 32,768 context length \uc758 \uc800\uc790\uc758 fine-tuned 7B model \uac04\uc758 passkey retrieval accuracy \ub97c \ube44\uad50\ud55c\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc800\uc790\uc758 \ubaa8\ub378\uc740 LongLoRA \uc758 context length \ud55c\uacc4\uc778 30k \ubc0f 34k \ub97c \ucd08\uacfc\ud558\uc5ec 33k \ub610\ub294 36k \uae4c\uc9c0 \uac80\uc0c9 \uc815\ud655\ub3c4\uc758 \uc800\ud558\uac00 \uc5c6\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 \uc800\uc790\uc758 \ubaa8\ub378\uc774 \uae30\uc874 \ubaa8\ub378\ubcf4\ub2e4 longer context length \ub97c \ub192\uc740 \uc815\ud655\ub3c4\ub85c \ucc98\ub9ac\ud560 \uc218 \uc788\uc74c\uc744 \ub098\ud0c0\ub0b8\ub2e4.")),(0,s.kt)("h4",{id:"longbench-result"},"LongBench Result."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 6",src:t(13432).Z,width:"2444",height:"848"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"Tab. 6 \ubd84\uc11d\ud55c \uacb0\uacfc, GPT-3.5-Turbo \ub294 \ub2e4\uc591\ud55c task \uc5d0\uc11c \ub2e4\ub978 \ubaa8\ub378\ub4e4\ubcf4\ub2e4 \uc77c\uad00\ub418\uac8c \uc6b0\uc218\ud55c \uc131\ub2a5\uc744 \ubcf4\uc774\uba70, \uac00\uc7a5 \ub192\uc740 \ud3c9\uade0 \uc810\uc218(44.0)\ub97c \uae30\ub85d\ud558\uc600\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 GPT-3.5-Turbo \uc758 \ub6f0\uc5b4\ub09c \uc804\uccb4 \uc131\ub2a5\uc744 \ub098\ud0c0\ub0b8\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\ud2b9\ud788, Ours-7B \ub294 \ub450 \ubc88\uc9f8\ub85c \ub192\uc740 \ud3c9\uade0 \uc810\uc218(38.8)\ub97c \uae30\ub85d\ud558\uba70 \uacbd\uc7c1\ub825 \uc788\ub294 \uc131\ub2a5\uc744 \ubcf4\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uad6c\uccb4\uc801\uc73c\ub85c, Ours-7B \ub294 Code task \uc5d0\uc11c 59.2\uc758 \uc120\ub3c4\uc801\uc778 \uc810\uc218\ub97c \uae30\ub85d\ud558\uba70, GPT-3.5-Turbo (54.1)\ub97c \ucd08\uacfc\ud55c\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c \uac15\uc810\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0, \ud2b9\ud788 Synthetic task \uc5d0\uc11c Ours-7B \uac00 22.3 \uc744 \uae30\ub85d\ud558\uba70 GPT-3.5-Turbo \uc758 37.8 \ubcf4\ub2e4 \uc0c1\ub2f9\ud788 \ub0ae\uc740 \uc810\uc218\ub97c \uae30\ub85d\ud558\uc600\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub294 \ubaa8\ub378\uc758 Synthetic task \ub2a5\ub825\uc744 \ud5a5\uc0c1\uc2dc\ucf1c \uc804\uccb4 \uc131\ub2a5\uc744 \ub354\uc6b1 \ub192\uc77c \ud544\uc694\uac00 \uc788\uc74c\uc744 \uac15\uc870\ud55c\ub2e4. "))),(0,s.kt)("li",{parentName:"ul"},"\uc804\ubc18\uc801\uc73c\ub85c GPT-3.5-Turbo \uac00 \uc5ec\uc804\ud788 \ucd5c\uace0\uc758 \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uace0 \uc788\uc9c0\ub9cc, \uc800\uc790\uc758 \ubaa8\ub378\uc740 \uc720\ub9dd\ud55c \uacb0\uacfc\uc640 \ucd5c\uc801\ud654 \uac00\ub2a5\uc131\uc744 \ubcf4\uc778\ub2e4.")),(0,s.kt)("h4",{id:"h_2o-inference-result"},"H",(0,s.kt)("span",{parentName:"h4",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O Inference Result"),(0,s.kt)("p",null,"\uc774 \ubd84\uc11d\uc5d0\uc11c\ub294 LLaMA-3-8B \ubaa8\ub378\uc5d0 \ub300\ud574 \ub2e4\uc591\ud55c KV cache \ubc29\ubc95\uc758 \uc131\ub2a5\uacfc \ud6a8\uc728\uc131\uc744 \uac80\ud1a0\ud55c\ub2e4."),(0,s.kt)("p",null,"Fig. 6 \uc740 full cache \ub97c \uc0ac\uc6a9\ud558\ub294 base model, H",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),'O \ubc29\ubc95, \ubc0f recent KV embedding \uc744 \uc0ac\uc6a9\ud558\ub294 "Local" \uc804\ub7b5 \uac04\uc758 \ube44\uad50 \ubd84\uc11d\uc744 \uc81c\uacf5\ud55c\ub2e4. \ud3c9\uac00\ub294 OpenBookQA dataset \uc5d0\uc11c \uc218\ud589\ub418\uc5c8\ub2e4. '),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 6",src:t(58731).Z,width:"2444",height:"1401"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc8fc\ubaa9\ud560 \uc810\uc740 Heavy-Hitter Oracle (H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O) \ubc29\ubc95\uc774 KV cache \uc608\uc0b0\uc774 \uc904\uc5b4\ub4e4\uc5b4\ub3c4 \ub192\uc740 \uc815\ud655\ub3c4 \uc218\uc900\uc744 \uc720\uc9c0\ud558\uba70 \ubaa8\ub378 \uc131\ub2a5\uc744 \ubcf4\uc874\ud558\ub294 \ub370 \ud6a8\uacfc\uc801\uc774\ub77c\ub294 \uac83\uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\ubc18\ub300\ub85c, Local \ubc29\ubc95\uc740 KV cache \uc608\uc0b0\uc774 \uc904\uc5b4\ub4e4\uba74\uc11c \uc815\ud655\ub3c4\uac00 \ud604\uc800\ud788 \uac10\uc18c\ud55c\ub2e4.")),(0,s.kt)("p",null,"Tab. 6\uc740 \ub2e4\uc591\ud55c KV cache \uc608\uc0b0\uc5d0 \ub530\ub978 LLaMA-3-8B \uc758 inference time \uc744 \uc790\uc138\ud788 \uc124\uba85\ud55c\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 5",src:t(51071).Z,width:"2444",height:"848"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \ubc29\ubc95\uc740 \ubaa8\ub4e0 cache \uc608\uc0b0\uc5d0\uc11c Full \ubc29\ubc95\uc5d0 \ube44\ud574 inference time \uc744 \ud06c\uac8c \uc904\uc778\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc608\ub85c, 100% KV cache \uc608\uc0b0\uc5d0\uc11c H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \ubc29\ubc95\uc740 inference time \uc744 4.7 hours (Full)\uc5d0\uc11c 4.4 hours \ub85c \ub2e8\ucd95\uc2dc\ud0a8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \ub2e8\ucd95\uc740 \ub354 \ub0ae\uc740 KV cache \uc608\uc0b0\uc5d0\uc11c \ub354\uc6b1 \ub450\ub4dc\ub7ec\uc9c0\uba70, \uc81c\ud55c\ub41c \uc790\uc6d0 \ud658\uacbd\uc5d0\uc11c H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \ubc29\ubc95\uc758 \ud6a8\uc728\uc131\uc744 \uac15\uc870\ud55c\ub2e4.")),(0,s.kt)("p",null,"\uacb0\ub860\uc801\uc73c\ub85c, H",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \ubc29\ubc95\uc740 \ub192\uc740 \uc815\ud655\ub3c4\ub97c \uc720\uc9c0\ud558\uba74\uc11c inference time \uc744 \uc904\uc774\ub294 \ucd5c\uc801\uc758 \uade0\ud615\uc744 \uc81c\uacf5\ud558\uba70, LLaMA-3-8B \uac19\uc740 large language model \uc744 \ucd5c\uc801\ud654\ud558\ub294 \ub370 \uc720\uc6a9\ud55c \uc804\ub7b5\uc73c\ub85c \ud3c9\uac00\ub41c\ub2e4. "),(0,s.kt)("p",null,"\uc774 \ubc29\ubc95\uc740 \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uba74\uc11c \uc0c1\ub2f9\ud55c computational costs \uc808\uac10\uc744 \uc81c\uacf5\ud560 \uc218 \uc788\ub294 \uc7a0\uc7ac\ub825\uc744 \uac15\uc870\ud55c\ub2e4."),(0,s.kt)("h2",{id:"43-ablation-study"},"4.3 Ablation Study"),(0,s.kt)("h4",{id:"ablation-on-sf-attn-training-steps"},"Ablation on SF-Attn training steps."),(0,s.kt)("p",null,"SF-Attn \ud6c8\ub828 \ubc29\ubc95\uc758 \ub2e4\uc591\ud55c \uad6c\uc131 \uc694\uc18c\uc758 \ud6a8\uacfc\ub97c \ud3c9\uac00\ud558\uae30 \uc704\ud574 \uc77c\ub828\uc758 ablation study \ub97c \uc218\ud589\ud55c\ub2e4. "),(0,s.kt)("p",null,"Tab. 7 \uc740 PG-19 dataset \uc758 validation split \uc744 \uc0ac\uc6a9\ud55c \ub2e4\uc591\ud55c \ud6c8\ub828 \ubc29\ubc95\uc5d0 \ub300\ud55c perplexity \uacb0\uacfc\ub97c \uc81c\uc2dc\ud55c\ub2e4."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 7",src:t(80048).Z,width:"2989",height:"1067"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"SF-Attn \ubc29\ubc95\ub9cc \uc0ac\uc6a9\ud588\uc744 \ub54c perplexity \ub294 8.64 \ub85c, \ube44\uad50 \uae30\uc900\uc744 \uc124\uc815\ud558\ub294 baseline \uc774 \ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"S2-Attn \uc5d0 global attention \uc744 \ucd94\uac00\ud588\uc744 \ub54c\ub294 perplexity \uac00 8.91 \ub85c, global attention \ub9cc\uc73c\ub85c\ub294 \uc131\ub2a5\uc774 \ud06c\uac8c \ud5a5\uc0c1\ub418\uc9c0 \uc54a\uc74c\uc744 \ub098\ud0c0\ub0b8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"S2-Attn \uacfc Segmentation and Reassembly (S&R) algorithm \uc744 \uacb0\ud569\ud55c \uacbd\uc6b0\uc758 perplexity \ub294 8.86 \uc73c\ub85c, S2-Attn \ub9cc \uc0ac\uc6a9\ud560 \ub54c\ubcf4\ub2e4 \uc57d\uac04\uc758 \uac1c\uc120\uc774 \uc788\uc74c\uc744 \ubcf4\uc5ec\uc900\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uae30\ubcf8 S2-Attn \ubc29\ubc95\ub9cc \uc0ac\uc6a9\ud560 \ub54c\ub294 perplexity \uac00 9.09\ub85c, SF-Attn baseline \ubcf4\ub2e4 \ub192\uc544 \ucd94\uac00\uc801\uc778 \uac1c\uc120\uc774 \ud544\uc694\ud568\uc744 \ub098\ud0c0\ub0b8\ub2e4. \uc774\ub7ec\ud55c \uacb0\uacfc\ub294 SF-Attn \ubc29\ubc95\uc774 \ud6a8\uacfc\uc801\uc774\uc9c0\ub9cc, S&R algorithm \uacfc \uac19\uc740 \ucd94\uac00 \uae30\uc220\uacfc \uacb0\ud569\ud560 \ub54c perplexity \uc5d0\uc11c \uac1c\uc120\uc774 \uc774\ub8e8\uc5b4\uc9c4\ub2e4\ub294 \uac83\uc744 \uc2dc\uc0ac\ud55c\ub2e4.")),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 8",src:t(7961).Z,width:"2989",height:"1067"})),(0,s.kt)("p",null,'S&R algorithm \uc758 \uac1c\ubcc4 \uad6c\uc131 \uc694\uc18c\uc758 \uc601\ud5a5\uc744 \ubd84\uc11d\ud558\uae30 \uc704\ud55c \ucd94\uac00 ablation study \ub3c4 \uc218\ud589\ub418\uc5c8\ub2e4. Tab. 8\uc740 \uc774\ub7ec\ud55c \uc2e4\ud5d8\uc5d0 \ub300\ud55c perplexity \uacb0\uacfc\ub97c \uc81c\uacf5\ud55c\ub2e4. \uae30\ubcf8 S2-Attn \ubc29\ubc95\uc758 perplexity \ub294 9.09\uc774\ub2e4. \ubaa8\ub378\uc774 "shift up" \ub2e8\uacc4\ub9cc \uc801\uc6a9\ud560 \ub54c\ub294 perplexity \uac00 9.35\ub85c \uc99d\uac00\ud558\uba70, \uc774 \ub2e8\uacc4\ub9cc\uc73c\ub85c\ub294 \uc131\ub2a5 \ud5a5\uc0c1\uc774 \ubd80\uc871\ud568\uc744 \ub098\ud0c0\ub0b8\ub2e4. "shift back" \ub2e8\uacc4\ub9cc \uc801\uc6a9\ud588\uc744 \ub54c\ub294 perplexity \uac00 9.60345459\ub85c \ub098\ud0c0\ub098, \uc774 \ub2e8\uacc4\ub9cc\uc73c\ub85c\ub3c4 \uc131\ub2a5 \ud5a5\uc0c1\uc5d0 \ucda9\ubd84\ud558\uc9c0 \uc54a\uc74c\uc744 \ubcf4\uc778\ub2e4. \uc804\uccb4 Segmentation and Reassembly algorithm \uc744 \uc801\uc6a9\ud55c \uacbd\uc6b0\uc758 perplexity \ub294 8.86\uc73c\ub85c, \ub450 \uac1c\uc758 shifting \ub2e8\uacc4\ub97c \uacb0\ud569\ud588\uc744 \ub54c\uc758 \ud6a8\uacfc\ub97c \ubcf4\uc5ec\uc900\ub2e4. \uc774\ub7ec\ud55c ablation study \ub294 SF-Attn \ud6c8\ub828 \ubc29\ubc95\uc758 \uc131\ub2a5 \ud5a5\uc0c1\uc5d0 \uc788\uc5b4 S&R algorithm \uc758 \uc911\uc694\uc131\uc744 \uac15\uc870\ud55c\ub2e4. "shift up"\uacfc "shift back" \ub2e8\uacc4\ub97c \ud1b5\ud569\ud568\uc73c\ub85c\uc368 S&R algorithm \uc774 perplexity \ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc904\uc774\uace0 \ubaa8\ub378 \uc131\ub2a5\uc744 \uac1c\uc120\ud568\uc744 \ub098\ud0c0\ub0b8\ub2e4.'),(0,s.kt)("h4",{id:"ablation-on-sf-attn-varation"},"Ablation on SF-Attn Varation."),(0,s.kt)("p",null,"Sparse Fixed Attention (SF-Attn)\uacfc \uadf8 variants \uc5d0 \ud2b9\ud788 \ucd08\uc810\uc744 \ub9de\ucd98 \uc5f0\uad6c\ub3c4 \uc9c4\ud589\ub418\uc5c8\ub2e4. "),(0,s.kt)("p",null,"Fig. 7\uc740 Sparse Fixed Attention, Stride Attention, Random Attention \uc758 \ub2e4\uc591\ud55c attention patterns \ub97c \ubcf4\uc5ec\uc900\ub2e4."),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 7",src:t(25996).Z,width:"3131",height:"1702"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc774\ub4e4 variants \ub294 token sequence \uc804\uccb4\uc5d0 attention \uc744 \ubd84\uc0b0\uc2dc\ud0a4\ub294 \ub2e4\ub978 \uc804\ub7b5\uc744 \ub098\ud0c0\ub0b8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Sparse Fixed Attention \uc740 fixed sparse pattern \uc744 \uc0ac\uc6a9\ud558\uace0, Stride Attention \uc740 stride pattern \uc73c\ub85c attention \uc744 \ubd84\uc0b0\uc2dc\ud0a4\uba70, Random Attention \uc740 randomly attention \uc744 \ud560\ub2f9\ud55c\ub2e4.")),(0,s.kt)("p",null,"Tab. 9 \ub294 Llama2 7B \ubaa8\ub378\uc744 \ub2e4\uc591\ud55c target context length (4096, 6144, 8192)\ub85c fine-tuning \ud558\uace0 PG19 validation set \uc5d0\uc11c \ud3c9\uac00\ud55c \uacb0\uacfc\ub97c \uc81c\uc2dc\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc131\ub2a5\uc740 \ub2e4\uc591\ud55c attention \uba54\ucee4\ub2c8\uc998 \uc124\uc815\uc5d0 \ub530\ub77c \uce21\uc815\ub41c\ub2e4. "),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Table 9",src:t(58834).Z,width:"2989",height:"1193"})),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uc8fc\uc694 \uad00\ucc30 \uc0ac\ud56d\uc740 Full Attention (Full-Attn) \uc774 \uc77c\uad00\ub41c \uc131\ub2a5\uc744 \ubcf4\uc774\uc9c0\ub9cc computational costs \uac00 \ub9ce\uc774 \ub4e0\ub2e4\ub294 \uac83\uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"S\xb2-Attention (S\xb2-Attn) \uc740 Full Attention \ubcf4\ub2e4 \uc57d\uac04 \ub098\uc740 \uc131\ub2a5\uc744 \ubcf4\uc774\uba70, \ud2b9\ud788 long-context \uae38\uc774\uc5d0\uc11c \uadf8\ub807\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Sparse Fixed Attention \uc740 \uacbd\uc7c1\ub825 \uc788\ub294 \uc131\ub2a5\uc744 \uc720\uc9c0\ud558\uba70 \ub354 \ud6a8\uc728\uc801\uc774\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"Stride \uc640 Random Attention \ub3c4 \uc798 \uc218\ud589\ub418\uc9c0\ub9cc Sparse Fixed Attention \ubcf4\ub2e4\ub294 \uc57d\uac04 \ub0ae\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"SF-Attention \ubc29\ubc95\uc740 \uc774\ub7ec\ud55c \uc804\ub7b5 \uc694\uc18c\ub97c \uacb0\ud569\ud558\uc5ec \uac00\uc7a5 \ub0ae\uc740 perplexity score \ub97c \uae30\ub85d\ud558\uba70, long sequence \ub97c \ucc98\ub9ac\ud558\ub294 \ub370 \uac00\uc7a5 \ud6a8\uc728\uc801\uc774\uace0 \ud6a8\uacfc\uc801\uc778 \uc5b4\ud150\uc158 \uba54\ucee4\ub2c8\uc998\uc784\uc744 \ub098\ud0c0\ub0b8\ub2e4.")),(0,s.kt)("h1",{id:"5-discussion"},"5. Discussion"),(0,s.kt)("h2",{id:"51-the-failure-of-shift-operation"},"5.1 The Failure of Shift Operation"),(0,s.kt)("p",null,"Sparse Shift Attention \uc758 shift task \ub294 Swin Transformer \uc5d0\uc11c \uc601\uac10\uc744 \ubc1b\uc544 \uc11c\ub85c \ub2e4\ub978 token groups \uac04\uc758 information exchange \uc744 \ucd09\uc9c4\ud558\uace0\uc790 \ud55c\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 \uc774 \uc811\uadfc \ubc29\uc2dd\uc740  information leaking \ubb38\uc81c\ub97c \uc57c\uae30\ud560 \uc218 \uc788\ub2e4."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"information leaking \ubb38\uc81c\ub294 shift task \ub294 \uc11c\ub85c \ub2e4\ub978 segment \uc758 token \uc774 \ub108\ubb34 \uc790\uc720\ub86d\uac8c \uc815\ubcf4\ub97c \uacf5\uc720\ud558\uac8c \ub9cc\ub4e4\uae30 \ub54c\ubb38\uc5d0 \ubc1c\uc0dd\ud560 \uac00\ub2a5\uc131\uc774 \ub192\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ubaa8\ub378\uc774 sequence \uc758 \ub2e4\uc591\ud55c \ubd80\ubd84\uc5d0\uc11c \uc815\ubcf4\ub97c \ud1b5\ud569\ud560 \uc218 \uc788\ub3c4\ub85d \ud558\ub824\ub294 \uc758\ub3c4\uc640\ub294 \ub2ec\ub9ac, token \uc774 \ucc98\ub9ac\uc758 \ud2b9\uc815 \ub2e8\uacc4\uc5d0\uc11c \uc54c\uc544\uc11c\ub294 \uc548 \ub418\ub294 information \uc744 \uc0ac\uc804\uc5d0 \uc811\uadfc\ud558\uac8c \ub41c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc870\uae30 \ub178\ucd9c\uc740 model learning process \uc5d0 \ud63c\ub780\uc744 \uc8fc\uc5b4 over-fitting \ub610\ub294 incorrect associations \ub97c \ucd08\ub798\ud560 \uc218 \uc788\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, shift task \ub294 token groups \uac04\uc758 distinct boundaries \ub97c \ud750\ub9bf\ud558\uac8c \ub9cc\ub4e4 \uc218 \uc788\uc73c\uba70, \uc774\ub294 model \uc774 \uac01 group \ub0b4\uc758 \ud2b9\uc815 context \ub97c \uc720\uc9c0\ud558\ub294 \ub370 \uc5b4\ub824\uc6c0\uc744 \uacaa\uac8c \ud560 \uc218 \uc788\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774\ub85c \uc778\ud574 \ubaa8\ub378 \uc131\ub2a5\uc774 \uc800\ud558\ub420 \uc218 \uc788\uc73c\uba70, long sequence \ub97c \uc815\ud655\ud558\uac8c \ud574\uc11d\ud558\uace0 \uc0dd\uc131\ud558\ub294 \ub370 \ud544\uc694\ud55c local context \uc758 \uc77c\uad00\uc131\uc744 \uc720\uc9c0\ud558\uae30 \uc5b4\ub835\uac8c \ub41c\ub2e4.")))),(0,s.kt)("p",null,"\uc694\uc57d\ud558\uc790\uba74, shift task \ub294 information exchange \uc744 \uac1c\uc120\ud558\ub824\ub294 \ubaa9\uc801\uc744 \uac00\uc9c0\uace0 \uc788\uc9c0\ub9cc, token \uc774 \uc11c\ub85c \ub2e4\ub978 segment \uc5d0\uc11c information \uc744 \uc870\uae30\uc5d0 \uc811\uadfc\ud558\uace0 \ud1b5\ud569\ud558\uac8c \ud568\uc73c\ub85c\uc368 information leaking \uc744 \ucd08\ub798\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774\ub294 \ubaa8\ub378\uc774 distinct contextual boundaries \ub97c \uc720\uc9c0\ud558\ub294 \ub2a5\ub825\uc744 \uc800\ud574\ud558\uba70, precise contextual understanding \uc774 \ud544\uc694\ud55c task \uc5d0\uc11c \uc131\ub2a5\uc5d0 \ubd80\uc815\uc801\uc778 \uc601\ud5a5\uc744 \ubbf8\uce60 \uc218 \uc788\ub2e4."),(0,s.kt)("h2",{id:"52-the-success-of-making-sink-attention-tokens-globally-operative"},"5.2 The Success of Making Sink Attention Tokens Globally Operative"),(0,s.kt)("p",null,"\ub2e4\uc74c \uc139\uc158\uc5d0\uc11c\ub294 globally operative sink attention tokens \uc758 \uc131\uacf5\uc801\uc778 \uad6c\ud604 \ubc29\ubc95\uc5d0 \ub300\ud574 \uc124\uba85\ud558\uba70, model \uc774 long sequence \ub97c \ud6a8\uc728\uc801\uc73c\ub85c \ucc98\ub9ac\ud560 \uc218 \uc788\ub294 \ub2a5\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a8\ub2e4. "),(0,s.kt)("p",null,"sink attention token \uc758 \uc131\uacf5\uc801\uc778 \uad6c\ud604\uc740 \uba87 \uac00\uc9c0 \uc8fc\uc694 \uc694\uc18c\uc5d0 \uae30\uc778\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"\uba3c\uc800, sequence \uc758 all other tokens \uc5d0 attending \ud560 specific tokens \ub97c \uc9c0\uc815\ud568\uc73c\ub85c\uc368 model \uc740 \uc804\uccb4 sequence \uc5d0\uc11c information \ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \ud3ec\ucc29\ud558\uace0 \ud1b5\ud569\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 global attention \uba54\ucee4\ub2c8\uc998\uc740 very long sequence \uc5d0\uc11c\ub3c4 critical information \uc774 \uc190\uc2e4\ub418\uc9c0 \uc54a\ub3c4\ub85d \ubcf4\uc7a5\ud55c\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c, sequence \uc758 all tokens \uac00 sink attention token \uc5d0 attending \ud568\uc73c\ub85c\uc368 model \uc740 sequence context \uc5d0 \ub300\ud55c \uc77c\uad00\ub41c \uc774\ud574\ub97c \uc720\uc9c0\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774\ub7ec\ud55c bidirectional attention flow \ub294 model \uc774 \uc5ec\ub7ec \ub2e8\uacc4\uc5d0\uc11c important information \ub97c \uac15\ud654\ud560 \uc218 \uc788\ub3c4\ub85d \ud558\uc5ec \uc804\ubc18\uc801\uc778 \uc774\ud574\uc640 context \uc720\uc9c0 \ub2a5\ub825\uc744 \ud5a5\uc0c1\uc2dc\ud0a8\ub2e4.")),(0,s.kt)("p",null,"\uc774 \ubc29\ubc95\uc744 \ud1b5\ud574 \ub2ec\uc131\ub41c ",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("mi",{parentName:"mrow"},"O"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},"("),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mi",{parentName:"mrow"},"log"),(0,s.kt)("mo",{parentName:"mrow"},"\u2061"),(0,s.kt)("mi",{parentName:"mrow"},"n"),(0,s.kt)("mo",{parentName:"mrow",stretchy:"false"},")")),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"O(n \\log n)")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal",style:{marginRight:"0.02778em"}},"O"),(0,s.kt)("span",{parentName:"span",className:"mopen"},"("),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mop"},"lo",(0,s.kt)("span",{parentName:"span",style:{marginRight:"0.01389em"}},"g")),(0,s.kt)("span",{parentName:"span",className:"mspace",style:{marginRight:"0.1667em"}}),(0,s.kt)("span",{parentName:"span",className:"mord mathnormal"},"n"),(0,s.kt)("span",{parentName:"span",className:"mclose"},")")))))," \uc758 efficient complexity \ub294 \uc0c1\ub300\uc801\uc73c\ub85c \uc801\uc740 \uc218\uc758 sink attention token \uc73c\ub85c \uc778\ud574 \uc774 \uac15\ud654\ub41c \ub2a5\ub825\uc774 \uc0c1\ub2f9\ud55c computational overhead \uc99d\uac00 \uc5c6\uc774 \uc774\ub8e8\uc5b4\uc9c4\ub2e4\ub294 \uac83\uc744 \ubcf4\uc7a5\ud55c\ub2e4. "),(0,s.kt)("p",null,"\ud3ec\uad04\uc801\uc778 attention \uc744 \uc720\uc9c0\ud558\uba74\uc11c computational efficiency \uc744 \ud655\ubcf4\ud558\ub294 \uc774 balance \ub294 \uc774 \uae30\uc220\uc744 \uc0ac\uc6a9\ud558\ub294 \ubaa8\ub378\uc5d0\uc11c \uac1c\uc120\ub41c \uc131\ub2a5\uc758 \uc8fc\uc694 \uc694\uc18c\uc77c \uac00\ub2a5\uc131\uc774 \ub192\ub2e4."),(0,s.kt)("p",null,"\uc694\uc57d\ud558\uc790\uba74, global sink attention token \uc758 \uad6c\ud604\uc740 \ubaa8\ub378\uc774 long sequence \uc5d0 \ub300\ud55c \uac15\ub825\ud558\uace0 \uc77c\uad00\ub41c \uc774\ud574\ub97c \uc720\uc9c0\ud558\ub3c4\ub85d \ud558\uba70, \ucc98\ub9ac \ub2e8\uacc4 \uc804\ubc18\uc5d0 \uac78\uccd0 critical information \uc774 attending \ud558\ub3c4\ub85d \ubcf4\uc7a5\ud568\uc73c\ub85c\uc368 \uad11\ubc94\uc704\ud55c context understanding \uc774 \ud544\uc694\ud55c task \uc5d0\uc11c \uc131\ub2a5\uc744 \ud5a5\uc0c1\uc2dc\ud0a8\ub2e4."),(0,s.kt)("h2",{id:"53-the-convenience-of-applying-kv-cache-compression-function"},"5.3 The Convenience of Applying KV Cache Compression Function"),(0,s.kt)("p",null,"H",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O inference test \uacb0\uacfc\uc5d0\uc11c \ubcf4\uc5ec\uc9c0\ub4ef\uc774, H",(0,s.kt)("span",{parentName:"p",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O \ubc29\ubc95\uc740 KV cache \uc608\uc0b0\uc774 \uc808\ubc18\uc73c\ub85c \uc904\uc5b4\ub4e4\uc5b4\ub3c4 \uc815\ud655\ub3c4\ub97c \uc720\uc9c0\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uadf8\ub7ec\ub098 \uc774 \ubc29\ubc95\uc744 \ud1b5\ud574 \uc5bb\uc740 time savings \uc740 \uc0c1\ub2f9\ud558\uba70, inference time \uc744 1.5\ubc30 \uc904\uc77c \uc218 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uc774 \uae30\ub2a5\uc740 \uc0ac\uc6a9 \uac00\ub2a5\ud55c computing resource \uc5d0 \ub530\ub77c inference \ubc29\ubc95\uc744 \uc720\uc5f0\ud558\uac8c \ubc30\ud3ec\ud560 \uc218 \uc788\uac8c \ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc815\ud655\ub3c4\ub97c \uc190\uc0c1\uc2dc\ud0a4\uc9c0 \uc54a\uace0 KV cache \uc608\uc0b0\uc744 \uc870\uc815\ud560 \uc218 \uc788\ub294 \ub2a5\ub825\uc740 large language model \uc744 \uc790\uc6d0\uc774 \uc81c\ud55c\ub41c \ud658\uacbd\uc5d0\uc11c\ub3c4 \ud6a8\uc728\uc801\uc774\uace0 \ud6a8\uacfc\uc801\uc73c\ub85c \ud65c\uc6a9\ud560 \uc218 \uc788\uac8c \ud558\uba70, \uc131\ub2a5\uacfc computational efficiency \uc744 \ubaa8\ub450 \ucd5c\uc801\ud654\ud55c\ub2e4."),(0,s.kt)("h2",{id:"54-the-good-result-of-chatbot"},"5.4 The Good Result of Chatbot"),(0,s.kt)("p",null,(0,s.kt)("img",{alt:"Figure 9",src:t(27060).Z,width:"850",height:"1128"})),(0,s.kt)("p",null,"Fig. 9 \uc758 chat ability \ube44\uad50 \uc608\uc81c\uc5d0\uc11c, \ub450 \uac00\uc9c0 \ubc84\uc804\uc758 LongLoRA \ubaa8\ub378\uc774 \uc774\uc57c\uae30\uc640 \uad00\ub828\ub41c question-answering \uc744 \uad00\ucc30\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("p",null,'\uc0ac\uc6a9\uc790\uc758 \uc785\ub825\uc740 \uc5ec\ub7ec \ubc88\uc758 \uc2e4\ud328 \ud6c4, \ubb3c\uace0\uae30\ub97c \ucc3e\uae30 \uc704\ud574 "Blue Deep" \uc774\ub77c\uace0 \uc54c\ub824\uc9c4 \uc7a5\uc18c\ub85c \ub354 \uba40\ub9ac \ub098\uac04 \ub178\uc778 \uc5b4\ubd80 Tom \uc5d0 \uad00\ud55c \uc774\uc57c\uae30\uc774\ub2e4. '),(0,s.kt)("p",null,"\uc9c8\ubb38\uc740 Tom \uc774 \uc65c \uadf8\ub3d9\uc548 \ud55c \ubc88\ub3c4 \uac00\ubcf8 \uc801\uc774 \uc5c6\ub294 \ubc14\ub2e4\ub85c \ub354 \uba40\ub9ac \ub098\uac00\uae30\ub85c \uacb0\uc2ec\ud588\ub294\uc9c0 \ubb3b\ub294\ub2e4."),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"LongLoRA-7B \ubaa8\ub378\uc758 \uc751\ub2f5\uc740 Tom \uc758 \uc808\ub9dd\uac10\uacfc \ubb3c\uace0\uae30\ub97c \uc7a1\uc9c0 \ubabb\ud55c \uac71\uc815\uc744 \uc911\uc2ec\uc73c\ub85c, \ube48 \uadf8\ubb3c\uacfc \uac00\uc871\uc744 \ubd80\uc591\ud558\ub824\ub294 \uacb0\uc2ec\uc744 \uac15\uc870\ud55c\ub2e4. ",(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc751\ub2f5\uc740 \uc11c\uc0ac\uc5d0\uc11c \uc124\uba85\ub41c Tom \uc758 \ub3d9\uae30 \uc8fc\uc694 \uc694\uc18c\ub97c \uc815\ud655\ud558\uac8c \ud3ec\ucc29\ud55c\ub2e4."))),(0,s.kt)("li",{parentName:"ul"},'\ubc18\uba74 SinkLoRA-7B model \uc740 \ubb3c\uace0\uae30\uc758 \uc7a5\uae30\uac04 \uc0ac\ub77c\uc9c4 \uc0c1\ud669\uacfc Tom \uc774 "Blue Deep" \uc73c\ub85c \ubaa8\ud5d8\uc744 \ub5a0\ub098\uae30\ub85c \ud55c \uacb0\uc815\uc5d0 \ub300\ud574 \ub354 \uc790\uc138\ud55c \uc124\uba85\uc744 \uc81c\uacf5\ud55c\ub2e4. ',(0,s.kt)("ul",{parentName:"li"},(0,s.kt)("li",{parentName:"ul"},"\ub610\ud55c Tom \uc774 \uadf8\uacf3\uc5d0\uc11c \ubb3c\uace0\uae30\ub97c \ucc3e\uc744 \ud76c\ub9dd\uc744 \uc5b8\uae09\ud558\uba70, \uadf8\uc758 \ub3d9\uae30\uc5d0 \ub300\ud55c \ubcf4\ub2e4 \ud3ec\uad04\uc801\uc778 \uc774\ud574\ub97c \uc81c\uacf5\ud55c\ub2e4.")))),(0,s.kt)("p",null,"answering details \uacfc context \uc758 \ucc28\uc774\ub294 two models \uac04\uc758 training \ubc0f fine-tuning \ucc28\uc774\uc5d0\uc11c \uae30\uc778\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("p",null,"SinkLoRA-7B model \uc740 \ub354 \ub2e4\uc591\ud55c dataset \uc5d0\uc11c \ud6c8\ub828\ub418\uc5c8\uac70\ub098 additional fine-tuning \uc744 \ud1b5\ud574 \ubb38\ub9e5\uc801\uc73c\ub85c \ud48d\ubd80\ud55c \uc751\ub2f5\uc744 \uc0dd\uc131\ud558\ub294 \ub370 \ub354 \ub098\uc740 \uc774\ud574\ub97c \uac16\ucd94\uc5c8\uc744 \uc218 \uc788\ub2e4. "),(0,s.kt)("p",null,"\uc774 additional training \uc774 \ubaa8\ub378\uc774 \ub354 \uc138\ubc00\ud558\uace0 \uc790\uc138\ud55c \ub2f5\ubcc0\uc744 \uc81c\uacf5\ud560 \uc218 \uc788\uac8c \ud558\uc5ec, \uc11c\uc0ac\uc758 \ubbf8\uc138\ud55c \ucc28\uc774\ub97c \ub354 \ud6a8\uacfc\uc801\uc73c\ub85c \ud3ec\ucc29\ud560 \uc218 \uc788\uac8c \ud55c\ub2e4."),(0,s.kt)("p",null,"\uacb0\ub860\uc801\uc73c\ub85c, two models \ubaa8\ub450 Tom \uc758 \uc8fc\uc694 \ub3d9\uae30\ub97c \uc131\uacf5\uc801\uc73c\ub85c \uc2dd\ubcc4\ud558\uc9c0\ub9cc, SinkLoRA-7B model \uc740 \ub354 \ucca0\uc800\ud558\uace0 \ubb38\ub9e5\uc801\uc73c\ub85c \ud48d\ubd80\ud55c \uc124\uba85\uc744 \uc81c\uacf5\ud55c\ub2e4. "),(0,s.kt)("p",null,"\uc774 \ube44\uad50\ub294 narrative-based questions \ub97c \uc774\ud574\ud558\uace0 \uc815\ud655\ud558\uac8c \uc751\ub2f5\ud558\ub294 \ucc57 \uae30\ub2a5\uc758 \ud6a8\uacfc\uc131\uc744 \uac15\uc870\ud558\uba70, \ubaa8\ub378 \uc131\ub2a5\uacfc \uc751\ub2f5 \ud488\uc9c8 \ud5a5\uc0c1\uc5d0 \uc788\uc5b4 \uad11\ubc94\uc704\ud55c \ud6c8\ub828\uacfc fine-tuning \uc758 \uc911\uc694\uc131\uc744 \uac15\uc870\ud55c\ub2e4."),(0,s.kt)("h1",{id:"6-conclusion-and-future-work"},"6 Conclusion and Future Work"),(0,s.kt)("p",null,"\uc774 \uc5f0\uad6c\uc5d0\uc11c\ub294 SinkLoRA \ub97c \uc18c\uac1c\ud558\uc600\ub2e4. "),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"SinkLoRA \ub294 original LongLoRA \uc5d0 \ub300\ud55c \uc911\uc694\ud55c \uac1c\uc120\uc73c\ub85c, long-context sequence \ub97c \ucc98\ub9ac\ud558\ub294 large language model(LLM)\uc758 \ud6a8\uc728\uc131\uacfc \uc131\ub2a5\uc744 \ud5a5\uc0c1\uc2dc\ud0a4\uae30 \uc704\ud574 \uc124\uacc4\ub418\uc5c8\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"SinkLoRA \ub294 \uc774\uc804 \ubaa8\ub378\uc758 \ud55c\uacc4\ub97c \ud574\uacb0\ud558\uae30 \uc704\ud574 Sink Fixed Attention (SF-Attn)\uacfc Heavy-Hitter Oracle (H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O) \uac19\uc740 advanced KV cache compression \uae30\uc220\uc744 \uad6c\ud604\ud558\uc600\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc81c\uc548\ub41c SF-Attn \ubc29\ubc95\uc740 attention scores \ub97c \ud6a8\uacfc\uc801\uc73c\ub85c \uc7ac\ubd84\ubc30\ud558\uc5ec initial tokens \uc5d0 \ub300\ud55c \uacfc\ub3c4\ud55c \uac15\uc870\ub97c \uc904\uc774\uace0 \uc804\uccb4 \ubaa8\ub378 \uc815\ud655\ub3c4\ub97c \uac1c\uc120\ud55c\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"\uc774 \uc811\uadfc\ubc95\uc740 Segmentation and Reassembly algorithm \uacfc \uacb0\ud569\ub418\uc5b4 computational complexity \ub97c \uc99d\uac00\uc2dc\ud0a4\uc9c0 \uc54a\uace0\ub3c4 extended context \ub97c \ub354 \uc798 \ucc98\ub9ac\ud560 \uc218 \uc788\ub2e4. "),(0,s.kt)("li",{parentName:"ul"},"H",(0,s.kt)("span",{parentName:"li",className:"math math-inline"},(0,s.kt)("span",{parentName:"span",className:"katex"},(0,s.kt)("span",{parentName:"span",className:"katex-mathml"},(0,s.kt)("math",{parentName:"span",xmlns:"http://www.w3.org/1998/Math/MathML"},(0,s.kt)("semantics",{parentName:"math"},(0,s.kt)("mrow",{parentName:"semantics"},(0,s.kt)("msub",{parentName:"mrow"},(0,s.kt)("mrow",{parentName:"msub"}),(0,s.kt)("mn",{parentName:"msub"},"2"))),(0,s.kt)("annotation",{parentName:"semantics",encoding:"application/x-tex"},"_2")))),(0,s.kt)("span",{parentName:"span",className:"katex-html","aria-hidden":"true"},(0,s.kt)("span",{parentName:"span",className:"base"},(0,s.kt)("span",{parentName:"span",className:"strut",style:{height:"0.4511em",verticalAlign:"-0.15em"}}),(0,s.kt)("span",{parentName:"span",className:"mord"},(0,s.kt)("span",{parentName:"span"}),(0,s.kt)("span",{parentName:"span",className:"msupsub"},(0,s.kt)("span",{parentName:"span",className:"vlist-t vlist-t2"},(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.3011em"}},(0,s.kt)("span",{parentName:"span",style:{top:"-2.55em",marginRight:"0.05em"}},(0,s.kt)("span",{parentName:"span",className:"pstrut",style:{height:"2.7em"}}),(0,s.kt)("span",{parentName:"span",className:"sizing reset-size6 size3 mtight"},(0,s.kt)("span",{parentName:"span",className:"mord mtight"},"2")))),(0,s.kt)("span",{parentName:"span",className:"vlist-s"},"\u200b")),(0,s.kt)("span",{parentName:"span",className:"vlist-r"},(0,s.kt)("span",{parentName:"span",className:"vlist",style:{height:"0.15em"}},(0,s.kt)("span",{parentName:"span"})))))))))),"O KV cache compression \uc758 \ud1b5\ud569\uc740 inference \ub97c \uac00\uc18d\ud654\ud558\uc5ec SinkLoRA \ub97c \uc790\uc6d0\uc774 \uc81c\ud55c\ub41c \ud658\uacbd\uc5d0\uc11c LLM \uc744 \ubc30\ud3ec\ud558\ub294 \ub370 \ub9e4\uc6b0 \ud6a8\uc728\uc801\uc778 \uc194\ub8e8\uc158\uc73c\ub85c \ub9cc\ub4e0\ub2e4.")))}k.isMDXComponent=!0},19016:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-55-54790fd57d7a221ec15b64e01580836c.png"},99027:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-56-002cefb6c534f00fa4bb6caecd38888b.png"},82361:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-57-7c6b3fbd930e00757b6831a24ec4d47d.png"},66625:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-58-d35ce58aa7b47d6ea3b62e226a567691.png"},76129:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-59-4d184154724d3756b7f324409ae1e89b.png"},29317:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-60-2826592031c5edd4d76e670cc2b91573.png"},59329:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-61-fe2845f2c87b072a65366d5bc041e875.png"},95416:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-62-e31f69338c952df211ff6342fe0c1ea3.png"},3010:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-63-6bc0120a594fd7b5a5434ab2ae7acfcb.png"},13432:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-64-28182d2d8143fc49237eaec6993ce5e0.png"},51071:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-65-c62c9a49022145c1e9754828673a7aa2.png"},58731:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-66-b825cf77cd8bc7fc5e74f47b026deffc.png"},80048:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-67-3e4b13e3386fd5b9f82d3c1f125efc66.png"},7961:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-68-3dc745f15f8cadf40c11f5c1bc7fa4cf.png"},58834:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-69-bddea62f842f1900442eeb0dc8ce3f57.png"},25996:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-70-0ec2a4ba5f27420585e37545b0b1bfe1.png"},27060:(a,e,t)=>{t.d(e,{Z:()=>n});const n=t.p+"assets/images/image-71-f4b3606261ebafc6513ef8898ca78c88.png"}}]);