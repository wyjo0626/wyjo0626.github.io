<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/2024-04-TVP">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Exploring the Transferability of Visual Prompting for Multimodal Large Language Models | WYJLab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/TVP"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Exploring the Transferability of Visual Prompting for Multimodal Large Language Models | WYJLab"><meta data-rh="true" name="description" content="논문 및 이미지 출처 :"><meta data-rh="true" property="og:description" content="논문 및 이미지 출처 :"><link data-rh="true" rel="icon" href="/img/WYJLab.ico"><link data-rh="true" rel="canonical" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/TVP"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/TVP" hreflang="en"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/TVP" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="WYJLab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="WYJLab Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9ed678b7.css">
<link rel="preload" href="/assets/js/runtime~main.abd6514d.js" as="script">
<link rel="preload" href="/assets/js/main.b2b09391.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/WYJLab.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/WYJLab.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WYJLab</b></a><a class="navbar__item navbar__link" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Paper</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Computer Vision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Machine Learning/Regularization/Dropout/Dropout">Machine Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/NLP/Analysis/Contextualized Representation">NLP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Survey/Prompting">Survey</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">Vision-Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">CLIP</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">Few-shot</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">Composition</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Module/CLIP-Adapter">Module</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Multi-Modality/MaPLe">Multi-Modality</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/CMAR">Prompting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/CMAR">Pixel-Level</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/CMAR">Cross-modal Adversarial Reprogramming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/VP">Exploring Visual Prompts for Adapting Large-Scale Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/Watermarking">Watermarking for Out-of-distribution Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/ILM-VP">Understanding and Improving Visual Prompting: A Label-Mapping Perspective</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP">Unleashing the Power of Visual Prompting At the Pixel Level</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/DAM-VP">Diversity-Aware Meta Visual Prompting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP-L">Explicit Visual Prompting for Low-Level Structure Segmentations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/HinTAug">Hint-Aug: Drawing Hints from Foundation Vision Transformers towards Boosted Few-shot Parameter-Efficient Tuning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/AutoVP">AutoVP: An Automated Visual Prompting Framework and Benchmark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/A2XP">A2XP: Towards Private Domain Generalization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/InMeMo">Instruct Me More! Random Prompting for Visual In-Context Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/LaViP">LaViP: Language-Grounded Visual Prompts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/AdaViPro">AdaViPro: Region-Based Adaptive Visual Prompt For Large-Scale Models Adapting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/TVP">Exploring the Transferability of Visual Prompting for Multimodal Large Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/SMM">Sample-specific Masks for Visual Reprogramming-based Prompting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Textual-Token/CoOp">Textual-Token</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Visual-Token/VPT">Visual-Token</a></div></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Foundation/Contrastive Learning/ALIGN">Foundation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/VQA Few-shot">VQA-IC</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Programming/Algorithm/">Programming</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Paper</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Vision-Language</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">CLIP</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Few-shot</span><meta itemprop="position" content="4"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Prompting</span><meta itemprop="position" content="5"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Pixel-Level</span><meta itemprop="position" content="6"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Exploring the Transferability of Visual Prompting for Multimodal Large Language Models</span><meta itemprop="position" content="7"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Exploring the Transferability of Visual Prompting for Multimodal Large Language Models</h1></header><p>논문 및 이미지 출처 : <a href="https://openaccess.thecvf.com/content/CVPR2024/papers/Zhang_Exploring_the_Transferability_of_Visual_Prompting_for_Multimodal_Large_Language_CVPR_2024_paper.pdf" target="_blank" rel="noopener noreferrer">https://openaccess.thecvf.com/content/CVPR2024/papers/Zhang_Exploring_the_Transferability_of_Visual_Prompting_for_Multimodal_Large_Language_CVPR_2024_paper.pdf</a></p><h1>Abstract</h1><p>MultiModal Large Language Models(MLLMs)이 유망한 다재다능한 능력을 보여주었지만, 여전히 downstream task 에선 specialized model 보다 성능이 떨어져 그 유용성을 향상시키기 위해 adaptation 이 필요하다.</p><p>그러나 fine-tuning 방법은 각 model 마다 independent training 을 요구하여 huge computation 및 memory overhead 를 초래한다.</p><p>본 논문에서는 downstream task 를 위해 optimized shared parameters group 을 사용하여 다양한 MLLMs 의 성능을 향상시키는 novel setting 을 제안한다.</p><p>이를 달성하기 위해, Transferable Visual Prompting (TVP)를 제안</p><p><img loading="lazy" alt="Figure 1" src="/assets/images/image-106-bc6ae0e649b87fb2b36a80e1d217ddd4.png" width="678" height="834" class="img_ev3q"></p><ul><li>이는 one model 에만 훈련된 후, 다양한 model 로 transfer 이 가능한 visual prompts 를 생성하여 downstream task 의 성능을 향상시키고 간단하고 효과적인 접근법 (Fig. 1)</li><li>기존의 visual prompt 의 cross-model feature corruption 을 해결하고 learned prompts 의 transferability 향상을 위해 두 가지 전략을 도입.<ol><li>Feature Consistency Alignment : task-agnostic knowledge 를 유지하기 위해 prompted feature changes 에 제약을 가하는 방법</li><li>Task Semantics Enrichment : language guidance 를 통해 prompted image 가 richer task-specific semantics 를 포함하도록 장려하는 방법</li></ol></li><li>저자는 object recognition 및 counting 부터 multimodal reasoning 및 hallucination correction 까지 다양한 task 에서 6 SOTA MLLMs 를 사용하여 광범위한 실험 수행으로 TVP 의 효과 검증</li></ul><h1>1. Introduction</h1><p>Large Language Models (LLMs)의 성공은 multimodal tasks 를 해결하는 능력을 탐구하도록 연구자들을 자극했다.</p><p>visual input 을 text embedding 과 조화롭게 결합하여 다루는 다양한 방법들이 개발되었고, 이를 통해 다양한 task 에서 뛰어난 성능을 발휘하는 Multimodal Large Language Models (MLLMs)가 탄생했다.</p><p>이러한 models 는 image understanding 및 reasoning 에서 주목할 만한 성과를 거두며, 여러 task 의 &quot;foundation model&quot; 로서 기능하다.</p><p>그러나 이런 우수한 generalization performance 에도 불구하고, 기존의 MLLMs 는 종종 specialized SOTA 에 비해 성능이 떨어진다. (e.g., image classification 같은 downstream task 의 zero-shot 평가).</p><p>이는 MLLMs 가 주로 massive data 으로 pre-training 되고, small modality alignment 및 instruction data 로 fine-tuning 되기 때문이다.</p><p>따라서 사용자가 MLLMs 를 downstream task 에 활용할 때 그 성능이 만족스럽지 않을 수 있는 gap 을 좁히고 task-specific 에 대한 MLLMs 의 유효성을 향상시킬 수 있는 효과적이고 효율적인 전략을 개발하는 것이 필수적이다.</p><p>MLLMs 를 downstream task 에 adapting 하기 위해 전통적으로는 task-specific data 에 fine-tuning 이 필요하다. 이는 과학 및 생명과학 분야에서 효과적이지만, billions parameters 를 가진 모델에게는 computationally demanding 및 storage-intensive 가 문제가 된다.</p><p>이러한 문제를 해결하기 위해, Adapters, LoRA, prompt tuning 을 포함한 다양한 parameter-efficient fine-tuining (PEFT) 기법이 제안되었다. 이들 방법은 downstream task 를 위해 model-specific parameter 의 gradient-based optimization 을 수행한다.</p><p>그러나 이러한 방법들은 optimizing 을 위해 방대한 memory 가 필요하며, 결과적으로 얻어진 parameter 는 다른 models 간의 generalization 능력이 부족하다.</p><p>실제 상황에서 PEFT 에 대한 prior knowledge 가 없고 limited computation resource 를 가진 사용자들은 추가적인 fine-tuning 없이도 자신의 model 을 개선할 수 있는 auxiliary parameters (e.g., prompt)를 선호할 것이다.</p><p>이로 인해 저자는 한 개 또는 소수의 model 에만 optimizing 하면서 동일한 task 에 대한 여러 MLLMs 에 이익을 줄 수 있는 <em>shnared parameters</em> set 을 개발하는 것을 목표로 한다.</p><p>이 방법은 resource-friendly 및 flexible 하며, model weight 접근 없이 다양한 model 을 task 에 맞게 adapting 을 쉽게 만들 수 있다.</p><p>또한, 이는 &quot;Prompt as a Service&quot; (PaaS) 패러다임과 일치한다. 여기서 사용자는 PaaS 제공업체에게 downstream task 에 대한 prompt 를 요청할 수 있으며, 동시에 local model confidential 을 유지할 수 있다.</p><hr><p>MLLMs 가 image 를 input 으로 취급하기 때문에, image pixel space 는 parameter learning 에 유망한 shared space 이다.</p><p>이전 방법들은 Visual Prompting (VP) 를 사용하여 pre-trained model 을 downstream task 에 adapting 하기 위해 image 주변의 pixel space 에서 parameter 를 학습했다.</p><p>VP 의 transferability 에 영감을 받아, 저자는 다른 models 의 성능을 향상시키기 위해 learned visual prompts 를 transfering 하는 것을 가능한 solution 으로 삼고 있다.</p><p>그러나 다른 models 를 위해 learned visual prompt 의 transferability 는 아직 연구되지 않은 상태이다.</p><p>저자는 VP 가 prompt training 에 사용된 model 의 성능을 효과적으로 향상시킬 수 있지만, 다른 models 에 대해서는 성능 향상이 제한적이거나 크게 저하될 수 있음을 발견했다.</p><p>이는 learned prompt 가 이들의 training 을 위해 visual features 에 상당한 변화를 일으키고, <em>cross-model feature corruption</em> 으로 정의되기 때문이다.</p><p>이는 transfer 될 때 model 의 성능에 부정적인 영향을 미치며, large-scale pre-training 으로 얻은 plenty knowledge 를 다른 models 로 transfer 하는데 장애물이 된다.</p><p>본 논문에선 <strong>Transferable Visual Prompting (TVP)</strong> 을 제안하여 MLLMs 간 visual prompt 의 transferability 를 향상시키고 이러한 models 를 동시에 개선하는 것을 목표로 한다.</p><p>이를 위해, 저자는 다양한 task 에 대해 MLLMs 에 대한 VP 의 unified framework 를 정립합니다.</p><p>저자는 두 가지 주요 전략을 제안하여 general knowledge 와 task-specific representation 을 강화한다.</p><ol><li>저자는 <strong>Feature Consistency Alignment (FCA)</strong> 를 제안하여 transferability 를 크게 억제하는 feature corruption 문제를 완화한다.<ul><li>FCA 는 prompt 적용 후 visual feature 에 제약을 가하며, essential inner knowledge 를 보존합니다.</li><li>결과적으로, 이는 model 이 개선을 위해 task-agnostic representation 을 더 잘 유지하고 활용할 수 있도록 돕는다.</li></ul></li><li>저자는 <strong>Task Semantics Enrichment (TSE)</strong> 을 도입하여 visual prompt 에 task information 을 명시적으로 더욱 embed 한다<ul><li>CLIP 을 활용해 TSE 는 prompted image 가 specific task 에 맞춘 text features 와 semantic similarity 를 나타내도록 유도</li><li>이는 단순히 task-specific objectives 를 사용하는 end-to-end learning 이 아니라, model 이 더 나은 shareable task-specific semantics 를 추출하고 target task 에서 개선될 수 있도록 한다.</li></ul></li></ol><p>저자는 TVP 의 성능을 충분한 실험을 통해 평가한다.</p><ul><li>one single model 로 훈련된 visual prompt 는 recognition 및 counting 같은 visual task 부터 multimodal reasoning 및 hallucination correction 에 이르는 10 dataset 에서 6 SOTA MLLM 의 전반적인 성능을 향상시킬 수 있으며, 이는 기존의 visual prompt-based method 를 크게 초월한다.</li><li>model ensembling 을 통해 성능이 더욱 향상된다.</li><li>저자는 TVP 가 다양한 data scale 에서 서로 다른 model 을 향상시키고, 다른 dataset 에 generalization 되며, image corruption 에 견딜 수 있음을 보여주며,, 실제 시나리오에서 저자의 방법의 실용성을 강조한다.</li><li>기존 fine-tuning 과 비교를 통해, shared parameter 로 여러 model 을 개선하는 가능성과 TVP 의 효과성 제시</li></ul><h1>2. Related Works</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="21-multimodal-large-language-models">2.1. Multimodal Large Language Models<a href="#21-multimodal-large-language-models" class="hash-link" aria-label="Direct link to 2.1. Multimodal Large Language Models" title="Direct link to 2.1. Multimodal Large Language Models">​</a></h2><p>language-centric tasks 를 위한 LLMs 의 중요한 발전은 다양한 multimodal contexts 에서 잠재적 응용을 탐구하게 했다.</p><p>이런 활용은 주로 modality alignment 와 instruction tuning 에 중점을 둔 연구에서 나타난다.</p><p>이들 model 은 MLLMs 의 foundation 을 마련했으며, 이후 많은 후속 연구들이 in-context learning, efficient training, richer modalities 등과 관련된 성능 개선을 목표로 제안되었다.</p><p>여러 benchmark test 에서 MLLMs 이 visual recognition 및 understanding 에서 versatile capabilities 를 보이는 것으로 나타났지만, specific task 에선 specialized model 에 비해 성능이 부족하여 특정 시나리오에서의 적용이 제한된다.</p><p>게다가, MLLMs 는 안전성과 신뢰성 관련 문제, 예로 value alignment 및 hallucination 문제에 직면하고 있으며, 이러한 문제를 해결하기 위해 추가적인 tuning 이 필요하다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="22-adaptation-for-large-scale-pre-trained-models">2.2. Adaptation for Large-Scale Pre-trained Models<a href="#22-adaptation-for-large-scale-pre-trained-models" class="hash-link" aria-label="Direct link to 2.2. Adaptation for Large-Scale Pre-trained Models" title="Direct link to 2.2. Adaptation for Large-Scale Pre-trained Models">​</a></h2><p>adapting MLLMs 은 주로 large-scale models (e.g., LLMs , CLIP) 에 대한 방법을 따른다.</p><p>downstream task 에 대한 fine-tuning 은 직관적이지만, computation 및 storage cost 가 많이 든다.</p><p>Adapters, LoRA, prompt tuning 와 같은 parameter-efficient fine-tuning 방법이 이러한 문제를 완화하기 위해 등장했다.</p><p>최근의 고급 연구들은 routing 과 skipping 을 통해 효율적인 modality bridging 및 adaptation 에 중점을 두고 있다.</p><p>그러나 이런 방법들은 본질적으로 model-specific 이며, multiple models 의 resource-friendly 및 flexible manner 로 apdating 하기 위해 single parameters set 을 optimizing 하는 것이 저자의 목표와는 다르다.</p><p>Visual Prompting 의 최근 발전은 adversarial reprogramming 에 영감을 받아, image 의 pixel space 에서 learnable perturbations 를 도입함으로써 model adaptation 을 위한 유망한 솔루션을 제공한다.</p><p>pixel space 는 다양한 모델에 대해 공유되는 domain 이므로, parameter tuning 을 위한 자연스러운 선택이 된다.</p><p>많은 후속 연구들은 성능 개선 과 data generalization 같은 주제를 탐구했지만, visual prompt 의 model 간 generalization 이나, adversarial attack 에서 정의된 transferability 는 연구되지 않았다.</p><p>CoOp, VPT, MaPLe 같은 prompt tuning 의 인기 있는 연구들은 model 의 early layers 에서 soft prompt 를 활용하지만, 이들은 input 으로서 discrete text 와 image 만 접근 가능한 완전한 blackbox 조건에선 무효하다.</p><p>본 논문에서는 learned visual prompt 를 다른 MLLMs 에 transfer 하여 adapting 하는 방법을 연구한다.</p><p>이는 computation 및 storage overloads 를 줄이고, &quot;Prompt as a Service&quot; (PaaS) 와 같은 다양한 응용 시나리오에서 더 편리하고 유연한 솔루션을 제공한다.</p><p>여기서 사용자는 PaaS 로부터 specific task 에 대한 visual prompt 를 요청하여 local model confidentiality 유지가 가능하다</p><h1>3. Methods</h1><p>Visual Prompting 은 CLIP 같은 vision-language model 을 fine-tuning 없이 downstream vision task 에 adapting 할 수 있는 효과적인 수단을 제공한다.</p><p>본 연구에서는 VP 의 적용을 MLLMs 으로 확장하고, 다양한 models 전반에 걸쳐 성능을 향상시키는 잠재력을 조사한다.</p><p>기존의 방법들은 prompt learning 을 통해 모델 성능을 향상시킬 수 있지만, 이러한 learned prompt 는 다른 모델에 적용될 때 feature corruption 과 관련된 문제로 인해 성능이 저하되는 경우가 많다.</p><p>이를 해결하기 위해, 저자는 Transferable Visual Prompting (TVP) 방법을 소개하여 다양한 MLLMs 에서 visual prompt 의 transferability 를 향상시키고자 한다.</p><p><img loading="lazy" alt="Figure 2" src="/assets/images/image-107-c494b8ab2161630314bfa32a2304f118.png" width="1379" height="633" class="img_ev3q"></p><p>Fig. 2 는 TVP 의 개요</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-preliminaries">3.1. Preliminaries<a href="#31-preliminaries" class="hash-link" aria-label="Direct link to 3.1. Preliminaries" title="Direct link to 3.1. Preliminaries">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="multimodal-large-language-models">Multimodal Large Language Models.<a href="#multimodal-large-language-models" class="hash-link" aria-label="Direct link to Multimodal Large Language Models." title="Direct link to Multimodal Large Language Models.">​</a></h4><p>MLLMs 은 주로 visual feature 를 text embedding 공간으로 project 하여 image 와 LLMs 를 통합하는 아키텍처를 사용한다.</p><p>구체적으로, 저자는 visual encoder <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>θ</mi></msub></mrow><annotation encoding="application/x-tex">f_\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, LLM <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>ϕ</mi></msub></mrow><annotation encoding="application/x-tex">P_\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 및 projector <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>ψ</mi></msub></mrow><annotation encoding="application/x-tex">h_\psi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ψ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 를 가지고 있다고 가정한다.</p><p>image input <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em"></span><span class="mord mathbf">X</span></span></span></span></span> 와 text input <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">t</mi></mrow><annotation encoding="application/x-tex">\mathbf{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6349em"></span><span class="mord mathbf">t</span></span></span></span></span> 가 주어졌을 때, MLLM 의 textaul response <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">r</mi></mrow><annotation encoding="application/x-tex">\mathbf{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">r</span></span></span></span></span> 는 다음과 같은 likelihood 에 따라 autoregressive 하게 결정된다:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="bold">r</mi><mi>i</mi></msub><mo>∼</mo><msub><mi>P</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">r</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>h</mi><mi>ψ</mi></msub><mo stretchy="false">(</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="bold">t</mi><mo separator="true">,</mo><msub><mi mathvariant="bold">r</mi><mrow><mo>&lt;</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \mathbf{r}_i \sim P_\phi (\mathbf{r}_i \mid h_\psi (f_\theta (\mathbf{X})), \mathbf{t}, \mathbf{r}_{&lt;i}), \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∼</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ψ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-2.85em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>3</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{X} \in \mathbb{R}^{3 \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7252em;vertical-align:-0.0391em"></span><span class="mord mathbf">X</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">W</span></span></span></span></span></span></span></span></span></span></span></span></span> : RGB image</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">t</mi><mo>∈</mo><msup><mi mathvariant="double-struck">V</mi><mi>N</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{t} \in \mathbb{V}^N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.674em;vertical-align:-0.0391em"></span><span class="mord mathbf">t</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span></span></span></span></span></span></span></span></span> : vocabulary <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="double-struck">V</mi></mrow><annotation encoding="application/x-tex">\mathbb{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em"></span><span class="mord mathbb">V</span></span></span></span></span> 의 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span> tokens 를 가진 text</li><li>image features <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_\theta(\mathbf{X})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span></span></span></span></span> : text 와 align 하도록 projector <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mi>ψ</mi></msub></mrow><annotation encoding="application/x-tex">h_\psi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ψ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> (e.g., MLP)에 의해 mapping 되어 text token 과 결합하여 downstream LLM 에 unified input 으로 사용.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="visual-prompting">Visual Prompting.<a href="#visual-prompting" class="hash-link" aria-label="Direct link to Visual Prompting." title="Direct link to Visual Prompting.">​</a></h4><p>VP methods 에서 제안된 바와 같이, learnable visual prompt <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">δ</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>3</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{\delta} \in \mathbb{R}^{3 \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.03785em">δ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">W</span></span></span></span></span></span></span></span></span></span></span></span></span> 는 pixel space 에서 학습되며, 다양한 transformations <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.25417em">T</span></span></span></span></span> (e.g., global perturbations, padding)과 함께 clean images 에 적용되어 model 을 특정 downstream task 에 adapting 한다.</p><p>본 논문에서는 일반적인 VP 의 관행을 따르며, resized input image 주위에 universarl pixel-level prompt 를 추가한다.</p><p>수학적으로, visual prompt process 를 다음과 같이 설명:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="script">T</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mtext>Resize</mtext><mrow><mi>H</mi><mo>×</mo><mi>W</mi><mo>→</mo><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>×</mo><msup><mi>W</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo stretchy="false">)</mo><mo>+</mo><munder><munder><mrow><msub><mi>M</mi><mi>p</mi></msub><mo>⊙</mo><mi mathvariant="bold-italic">δ</mi></mrow><mo stretchy="true">⏟</mo></munder><mtext>visual prompt</mtext></munder><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \mathcal{T}_p(\mathbf{X}, \boldsymbol{\delta}) = \text{Resize}_{H \times W \rightarrow H&#x27; \times W&#x27;}(\mathbf{X}) + \underbrace{M_p \odot \boldsymbol{\delta}}_{\text{visual prompt}}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5963em;vertical-align:-1.0482em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5482em"><span style="top:-3.7082em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord text"><span class="mord">Resize</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">W</span><span class="mrel mtight">→</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6828em"><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-1.3798em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">visual prompt</span></span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord munder"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span class="svg-align" style="top:-2.0659em"><span class="pstrut" style="height:3em"></span><span class="stretchy" style="height:0.548em;min-width:1.6em"><span class="brace-left" style="height:0.548em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMinYMin slice"><path d="M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z"></path></svg></span><span class="brace-center" style="height:0.548em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMidYMin slice"><path d="M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z"></path></svg></span><span class="brace-right" style="height:0.548em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="0.548em" viewBox="0 0 400000 548" preserveAspectRatio="xMaxYMin slice"><path d="M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z"></path></svg></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9341em"><span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.7563em"><span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0482em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5482em"><span style="top:-3.5482em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0482em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span> : visual prompt width</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">M_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> : value 가 1 인 width <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span></span></span></span></span> 의 border 를 가진 binary mask</li><li>original image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em"></span><span class="mord mathbf">X</span></span></span></span></span> 의 size <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>×</mo><mi>W</mi></mrow><annotation encoding="application/x-tex">H \times W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span></span></span></span></span> 는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>×</mo><msup><mi>W</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mo stretchy="false">(</mo><mi>H</mi><mo>−</mo><mn>2</mn><mi>p</mi><mo stretchy="false">)</mo><mo>×</mo><mo stretchy="false">(</mo><mi>W</mi><mo>−</mo><mn>2</mn><mi>p</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H&#x27; \times W&#x27; = (H - 2p) \times (W - 2p)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8352em;vertical-align:-0.0833em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">2</span><span class="mord mathnormal">p</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord">2</span><span class="mord mathnormal">p</span><span class="mclose">)</span></span></span></span></span> 로 resizing 되어 prompted image 가 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03785em">δ</span></span></span></span></span> 와 겹치지 않게 원본과 동일한 크기를 갖도록 한다.</li><li>default 로 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mi>W</mi><mo>=</mo><mn>224</mn></mrow><annotation encoding="application/x-tex">H = W = 224</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">224</span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>30</mn></mrow><annotation encoding="application/x-tex">p = 30</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">30</span></span></span></span></span> 을 사용.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-problem-formulation">3.2. Problem Formulation<a href="#32-problem-formulation" class="hash-link" aria-label="Direct link to 3.2. Problem Formulation" title="Direct link to 3.2. Problem Formulation">​</a></h2><p>VP 를 확장하여 MLLMs 을 downstream task 에 adapting 하며 massive parameter finr-tuning 의 heavy computation 부담을 피하는 것을 목표로 한다.</p><p>이를 더 일반화하기 위해, 다양한 visual task 를 text completion 으로 통합하고, VP 의 training objective 로 autoregressive loss (i.e., vocabulary 에 대한 cross-entropy loss)을 설정한다.</p><p>dataset <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span></span></span></span></span> 에 대한 task 를 고려할 때, 이는 다음과 같이 공식화:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>L</mi><mtext>LLM</mtext></msub><mo stretchy="false">(</mo><mi>δ</mi><mo stretchy="false">)</mo><mo>=</mo><mi><munder><mo><mi mathvariant="double-struck">E</mi></mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi mathvariant="bold">t</mi><mo separator="true">,</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo><mo>∼</mo><mi mathvariant="script">D</mi></mrow></munder></mi><mrow><mo fence="true">[</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>N</mi><mi>r</mi></msub></munderover><mo>−</mo><mi>log</mi><mo>⁡</mo><msub><mi>P</mi><mi>ϕ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">r</mi><mi>i</mi></msub><mo>∣</mo><msub><mi>h</mi><mi>ψ</mi></msub><mo stretchy="false">(</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="script">T</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><mi mathvariant="bold">t</mi><mo separator="true">,</mo><msub><mi mathvariant="bold">r</mi><mrow><mo>&lt;</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} L_{\text{LLM}}(\delta) = \underset{(\mathbf{X}, \mathbf{t}, \mathbf{r}) \sim \mathcal{D}}{\mathbb{E}}\left[ \sum_{i=1}^{N_r} -\log P_\phi (\mathbf{r}_i \mid h_\psi (f_\theta (\mathcal{T}_p(\mathbf{X}, \boldsymbol{\delta}))), \mathbf{t}, \mathbf{r}_{&lt;i}) \right]. \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1171em;vertical-align:-1.3086em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8086em"><span style="top:-3.8086em"><span class="pstrut" style="height:3.8394em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">LLM</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03785em">δ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6889em"><span style="top:-2.309em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathbf mtight">X</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">r</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mathcal mtight" style="margin-right:0.02778em">D</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop mathbb">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size4">[</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8394em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3111em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:-0.109em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ψ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">)))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathbf">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">&lt;</span><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size4">]</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3086em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8086em"><span style="top:-3.8086em"><span class="pstrut" style="height:3.8394em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3086em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">t</mi><mo separator="true">,</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{t}, \mathbf{r})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathbf">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathbf">r</span><span class="mclose">)</span></span></span></span></span> : task 를 위한 prompt-target text pair</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">N_r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.109em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> :  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">r</mi></mrow><annotation encoding="application/x-tex">\mathbf{r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4444em"></span><span class="mord mathbf">r</span></span></span></span></span> 의 length</li></ul><p>이 연구에서 visual prompt 의 transferability 를 활용합니다. 이는 adversarial robust 분야의 transfer attack 에서 영감을 받았다.</p><p>저자는 one-time trained prompt 를 other model 로 transfer 하여 성능을 향상시키고자 한다.</p><p>구체적으로, </p><ul><li>저자는 한 MLLM 에서 loss <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>LLM</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{LLM}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">LLM</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 을 minimizing 하면서 prompt <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03785em">δ</span></span></span></span></span> 를 optimizing 하고, 이 learned prompt 를 다른 arbitrary MLLM 에 적용했을 때 loss <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="script">L</mi><mtext>LLM</mtext><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{L}&#x27;_{\text{LLM}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0272em;vertical-align:-0.2753em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-2.4247em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">LLM</span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em"><span></span></span></span></span></span></span></span></span></span></span> 을 낮추는 것을 기대한다.</li><li>즉, 해당 prompt 를 target task 에 대해 추가 fine-tuning 없이 적용했을 때 성능을 향상시키려는 것이다.</li></ul><p>기존 VP 방법을 다양한 model 에서 시험해본 결과, generated visual prompts 의 transferability 가 낮아 보통의 성능 향상 또는 현저한 성능 저하를 초래함을 확인했다.</p><p>저자는 이 현상의 원인을 “<em>cross-model feature corruption</em>” 으로 지목한다.</p><p>이는 한 model 에서 학습된 visual prompt 가 other model 에서 visual feature 를 상당히 변화시킬 수 있음을 나타낸다.</p><p><img loading="lazy" alt="Figure 3" src="/assets/images/image-108-99d1c7b463cc8c32bdc6cc21c54ca327.png" width="670" height="700" class="img_ev3q"></p><p>Fig. 3에서 보듯이, </p><ul><li>CIFAR-10 에서 다양한 models 에서 추출된 prompted visual feature 의 t-SNE plot 을 통해, 성능이 저하된 model 의 경우 prompted image feature 가 clean image 에 비해 혼합되는 것을 확인할 수 있다.</li><li>이는 visual prompt learning 때, 주로 현재 model 에만 유용한 task-specific feature 를 증폭시킨다<ul><li>즉, training 중 model 에 overfitting 함</li></ul></li><li>하지만, other models 의 feature 변경으로 인해 pre-training 의 knowledge 가 ineffective 및 prompt learning 없이 해당 모델에 대한 prediction 이 disrupt 된다</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="33-transferable-visual-prompting">3.3. Transferable Visual Prompting<a href="#33-transferable-visual-prompting" class="hash-link" aria-label="Direct link to 3.3. Transferable Visual Prompting" title="Direct link to 3.3. Transferable Visual Prompting">​</a></h2><p>feature corruption 문제를 완화하고 transferability 향상을 위해, 저자는 기존 VP 기술과 두 가지 새로운 전략을 통합한 Transferable Visual Prompting(TVP) 을 제안</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="331-feature-consistency-alignment">3.3.1. Feature Consistency Alignment<a href="#331-feature-consistency-alignment" class="hash-link" aria-label="Direct link to 3.3.1. Feature Consistency Alignment" title="Direct link to 3.3.1. Feature Consistency Alignment">​</a></h3><p>위 분석에서 visual prompt 가 image feature 를 상당히 변형시켜 pre-trained general knowledge 가 손실되고, model 간 transferring 시 성능이 저하됨을 알 수 있었다.</p><p>이를 해결하기 위해, 저자는 prompted features 와 non-prompted features 간의 차이에 대해 specific constraint 를 부여할 것을 제안한다.</p><p>이는 exceptional feature corruption 을 방지하고 prompt learning 중 task-agnostic general knowledge 을 유지하도록 유도한다.</p><p>prompted features 가 original features 와 일관되도록 유도하기 위해 FCA loss 를 사용합니다.</p><p>주어진 white-box model <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>P</mi><mi>ϕ</mi></msub><mo separator="true">,</mo><msub><mi>f</mi><mi>θ</mi></msub><mo separator="true">,</mo><msub><mi>h</mi><mi>ψ</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(P_\phi, f_\theta, h_\psi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">ψ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span> 와 input tuple <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(\mathbf{X}, t, r)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mclose">)</span></span></span></span></span> 에 대해, 저자는 visual encoder <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_\theta(\mathbf{X})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span></span></span></span></span> 로부터 plain image 의 feature 를 얻고, prompted feature <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="script">T</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi>δ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f_\theta(\mathcal{T}_p(\mathbf{X}, \delta))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03785em">δ</span><span class="mclose">))</span></span></span></span></span> 를 얻는다.</p><p>이 features 간의 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">ℓ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\ell_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord">ℓ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> distance 를 측정하는 데 사용하며, FCA loss 는 다음과 같이 계산:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>L</mi><mtext>FCA</mtext></msub><mo stretchy="false">(</mo><mi>δ</mi><mo stretchy="false">)</mo><mo>=</mo><mi><munder><mo><mi mathvariant="double-struck">E</mi></mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi mathvariant="bold">t</mi><mo separator="true">,</mo><mi mathvariant="bold">r</mi><mo stretchy="false">)</mo><mo>∼</mo><mi mathvariant="script">D</mi></mrow></munder></mi><mrow><mo fence="true">[</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant="normal">∥</mi><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi mathvariant="script">T</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo stretchy="false">)</mo><msubsup><mi mathvariant="normal">∥</mi><mn>2</mn><mn>2</mn></msubsup><mo fence="true">]</mo></mrow><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} L_{\text{FCA}}(\delta) = \underset{(\mathbf{X}, \mathbf{t}, \mathbf{r}) \sim \mathcal{D}}{\mathbb{E}} \left[ \frac{1}{2} \|f_\theta (\mathcal{T}_p(\mathbf{X}, \boldsymbol{\delta})) - f_\theta (\mathbf{X})\|^2_2 \right]. \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.416em;vertical-align:-0.958em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.458em"><span style="top:-3.458em"><span class="pstrut" style="height:3.45em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">FCA</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03785em">δ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6889em"><span style="top:-2.309em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathbf mtight">X</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">t</span><span class="mpunct mtight">,</span><span class="mord mathbf mtight">r</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mathcal mtight" style="margin-right:0.02778em">D</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop mathbb">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.958em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.458em"><span style="top:-3.458em"><span class="pstrut" style="height:3.45em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.958em"><span></span></span></span></span></span></span></span></span></div><ul><li>저자는 prompted feature 가 original feature 와 조정되어 feature 변화가 억제되고, 효과적인 task-agnostic semantic information 이 유지되도록 한다.</li><li>이는 unseen model 의 useful visual representation 을 활용하기 위해 prompt 가 mild 해지기 때문에 learned visual prompt 의 more transferable 이 되도록 한다</li></ul><p>다른 관점에서, FCA loss 는 prompted feature space 에 적용되는 regularization 의 형태로 볼 수 있으며, 이는 generalization 을 강화하는 수단으로 작용한다.</p><p>Regularization 기법은 overfitting 을 방지하고 model 의 generalization 을 보장하기 위해 일반적으로 사용된다.</p><p>주요 차이점은 기존 연구는 주로 data 간의 generalization (e.g., base-to-novel, domain generalization)에 초점을 맞추었으나, 저자의 연구는 model 간의 generalization 에 중점을 둔다.</p><p>prompted feature 에 regularization 을 적용함으로써, supervised task 의 성능을 극대화하면서도 다양한 모델의 embedded knowledge 를 유지하려고 한다</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="332-task-semantic-enrichment">3.3.2. Task Semantic Enrichment<a href="#332-task-semantic-enrichment" class="hash-link" aria-label="Direct link to 3.3.2. Task Semantic Enrichment" title="Direct link to 3.3.2. Task Semantic Enrichment">​</a></h3><p>end-to-end supervised training 외에도, visual prompt 가 richer task-specific semantic information 을 포함하도록 하여 visual prompt 의 성능을 더욱 향상시키고자 한다.</p><p>이는 다양한 model 에서 target task 의 성능을 향상시킬 수 있도록, 이들 간의 shared semantic 향상을 촉진하는 것을 목표로 한다.</p><p>CLIP 은 image-text alignment 를 통해 abundant knowledge 를 가진 vision-language foundation model 이다.</p><p>많은 연구들이 CLIP 을 visual task 에 대한 additional supervision 및 guidance 로 활용했다.</p><p>그러나 prompt learning 의 context 에서 CLIP 을 target model 이 아닌 guidance 로 사용하는 것에 대해서는 널리 연구되지 않았다.</p><hr><p>저자는 CLIP 을 활용하여 prompted image 의 task-related semantics 를 명시적으로 향상시키기 위해 Task Semantic Enrichment (TSE) loss 를 제안한다.</p><p>CLIP 은 visual encoder <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mtext>image</mtext></msub></mrow><annotation encoding="application/x-tex">g_{\text{image}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">image</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 와 text encoder <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mtext>text</mtext></msub></mrow><annotation encoding="application/x-tex">g_{\text{text}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">text</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 로 구성되며, image input <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mn>3</mn><mo>×</mo><mi>H</mi><mo>×</mo><mi>W</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{X} \in \mathbb{R}^{3 \times H \times W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7252em;vertical-align:-0.0391em"></span><span class="mord mathbf">X</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">W</span></span></span></span></span></span></span></span></span></span></span></span></span> 와 text input <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">t</mi><mo>∈</mo><msup><mi>V</mi><mi>N</mi></msup></mrow><annotation encoding="application/x-tex">\mathbf{t} \in V^N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.674em;vertical-align:-0.0391em"></span><span class="mord mathbf">t</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span></span></span></span></span></span></span></span></span> 을 각각 shared embedding space <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span></span></span></span></span> 으로 mapping 한다.</p><p>image 와 text 간의 correspondence 는 그들의 feature 간의 distance 를 계산하여 얻을 수 있다.</p><p>images 에 맞는 task-specific description 을 설계함으로써, 이들의 similarity 를 극대화하여 task semantics 를 prompted image 에 잘 embed 할 수 있다.</p><p>CLIP 의 contrastive loss 를 참고하여, 다음과 같은 auxiliary loss 를 제시:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>L</mi><mtext>TSE</mtext></msub><mo stretchy="false">(</mo><mi>δ</mi><mo stretchy="false">)</mo><mo>=</mo><mi><munder><mo><mi mathvariant="double-struck">E</mi></mo><mrow><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><msub><mi mathvariant="bold">t</mi><mi mathvariant="bold">X</mi></msub><mo stretchy="false">)</mo><mo>∼</mo><mi mathvariant="script">D</mi></mrow></munder></mi><mrow><mo fence="true">[</mo><mi>exp</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mi>τ</mi><mtext>sim</mtext><mrow><mo fence="true">(</mo><msub><mi>g</mi><mtext>image</mtext></msub><mo stretchy="false">(</mo><msub><mi mathvariant="script">T</mi><mi>p</mi></msub><mo stretchy="false">(</mo><mi mathvariant="bold">X</mi><mo separator="true">,</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>g</mi><mtext>text</mtext></msub><mo stretchy="false">(</mo><msub><mi mathvariant="bold">t</mi><mi mathvariant="bold">X</mi></msub><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">]</mo></mrow><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} L_{\text{TSE}}(\delta) = \underset{(\mathbf{X}, \mathbf{t}_{\mathbf{X}}) \sim \mathcal{D}}{\mathbb{E}} \left[ \exp \left(\tau \text{sim} \left(g_{\text{image}}(\mathcal{T}_p(\mathbf{X}, \boldsymbol{\delta})), g_{\text{text}}(\mathbf{t}_{\mathbf{X}}) \right) \right) \right], \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.806em;vertical-align:-0.653em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.153em"><span style="top:-3.313em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">TSE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03785em">δ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6889em"><span style="top:-2.309em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathbf mtight">X</span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathbf mtight">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3547em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathbf mtight">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1453em"><span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mathcal mtight" style="margin-right:0.02778em">D</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop mathbb">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.966em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">[</span><span class="mop">exp</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mord text"><span class="mord">sim</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner"><span class="mopen delimcenter" style="top:0em">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">image</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathbf">X</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">))</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">text</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3303em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em">)</span></span><span class="mclose delimcenter" style="top:0em">)</span></span><span class="mclose delimcenter" style="top:0em">]</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.653em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.153em"><span style="top:-3.153em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.653em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>sim</mtext><mo stretchy="false">(</mo><mo>⋅</mo><mo separator="true">,</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{sim}(\cdot, \cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">sim</span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> : cosine similarity</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span> : temperature</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">t</mi><mi mathvariant="bold">X</mi></msub></mrow><annotation encoding="application/x-tex">\mathbf{t}_{\mathbf{X}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7849em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathbf">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3303em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathbf mtight">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> : target task 의 image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">X</mi></mrow><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6861em"></span><span class="mord mathbf">X</span></span></span></span></span> 의 text description</li></ul><p>FCA loss 와 TSE loss 을 Eq. (3) 의 supervision loss <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mtext>LLM</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{\text{LLM}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">LLM</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 과 함께 통합하여, visual prompt 가 task-agnostic 및 task-specific representation 을 강화하고 모델 성능을 향상시키도록 유도한다.</p><p>overall training objective 는 다음과 같은 형태:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi mathvariant="script">L</mi><mtext>LLM</mtext></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi mathvariant="script">L</mi><mtext>FCA</mtext></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo>−</mo><msub><mi>λ</mi><mn>2</mn></msub><msub><mi mathvariant="script">L</mi><mtext>TSE</mtext></msub><mo stretchy="false">(</mo><mi mathvariant="bold-italic">δ</mi><mo stretchy="false">)</mo><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \mathcal{L}(\boldsymbol{\delta}) = \mathcal{L}_{\text{LLM}}(\boldsymbol{\delta}) + \lambda_1 \mathcal{L}_{\text{FCA}}(\boldsymbol{\delta}) - \lambda_2 \mathcal{L}_{\text{TSE}}(\boldsymbol{\delta}), \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">LLM</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">FCA</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">TSE</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="mclose">)</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-2.85em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">\lambda_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> : hyper-parameter</li></ul><p>이 training objective 를 위해, 저자는 EVP 를 따른다. EVP 는 input diversity 및 gradient normalization 개념을 도입하여 성능을 향상시키며, step <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em"></span><span class="mord mathnormal">t</span></span></span></span></span> 에 따른 learnable prompt 를 다음과 같이 update:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi mathvariant="bold-italic">δ</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msup><mi mathvariant="bold-italic">δ</mi><mi>t</mi></msup><mo>−</mo><mi>γ</mi><mfrac><mrow><msub><mi mathvariant="normal">∇</mi><msup><mi mathvariant="bold-italic">δ</mi><mi>t</mi></msup></msub><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">δ</mi><mi>t</mi></msup><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∥</mi><msub><mi mathvariant="normal">∇</mi><msup><mi mathvariant="bold-italic">δ</mi><mi>t</mi></msup></msub><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">δ</mi><mi>t</mi></msup><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>2</mn></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \boldsymbol{\delta}^{t+1} = \boldsymbol{\delta}^t - \gamma \frac{\nabla_{\boldsymbol{\delta}^t} \mathcal{L}(\boldsymbol{\delta}^t)}{\|\nabla_{\boldsymbol{\delta}^t} \mathcal{L}(\boldsymbol{\delta}^t)\|_2}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5728em;vertical-align:-1.0364em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5364em"><span style="top:-3.5364em"><span class="pstrut" style="height:3.5549em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8984em"><span style="top:-3.1473em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8779em"><span style="top:-3.1473em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5549em"><span style="top:-2.2321em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.4982em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03819em">δ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7809em"><span style="top:-2.8416em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2018em"><span></span></span></span></span></span></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8779em"><span style="top:-3.1473em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord">∇</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.4982em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord boldsymbol mtight" style="margin-right:0.03819em">δ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7809em"><span style="top:-2.8416em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2018em"><span></span></span></span></span></span></span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.03819em">δ</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8779em"><span style="top:-3.1473em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0179em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0364em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5364em"><span style="top:-3.5364em"><span class="pstrut" style="height:3.5549em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0364em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span></span></span></span></span> : learning rate</li></ul><h1>4. Experiments</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="41-experimental-settings">4.1. Experimental Settings<a href="#41-experimental-settings" class="hash-link" aria-label="Direct link to 4.1. Experimental Settings" title="Direct link to 4.1. Experimental Settings">​</a></h2><p>여기에서는 실험의 basic setting 을 간단히 나열.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="datasets-and-metrics">Datasets and Metrics<a href="#datasets-and-metrics" class="hash-link" aria-label="Direct link to Datasets and Metrics" title="Direct link to Datasets and Metrics">​</a></h4><p>다양한 visual 또는 multimodal tasks 를 포함하는 10 datasets 고려</p><ul><li>visual task 를 위해, object recognition (e.g., CIFAR-10, ImageNette, SVHN) 및 object counting (e.g., CLEVR) 에 대한 8 dataset 사용</li><li>또한, multimodal problems 인 multimodal reasoning (Hatefulmemes) 및 hallucination (POPE)을 중점적으로 다루어 TVP 의 효과를 MLLM 분야에서 더욱 잘 보여줌</li><li>Hatefulmemes 에는 AUC score 를, 나머지 dataset 에는 top-1 accuracy 를 metric 으로 사용</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="models">Models<a href="#models" class="hash-link" aria-label="Direct link to Models" title="Direct link to Models">​</a></h4><p>6 MLLMs 을 선택하여, 제안된 TVP 방법으로 생성된 visual prompt 가 다양한 모델의 성능을 보편적으로 향상시킬 수 있음을 보여줌.</p><p>구체적으로, MiniGPT-4 와 InstructBLIP 에서 visual prompt 를 학습하고, 이를 BLIP2, VPGTrans, BLIVA, VisualGLM 에 transfer</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="baselines">Baselines.<a href="#baselines" class="hash-link" aria-label="Direct link to Baselines." title="Direct link to Baselines.">​</a></h4><p>다양한 models 간의 visual prompt transferability 에 중점을 두며, TVP 방법을 일반적인 visual prompting 방법인 VP 및 EVP 와 비교한다.</p><p>이는 다양한 data distribution 간의 generalization 에 중점을 두지 않는 방법이다.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="implementations">Implementations.<a href="#implementations" class="hash-link" aria-label="Direct link to Implementations." title="Direct link to Implementations.">​</a></h4><p>TVP 의 hyperparameter 에는 제안된 loss terms 에 대한 two balance weights 가 포함된다.</p><p>validation set 에서 작은 범위 내에서 grid-search 로 optimal 을  설정한다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="42-main-results">4.2. Main Results<a href="#42-main-results" class="hash-link" aria-label="Direct link to 4.2. Main Results" title="Direct link to 4.2. Main Results">​</a></h2><p>MiniGPT-4 또는 InstructBLIP 에서 visual prompt 를 학습하고, 이를 6 models 에서 평가</p><p>결과는 Tab. 1 에 나타나 있다. </p><p><img loading="lazy" alt="Table 3" src="/assets/images/image-109-2e264fb0bb07dcc0cfb37194dee55186.png" width="912" height="924" class="img_ev3q"></p><p>몇 가지 주요 발견 사항은 다음과 같습니다.</p><ol><li>visual prompt 기법이 recognition 외에 reasoning 을 포함한 multimodal task 에서도 효과적임을 입증한 것은 이 논문이 처음<ul><li>그 외에도, VP 는 가장 불리한 결과를 나타내며, 종종 전반적인 성능 저하를 초래하여 transferability 가 낮다</li><li>EVP 는 normalized gradient 로 stable optimization 을 통해 model 의 visual prompt learning 에 더 큰 개선을 가져오지만, other models 에 대한 이점이 제한적</li><li>대조적으로, TVP 는 training model 에 대해 유사한 효과를 달성하면서도 other models 의 성능을 더 크게 향상.</li><li>전체적인 효과는 6 models 에서 all downstream task 에 걸쳐 highest average delta 로 나타나며, 이는 shared external parameters 의 single set 이 다양한 models 를 향상시키는 우리의 목표를 잘 달성.</li></ul></li><li>TVP 의 결과에 대해 더 깊은 통찰을 얻음<ul><li>VisualGLM 의 개선 사항은 other models 에 비해 상대적으로 미미<ul><li>이는 visual prompt 를 VisualGLM 으로의 transferring 이 더 어려운 것으로 보임</li><li>VisualGLM 의 language model 은 GLM 인 반면, 나머지 models 는 LLaMA 아키텍처를 기반으로 함.</li><li>이러한 language model 의 차이가 효과적인 prompt transferring 의 어려움을 초래할 수 있음.</li></ul></li><li>또한, InstructBLIP 에서 생성된 visual prompt 의 trasferability 가 MiniGPT-4 보다 전반적으로 더 좋다는 것을 알 수 있음.<ul><li>비슷한 아키텍처를 공유하지만, InstructBLIP 은 13 vision-language dataset 에서 체계적으로 조정되었으며, 이는 MiniGPT-4 보다 훨씬 풍부.</li><li>이는 InstructBLIP 이 visual-language task 에 대한 더 많은 internal knowledge 를 보유하고 있어 visual prompt learning 을 도와주고, other models 에 더 많은 개선을 가져오는 데 도움이 됨.</li></ul></li></ul></li></ol><p>이와 유사한 결론은 실용적인 dataset 인 CIFAR-100, Oxford-Pets, FGVC-Aircraft, Food101 에 대해서도 Tab. 6 에서 도출됨.</p><p><img loading="lazy" alt="Table 6" src="/assets/images/image-110-032f1a4812d54a58b10c27b318b2f209.png" width="378" height="923" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="43-model-ensemble">4.3. Model Ensemble<a href="#43-model-ensemble" class="hash-link" aria-label="Direct link to 4.3. Model Ensemble" title="Direct link to 4.3. Model Ensemble">​</a></h2><p>ensembling 기법은 model generalization 을 향상시키고, transfer attack 에 효과적임이 입증.</p><p>이 아이디어는 transferable visual prompt 에도 적용될 수 있다.</p><p>직관적으로, visual prompt 가 여러 models 에 대해 효과적이라면, 더 많은 shareable informative semantic 를 포함하고 other models 로의 transfer 이 더 잘될 가능성이 큼.</p><p>저자는 단순히 서로 다른 models 의 loss 를 평균하여 visual prompt 를 optimizing 하며, 여기서는 MiniGPT-4 와 InstructBLIP 을 ensembling 함.</p><p>ensemble prompt learning 의 결과는 Tab. 1 에 제시.</p><ul><li>model ensemble 이 다양한 방법으로 학습된 visual prompt 의 transferability 를 향상시킬 수 있는 일반적인 기법임을 알 수 있음.</li><li>한편, TVP 가 가장 좋은 성능을 보이는 추세는 변하지 않으며, ensemble 의 도움으로 4 task 에서 최상의 전반적인 개선을 달성. </li><li>그러나 더 많은 models 를 사용하는 것은 compuational 및 storage overhead 를 증가시키므로, 이 기술을 채택할 때는 training cost 와 prompt transferability 간의 균형을 찾아야 함.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="44-ablation-studies">4.4. Ablation Studies<a href="#44-ablation-studies" class="hash-link" aria-label="Direct link to 4.4. Ablation Studies" title="Direct link to 4.4. Ablation Studies">​</a></h2><p>TVP 의 설계를 추가로 검증하기 위해 ablation study 수행.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="441-strategies-of-fca-and-tse">4.4.1 Strategies of FCA and TSE<a href="#441-strategies-of-fca-and-tse" class="hash-link" aria-label="Direct link to 4.4.1 Strategies of FCA and TSE" title="Direct link to 4.4.1 Strategies of FCA and TSE">​</a></h3><p>먼저, 제안된 FCA 와 TSE 가 MiniGPT-4 로 학습된 visual prompt 의 성능에 미치는 영향을 살펴본다.</p><p><img loading="lazy" alt="Table 2" src="/assets/images/image-111-d463e11cd5523dcf31dc3265ad3e143a.png" width="698" height="241" class="img_ev3q"></p><p>Tab. 2 에서 볼 수 있듯이, </p><ul><li>각각의 전략을 개별적으로 적용하면 average performance 가 어느 정도 개선됨.</li><li>두 전략을 함께 사용하면 다양한 모델에 대한 visual prompt 의 지원을 극대화할 수 있다.</li><li>이는 FCA 가 촉진하는 task-agnostic prior knowledge 와 TSE 가 향상시키는 task-related feature extraction 이 visual prompt 의 transferability 에 기여할 수 있음을 나타냄.</li><li>Fig. 4 의 visualization 은 TVP 가 모델이 task completion 에 유용한 object 를 더 잘 찾도록 도와줄 수 있음을 제안.</li></ul><p><img loading="lazy" alt="Figure 4" src="/assets/images/image-112-7147e4ba283db851a624e95b9eca3f30.png" width="688" height="405" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="442-prompt-width">4.4.2 Prompt Width<a href="#442-prompt-width" class="hash-link" aria-label="Direct link to 4.4.2 Prompt Width" title="Direct link to 4.4.2 Prompt Width">​</a></h3><p>Prompt width 는 TVP 의 성능에 중요할 수 있다.</p><p><img loading="lazy" alt="Table 3" src="/assets/images/image-113-bc0601ac555e867d6dbd308728dcaadd.png" width="688" height="242" class="img_ev3q"></p><p>Tab. 3 의 CIFAR-10 결과는 learnable parameter 의 수가 scaled image size 간의 균형을 보여주며, TVP 의 성능은 20-30 사이의 적당한 prompt width 에서 최고조에 달하며, 이는 저자가 선택한 30 을 검증.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="45-in-depth-analyses">4.5. In-depth Analyses<a href="#45-in-depth-analyses" class="hash-link" aria-label="Direct link to 4.5. In-depth Analyses" title="Direct link to 4.5. In-depth Analyses">​</a></h2><p>다양한 조건에서 TVP 의 효과를 입증하고 실제 시나리오에서의 실용성을 검증하기 위해 몇 가지 심층 분석을 제시.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="451-데이터-규모-data-scale">4.5.1 데이터 규모 (Data Scale)<a href="#451-데이터-규모-data-scale" class="hash-link" aria-label="Direct link to 4.5.1 데이터 규모 (Data Scale)" title="Direct link to 4.5.1 데이터 규모 (Data Scale)">​</a></h4><p>adaptation 을 위한 data 가 실제 시나리오에서 제한될 때가 많기 때문에, learned visual prompt 의 성능에 대한 training data size 의 영향을 연구하는 것이 중요.</p><p>VPT, EVP 를 따르며, data 양이 1% 에서 100% 까지 변경됨에 따라 다양한 방법의 추세를 조사한다.</p><p><img loading="lazy" alt="Figure 5" src="/assets/images/image-114-259a8944bda561c18e0864ed522df7de.png" width="685" height="551" class="img_ev3q"></p><p>Fig. 5 에서 MiniGPT-4 로 학습된 visual prompt 를 사용하여 다양한 모델의 average performance curves 를 plotting</p><ul><li>예상대로, data scale 이 증가함에 따라 TVP 의 성능이 일반적으로 향상되는 경향.</li><li>data size 에 관계없이 TVP 가 VP 및 EVP 보다 더 나은 성능을 발휘한다는 결론은 일관되게 유지.</li><li>TVP 는 data size 가 1% 에 불과할 때도 여러 모델의 전체 성능을 향상시킬 수 있으며, 때로는 complete dataset 으로 학습된 것과 유사한 효과를 보인다.</li><li>이는 저자의 방법의 효과를 더욱 설명하며, 실제 시나리오에서의 적용 가능성을 더욱 높인다.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="452-generalization-across-datasets">4.5.2 Generalization across Datasets<a href="#452-generalization-across-datasets" class="hash-link" aria-label="Direct link to 4.5.2 Generalization across Datasets" title="Direct link to 4.5.2 Generalization across Datasets">​</a></h3><p>trained visual prompt 의 generalization 을 조사하여 TVP 의 실제 시나리오에서의 실용성을 더욱 확인하는 것이 중요하다.</p><p>object recognition 을 예로 든다.</p><p><img loading="lazy" alt="Table 4" src="/assets/images/image-115-c1a82f111a770ac99d795588aa440e71.png" width="694" height="222" class="img_ev3q"></p><ul><li>prompt learning 의 일반적인 방법을 따르며, CIFAR-100 에서 생성된 visual prompt 를 other recognition task 의 dataset 에 적용한다.</li><li>Tab. 4 에 나타난 바와 같이, source dataset 에서의 최고의 transferability 외에도 TVP 는 other dataset 에서 가장 많은 또는 비교 가능한 개선을 이루어내며, same task 내에서 다양한 dataset 간의 우수한 generalization 을 보여준다.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="453-robustness-to-corruptions">4.5.3 Robustness to Corruptions<a href="#453-robustness-to-corruptions" class="hash-link" aria-label="Direct link to 4.5.3 Robustness to Corruptions" title="Direct link to 4.5.3 Robustness to Corruptions">​</a></h3><p>visual prompt 가 common image corruptions 에 대한 robustness 를 test.</p><p>MiniGPT-4 에서 TVP 로 생성된 visual prompt 는 CIFAR-10-C 에서 평균 2.30% 의 성능 개선을 보였으며, VP 와 EVP 는 각각 -6.62% 와 -3.87% 의 성능 저하를 초래했다.</p><p><img loading="lazy" alt="Table 9" src="/assets/images/image-116-568e08cc9753db88dd49162e640c75ce.png" width="1164" height="539" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="46-계산-효율성에-대한-논의-discussion-on-computational-efficiency">4.6. 계산 효율성에 대한 논의 (Discussion on Computational Efficiency)<a href="#46-계산-효율성에-대한-논의-discussion-on-computational-efficiency" class="hash-link" aria-label="Direct link to 4.6. 계산 효율성에 대한 논의 (Discussion on Computational Efficiency)" title="Direct link to 4.6. 계산 효율성에 대한 논의 (Discussion on Computational Efficiency)">​</a></h3><p>TVP 와 other fine-tuning 및 visual prompt 방법의 성능과 효율성을 비교하여 제안된 문제와 TVP 의 대응 솔루션의 동기를 지원한다.</p><p><img loading="lazy" alt="Table 5" src="/assets/images/image-117-02427d13a0ad4ccbbd59dd04b8a41683.png" width="572" height="265" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="5-결론-conclusion">5. 결론 (Conclusion)<a href="#5-결론-conclusion" class="hash-link" aria-label="Direct link to 5. 결론 (Conclusion)" title="Direct link to 5. 결론 (Conclusion)">​</a></h3><p>본 논문에서는 다양한 MLLM 을 downstreamn task 에 adapting 하기 위한 resource-friendly 및 flexible manner 로 <em>shared parameters</em> set 을 optimizing 하는 방법 제안</p><p>이는 model-specific fine-tuning 으로 인한 computation 및 storage overhead 를 피할 수 있다.</p><p>구체적으로, <strong>Transferable Visual Prompting</strong> 을 도입하여 visual prompt 를 shared parameter 로 채택하고, one model 에 대한 one-time training 으로 transferability 를 향상시키는 방법을 제안.</p><p>기존의 visual prompt 방법은 일반적으로 feature corruption 으로 인해 uinseen models 를 개선하는 데 실패한다.</p><p>저자는 이를 Feature Consistency Alignment 와 Task Semantics Enrichment 라는 두 가지 주요 전략으로 해결하여 large-scale pre-trained model 의 inner prior knowledge 를 유지하고 모델에서 추출한 task-related features 를 강화한다.</p><p>recognition 및 counting 에서 multimodal reasoning 및 hallucination correction 에 이르기까지 다양한 task 의 10 dataset 에 대한 광범위한 실험을 통해 제안된 TVP 의 효과성을 입증하였으며, 다양한 모델을 동시에 촉진할 수 있음을 보여줌.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/tvp">TVP</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/visual-prompt">Visual Prompt</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/multi-modality">MultiModality</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/pixel-level">Pixel-Level</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/model-agnostic">model-agnostic</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/model-integration">model integration</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/2024-04-TVP.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/AdaViPro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">AdaViPro: Region-Based Adaptive Visual Prompt For Large-Scale Models Adapting</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/SMM"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sample-specific Masks for Visual Reprogramming-based Prompting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#21-multimodal-large-language-models" class="table-of-contents__link toc-highlight">2.1. Multimodal Large Language Models</a></li><li><a href="#22-adaptation-for-large-scale-pre-trained-models" class="table-of-contents__link toc-highlight">2.2. Adaptation for Large-Scale Pre-trained Models</a></li><li><a href="#31-preliminaries" class="table-of-contents__link toc-highlight">3.1. Preliminaries</a></li><li><a href="#32-problem-formulation" class="table-of-contents__link toc-highlight">3.2. Problem Formulation</a></li><li><a href="#33-transferable-visual-prompting" class="table-of-contents__link toc-highlight">3.3. Transferable Visual Prompting</a><ul><li><a href="#331-feature-consistency-alignment" class="table-of-contents__link toc-highlight">3.3.1. Feature Consistency Alignment</a></li><li><a href="#332-task-semantic-enrichment" class="table-of-contents__link toc-highlight">3.3.2. Task Semantic Enrichment</a></li></ul></li><li><a href="#41-experimental-settings" class="table-of-contents__link toc-highlight">4.1. Experimental Settings</a></li><li><a href="#42-main-results" class="table-of-contents__link toc-highlight">4.2. Main Results</a></li><li><a href="#43-model-ensemble" class="table-of-contents__link toc-highlight">4.3. Model Ensemble</a></li><li><a href="#44-ablation-studies" class="table-of-contents__link toc-highlight">4.4. Ablation Studies</a><ul><li><a href="#441-strategies-of-fca-and-tse" class="table-of-contents__link toc-highlight">4.4.1 Strategies of FCA and TSE</a></li><li><a href="#442-prompt-width" class="table-of-contents__link toc-highlight">4.4.2 Prompt Width</a></li></ul></li><li><a href="#45-in-depth-analyses" class="table-of-contents__link toc-highlight">4.5. In-depth Analyses</a><ul><li><a href="#452-generalization-across-datasets" class="table-of-contents__link toc-highlight">4.5.2 Generalization across Datasets</a></li><li><a href="#453-robustness-to-corruptions" class="table-of-contents__link toc-highlight">4.5.3 Robustness to Corruptions</a></li><li><a href="#46-계산-효율성에-대한-논의-discussion-on-computational-efficiency" class="table-of-contents__link toc-highlight">4.6. 계산 효율성에 대한 논의 (Discussion on Computational Efficiency)</a></li><li><a href="#5-결론-conclusion" class="table-of-contents__link toc-highlight">5. 결론 (Conclusion)</a></li></ul></li></ul></div></div></div><div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Won-Yong Jo, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.abd6514d.js"></script>
<script src="/assets/js/main.b2b09391.js"></script>
</body>
</html>