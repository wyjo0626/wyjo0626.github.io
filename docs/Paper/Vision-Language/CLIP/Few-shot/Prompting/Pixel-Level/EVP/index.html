<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/2022-12-EVP">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Unleashing the Power of Visual Prompting At the Pixel Level | WYJLab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Unleashing the Power of Visual Prompting At the Pixel Level | WYJLab"><meta data-rh="true" name="description" content="논문 및 이미지 출처 :"><meta data-rh="true" property="og:description" content="논문 및 이미지 출처 :"><link data-rh="true" rel="icon" href="/img/WYJLab.ico"><link data-rh="true" rel="canonical" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP" hreflang="en"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="WYJLab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="WYJLab Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9ed678b7.css">
<link rel="preload" href="/assets/js/runtime~main.dc82af9c.js" as="script">
<link rel="preload" href="/assets/js/main.07c26eea.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/WYJLab.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/WYJLab.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WYJLab</b></a><a class="navbar__item navbar__link" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Paper</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Computer Vision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Machine Learning/Regularization/Dropout/Dropout">Machine Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Multi-Modal/PEFT/Composition/Moka">Multi-Modal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/NLP/Analysis/Contextualized Representation">NLP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Survey/Prompting">Survey</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">Vision-Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">CLIP</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">Few-shot</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">Composition</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Module/CLIP-Adapter">Module</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Multi-Modality/MaPLe">Multi-Modality</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/CMAR">Prompting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/CMAR">Pixel-Level</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/CMAR">Cross-modal Adversarial Reprogramming</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/VP">Exploring Visual Prompts for Adapting Large-Scale Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/Watermarking">Watermarking for Out-of-distribution Detection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/ILM-VP">Understanding and Improving Visual Prompting: A Label-Mapping Perspective</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP">Unleashing the Power of Visual Prompting At the Pixel Level</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/DAM-VP">Diversity-Aware Meta Visual Prompting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/EVP-L">Explicit Visual Prompting for Low-Level Structure Segmentations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/HinTAug">Hint-Aug: Drawing Hints from Foundation Vision Transformers towards Boosted Few-shot Parameter-Efficient Tuning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/AutoVP">AutoVP: An Automated Visual Prompting Framework and Benchmark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/A2XP">A2XP: Towards Private Domain Generalization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/InMeMo">Instruct Me More! Random Prompting for Visual In-Context Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/LaViP">LaViP: Language-Grounded Visual Prompts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/AdaViPro">AdaViPro: Region-Based Adaptive Visual Prompt For Large-Scale Models Adapting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/TVP">Exploring the Transferability of Visual Prompting for Multimodal Large Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-7 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/SMM">Sample-specific Masks for Visual Reprogramming-based Prompting</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Textual-Token/CoOp">Textual-Token</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-6 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Visual-Token/VPT">Visual-Token</a></div></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Foundation/Contrastive Learning/ALIGN">Foundation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/VQA Few-shot">VQA-IC</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Programming/Algorithm/">Programming</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Paper</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Vision-Language</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">CLIP</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Few-shot</span><meta itemprop="position" content="4"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Prompting</span><meta itemprop="position" content="5"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Pixel-Level</span><meta itemprop="position" content="6"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Unleashing the Power of Visual Prompting At the Pixel Level</span><meta itemprop="position" content="7"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Unleashing the Power of Visual Prompting At the Pixel Level</h1></header><p>논문 및 이미지 출처 : <a href="https://arxiv.org/pdf/2212.10556" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/2212.10556</a></p><h1>Abstract</h1><p>본 논문은 pre-trained model 을 downstream recognition tasks 에 adapting 하기 위한 간단하고 효과적인 visual prompting 방법 제시</p><p>두 가지 주요 설계 포함:</p><p>1) prompt 와 image 를 직접 더하는 대신, prompt 를 independent trainable component 로 취급</p><ul><li>prompt 와 image 를 조화시키는 전략이 중요하다는 것을 보여주고, 적절히 축소된 image 주위에 prompt 를 변형시키는 것이 경험적으로 가장 잘 작동하는 것을 발견</li></ul><p>2) transferable adversarial examples 를 구축할 때, 흔히 사용되는 two &quot;old tricks&quot;, 즉 input diversity 및 gradient normalization 를 visual prompting 에 re-introduction</p><ul><li>이런 기술은 최적화를 개선하고 prompt 가 더 잘 일반화되도록 함</li></ul><p>이 방법의 효과를 입증하기 위해 광범위한 실험 결과를 제공한다.</p><p>CLIP model 을 사용하여, 저자의 prompting 을 12 popular classification dataset 에서 평균 정확도 82.5% 의 새로운 기록을 세워, 이전 기술을 +5.2% outperform 달성.</p><p>주목할 점은, 이 prompt 성능이 linear probing 을 +2.2% outperform 하고 특정 dataset 에선 full fine-tuning 과 일치할 수 있다는 것.</p><p>또한, 저자의 prompting 은 다양한 data-scale 및 distribution shift 에 competitive performance 를 보여줌</p><h1>1. Introduction</h1><p>vision 및 language processing 모두에서 성공하기 위한 경로로서 점점 large-scale dataset 에서의 pre-training 을 경험한다.</p><p>이런 pre-trained model 들은 foundation models 로 불린다.</p><p>fully fine-tuning 은 이러한 foundation models 를 다양한 downstream task 에 효과적으로 adapting 하기 위한 가장 널리 퍼진 패러다임 중 하나로, 많은 parameters 로 인해 계산 비용이 많이 든다. </p><p>이는 foundation models 을 new task 에 adapting 하기 위한 더 효율적인 대안이 필요로 하게 만든다.</p><p>input space 만 수정하는 <em>Prompting</em>  은 NLP 에서 효과적이고 효율적인 해결책을 제공한다. 예로, text prompting 은 fully fine-tuning 에 근접한 성능을 나타낼 수 있다.</p><p>이 유망한 결과는 연구자들로 하여금 computer vision 분야에도 유사한 성공을 이룰 수 있는지 조사하게 만든다.</p><p>이 방향에서의 초기 노력으로는 VPT 와 VP 가 있으며, 이는 foundation model 을 adapting 하기 위해 pixel level 에서 token 이나 perturbation 을 직접 추가하는 small learnable parameters 를 추가한다.</p><p><img loading="lazy" alt="Figure 1" src="/assets/images/image-13-0f83855665e82d908574cc8a38ca2b3b.png" width="687" height="590" class="img_ev3q"></p><p>하지만 performance 와 parameter efficiency 간의 trade-off 를 면밀히 살펴보면 (Fig. 1), 이러한 advanced visual prompt 방법들이 less competitive 한 것으로 나타난다.</p><p>예로, comparable parameters 를 가짐에도, VPT 와 simple linear probe baseline 사이에는 상당한 격차가 있다 (77.3% vs 80.3%).</p><p>본 논문은 visual prompt 의 full potential 을 pixel level 에서 발휘하고, 나아가 linear probing 과 같은 다른 대안들보다 더 강력할 수 있는지 탐구한다.</p><hr><p>흥미롭게, 적절한 수정과 함께 visual prompting 은 foundation model 을 다양한 visual tasks 에 adapting 하는 데 있어 효과적인 패러다임으로 변모할 수 있음을 발견</p><p>1) VP 와 같이 prompt 와 image 를 직접 더하는 것이 original image information 을 손상시켜 prompt 의 학습을 제한할 수 있다.</p><ul><li>이를 해결하기 위한 간단한 전략으로, 저자는 original image 를 더 작은 크기로 축소한 후, prompt 를 주위에 padding 한다.</li><li>즉, prompt 와 image 는 겹치지 않고 서로 분리되어 유지</li><li>이 전략은 prompt 의 independent optimization 를 가능케 하고, padding size 를 조정하여 computation overheads 를 제어할 수 있는 flexibility 제공</li></ul><p>2) loss function 의 maximizing 또는 minimizing 을 목표로 하는 adversarial examples 에서 유사한 기술을 도입하여 visual prompt 의 성능을 향상시킴</p><ul><li>구체적으로, gradient normalization 과 input diversity 가 prompt 의 generalization 능력을 향상시키는데 더 효과적임을 발견</li></ul><hr><p>저자는 standard protocol 을 따라 12 visual benchmark 에서 실험 수행</p><ul><li>CLIP 을 사용한 결과, 저자의 방법이 average accuracy 82.5% 를 달성하여 이전의 visual prompting 인 VPT 를 +5.2% outperform</li><li>더욱 흥미로운 것은 이 82.5% 결과가 linear probing (80.3%) 보다 +2.2% 강력하며, 특정 dataset 에선 fully fine-tuning 과도 comparable 한 것이다.</li><li>다양한 data-scale 과 distribution shift 처리하는 데 있어 저자의 방법이 우수함을 확인</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-related-work">2. Related Work<a href="#2-related-work" class="hash-link" aria-label="Direct link to 2. Related Work" title="Direct link to 2. Related Work">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="prompt-learning-in-nlp">Prompt learning in NLP<a href="#prompt-learning-in-nlp" class="hash-link" aria-label="Direct link to Prompt learning in NLP" title="Direct link to Prompt learning in NLP">​</a></h4><p>prompt 핵심 아이디어는 input text 를 downstream task 에 맞게 재구성하여 frozen language model 이 task 를 더 잘 &quot;<em>understand</em>&quot; 하고 수행할 수 있도록 하는 것.</p><p>이전의 수동 설계 text prompt 가 downstream task 에서 few-shot 또는 zero-shot setting 에서 뛰어난 표현 능력을 발휘할 수 있도록 도와준다 보지만, 이는 특정 domain knowledge 가 필요로 한다.</p><p>이를 해결하기 위해, prompt tuning 에 집중하기 시작하여, gradient information 을 통해 continuous prompt vector 를 직접 optimizing 하는 것을 포함한다.</p><p>본 연구에선 computer vision 에서의 prompt learning 을 조사하는데, 이는 언어가 아닌 시각적 신호를 포함하며, high-level semantic information 을 훨씬 적게 포함하기 때문에 더 어려운 task 다.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="visual-prompt-learning">Visual prompt learning<a href="#visual-prompt-learning" class="hash-link" aria-label="Direct link to Visual prompt learning" title="Direct link to Visual prompt learning">​</a></h4><p>prompt 성공 후, computer vision 분야에서 prompt 사용을 탐구하기 시작. 예로, CoOp 은 vision-language model 에 prompt tuning 을 적용하여 downstream task 에서 classification loss 를 minimizing 하여 soft prompt 학습.</p><p>VP 와 VPT 는 image 와 함께 prompt 를 사용하는데 초점을 두고 있음: VP 는 pixel space 에서 prompt 를 직접 최적화하고, VPT 는 ViT 에 learnable token set 을 삽입하여 prompt tuning 제안.</p><p>이런 방법들은 visual prompt learning 의 잠재력을 보여주지만, Fig. 1 처럼, linear probing 과 같은 다른 방법에 비해 성능이 그다지 경쟁력 있지 않다.</p><p>본 연구에선 visual prompt learning 을 강화하고 foundation model 이 다양한 visual task 에서 성능을 향상시킬 수 있는 강력한 잠재력을 입증하는 것을 목표로 한다.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="adversarial-examples">Adversarial examples<a href="#adversarial-examples" class="hash-link" aria-label="Direct link to Adversarial examples" title="Direct link to Adversarial examples">​</a></h4><p>machine learning model 은 adversarial attacks 에 취약함이 알려져 있다.</p><p>fast gradient sign method (FGSM) 과 projected gradient descent (PGD) 는 deep learning model 을 속일 수 있는 adversarial examples 를 생성하기 위해 일반적으로 사용되는 기술이다.</p><p>그러나 이러한 adversarial examples 는 다른 모델을 속이는 데 잘 transfer 되지 않는다.</p><p>이후 연구들은 adversarial examples 의 optimizing 어려움이 이러한 weak transferability 의 원인임을 보여주었으며, 다양한 input patterns 및 momentum-based gradient accumulation 같은 기술이 transferability 를 향상시키기 위해 제안되었다.</p><p>adversarial examples 생성과 prompt learning 사이의 유사성을 고려하여, 저자는 transferable adversarial examples 를 구축하는 기술을 재검토하여 visual prompting 강화에 관심을 가진다.</p><h1>3. Methodology</h1><p><img loading="lazy" alt="Figure 2" src="/assets/images/image-14-d65202d38480e6afb8b0eaef853bcbc4.png" width="1354" height="826" class="img_ev3q"></p><p>foundation model 을 downstream task 에 맞추기 위한 단순하고 효과적인 pixel level 의 visual prompt 방법인 Enhanced Visual Prompting (EVP) 를 제시한다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-preliminaries">3.1. Preliminaries<a href="#31-preliminaries" class="hash-link" aria-label="Direct link to 3.1. Preliminaries" title="Direct link to 3.1. Preliminaries">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="vpt">VPT<a href="#vpt" class="hash-link" aria-label="Direct link to VPT" title="Direct link to VPT">​</a></h4><p>ViT 에 learnable parameters set 을 추가하여 visual prompt 를 수행한다.</p><p>공정한 비교를 위해 여기선 first layer 의 input 에만 prompt 를 삽입하는 VPT-Shallow 버전을 고려한다.</p><p>구체적으로, Fig. 2(a) 처럼, VPT 는 learnable class token <!-- -->[CLS]<!-- --> 와 patch embedding <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span></span></span> sequence 사이에 prompts <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span></span></span></span></span> 를 삽입하여 new input <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy="false">[</mo><mtext>CLS</mtext><mo separator="true">,</mo><mi>P</mi><mo separator="true">,</mo><mi>E</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">x = [\text{CLS}, P, E]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord text"><span class="mord">CLS</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mclose">]</span></span></span></span></span> 를 생성</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="vp">VP<a href="#vp" class="hash-link" aria-label="Direct link to VP" title="Direct link to VP">​</a></h4><p>learnable prompt 와 input image 를 pixel level 에서 직접 더하여 foundation model 을 downstream task 에 맞춘다.</p><p>prompt <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>ϕ</mi></msub></mrow><annotation encoding="application/x-tex">v_\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 는 input-agnostic 및 task-specific 으로 설계되어, Fig. 2(b) 처럼 input image 의 border 에 배치된다.</p><p>training 중, prompt <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>ϕ</mi></msub></mrow><annotation encoding="application/x-tex">v_\phi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7167em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 를 optimizing 하여 correct label <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span> 의 lokelihood 를 maximizing 한다: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><msub><mi>x</mi><msub><mi>v</mi><mi>ϕ</mi></msub></msub><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo>+</mo><msub><mi>v</mi><mi>ϕ</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">max_{v_\phi} P(y|x + v_\phi)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1031em;vertical-align:-0.3531em"></span><span class="mord mathnormal">ma</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2901em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3531em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.</p><p>inference 중, optimized prompt 가 test image 에 추가된다: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow></msub><mo>=</mo><mo stretchy="false">{</mo><msubsup><mi>x</mi><mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mn>1</mn></msubsup><mo>+</mo><msub><mi>v</mi><mi>ϕ</mi></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msubsup><mi>x</mi><mrow><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi></mrow><mi>n</mi></msubsup><mo>+</mo><msub><mi>v</mi><mi>ϕ</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X_{test} = \{ x^1_{test} + v_\phi, \dots, x^n_{test} + v_\phi \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.9505em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">es</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">ϕ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-designing-evp">3.2. Designing EVP<a href="#32-designing-evp" class="hash-link" aria-label="Direct link to 3.2. Designing EVP" title="Direct link to 3.2. Designing EVP">​</a></h2><p>설계는 VP 에 기반하지만, 몇 가지 간단한 수정이 있다.</p><p>VP 의 문제는 prompt 와 image 를 직접 합치면서 original image information 에 손상이 있다는 점이다.</p><p>예로, Fig. 2(b) 의 고양이 귀가 added prompt 에 의해 크게 겹쳐져 가려진다. 이는 prompt learning 을 방해할 수 있다. (section 5.1 ablation 참고)</p><p>이를 해결하기 위해, Fig. 2(c) 처럼, EVP 는 input image 를 축소하고 그 주위에 prompt 를 padding 한다.</p><ul><li>구체적으로, input image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>K</mi><mo>×</mo><mi>K</mi><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">X \in \mathbb{R}^{K \times K \times 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span> 를 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>^</mo></mover><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>k</mi><mo>×</mo><mi>k</mi><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{x} \in \mathbb{R}^{k \times k \times 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal">x</span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.2222em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8491em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span>$ 으로 축소한 다음, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msup><mi>K</mi><mn>2</mn></msup><mo>−</mo><msup><mi>k</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mo>×</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">(K^2 - k^2) \times 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1.0641em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">3</span></span></span></span></span> prompt 로 padding 하여 output image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>X</mi><mo>^</mo></mover><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>K</mi><mo>×</mo><mi>K</mi><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{X} \in \mathbb{R}^{K \times K \times 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9859em;vertical-align:-0.0391em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.07847em">X</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1667em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span> 를 얻는다</li><li>VP 와 유사하게, training 중 prompt 를 optimizing 하여 correct label 의 likelihood 를 최대화하고, inference 중 optimized prompt 를 shrunk test samples 주위에 padding 하여 예측에 사용한다.</li></ul><p>EVP 와 VPT 모두 prompt 와 image 를 겹치지 않게 유지하지만, 중요한 차이 존재</p><p>EVP 의 prompt 는 나중에 positional embedding 이 함께 추가되지만, VPT 에서는 그렇지 않다.</p><p>section 5.2 의 ablation study 에 보이듯, positional information 은 visual prompting 에서 강력한 성능을 달성하는데 중요하다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="33-training-strategy-of-evp">3.3 Training Strategy of EVP<a href="#33-training-strategy-of-evp" class="hash-link" aria-label="Direct link to 3.3 Training Strategy of EVP" title="Direct link to 3.3 Training Strategy of EVP">​</a></h2><p>prompting 과 adversarial attack 사이엔 strong relationship 이 있다.</p><p>adversarial attacks 에선 주어진 image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 에 대해 network 를 오도할 pixel perturbation <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>g</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">g_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 학습하는 것이 목표다.</p><p>이를 공식화하면 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>min</mi><mo>⁡</mo></mrow><msub><mi>g</mi><mi>i</mi></msub></msub><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><msub><mi>g</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min_{g_i}P(y_i | x_i + g_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mop"><span class="mop">min</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3281em"><span style="top:-2.357em;margin-left:-0.0359em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>.</p><p>visual prompting 은 adversarial attacks 의 역과정으로 볼 수 있으며, 이 목표는 correct label <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span> 의 likelihood 를 maximizing 할 template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span> 를 학습하는 것이다.</p><p>이 관계를 고려하여, adversarial attacks 에서 사용되는 기술, 특히 transferable adversarial examples 를 구축하는데 중점을 둔 기술이 visual prompting 에 유용할 수 있는지 탐구</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="input-diversity">Input diversity<a href="#input-diversity" class="hash-link" aria-label="Direct link to Input diversity" title="Direct link to Input diversity">​</a></h4><p>이전 연구 <a href="https://openaccess.thecvf.com/content_CVPR_2019/papers/Xie_Improving_Transferability_of_Adversarial_Examples_With_Input_Diversity_CVPR_2019_paper.pdf" target="_blank" rel="noopener noreferrer">DI-2-FGSM</a> 에선 input diversity 가 optimization 에 도움되며, adversarial examples 의 transferability 를 향상시킬 수 있음을 보여준다.</p><p>이후 연구에선 &quot;diverse input&quot; 의 개념이 다양한 data augmentation 전략을 적용하여 adversarial examples 를 생성하는 것으로 일반화될 수 있음을 보여주었다.</p><p>저자는 이 개념을 visual prompting 에 다시 도입한다.</p><p>구체적으로, EVP 는 RandomHorizontalFlip, RandAug, Cutmix 를 포함한 다양한 augmentation 을 고려한다.</p><p>Section 5.3 처럼, RandomHorizontalFlip 과 같은 simple augmentation 전략만으로도 visual prompting 을 크게 향상시킬 수 있음을 발견</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="gradient-normalization">Gradient normalization<a href="#gradient-normalization" class="hash-link" aria-label="Direct link to Gradient normalization" title="Direct link to Gradient normalization">​</a></h4><p>adversarial attacks 에선 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">L_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, 또는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">L_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm 과 같은 normalization 기법을 gradient update 에 적용하는 것이 일반적이다.</p><p>예로, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm 을 사용하여, gradient 는 normalizing 된다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>x</mi><mrow><mi>a</mi><mi>d</mi><mi>v</mi></mrow></msup><mo>=</mo><mi>x</mi><mo>+</mo><mi>γ</mi><mfrac><mrow><msub><mi mathvariant="normal">▽</mi><mi>x</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">▽</mi><mi>x</mi></msub><mi>J</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">∣</mi><mn>2</mn></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} x^{adv} = x + \gamma \frac{\triangledown_xJ(x,y)}{|| \triangledown_xJ(x,y) ||_2}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.9315em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4315em"><span style="top:-3.4315em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣∣</span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9315em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4315em"><span style="top:-3.4315em"><span class="pstrut" style="height:3.427em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9315em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span></span></span></span></span> : learning rate</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>J</mi></mrow><annotation encoding="application/x-tex">J</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span></span> : loss function</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">▽</mi><mi>x</mi></msub><mi>J</mi></mrow><annotation encoding="application/x-tex">\triangledown_xJ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span></span> : input <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span> 에 관한 loss function 의 gradient</li></ul><p>저자는 visual prompting 에 gradient normalization 을 도입</p><p>EVP 의 matrix representation 을 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mi>e</mi></msub><mo>=</mo><mi>W</mi><mo>⊙</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">V_e = W \odot M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span></span> 을 정의한다.</p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>K</mi><mo>×</mo><mi>K</mi><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">W \in \mathbb{R}^{K \times K \times 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span> : prompt parameters</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>K</mi><mo>×</mo><mi>K</mi><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">M \in \mathbb{R}^{K \times K \times 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span> : mask matrix</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⊙</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6667em;vertical-align:-0.0833em"></span><span class="mord">⊙</span></span></span></span></span> : element-wise matrix product</li><li>mask matrix <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span></span> : prompt 의 spatial location 을 encoding</li><li>size <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>×</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">k \times k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> 의 central 은 모두 0 이고 나머지 모두는 1</li></ul><p>실제로, EVP 의 gradient 를 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span></span></span></span></span> 의 gradient 의 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm 으로 나누는 것이 best performance 를 발휘함을 발견</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mi>V</mi><mi>e</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo>=</mo><msubsup><mi>V</mi><mi>e</mi><mi>t</mi></msubsup><mo>−</mo><mi>γ</mi><mfrac><mrow><msub><mi mathvariant="normal">▽</mi><msubsup><mi>V</mi><mi>e</mi><mi>t</mi></msubsup></msub><mi>J</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">▽</mi><mi>W</mi></msub><mi>J</mi><mi mathvariant="normal">∣</mi><msub><mi mathvariant="normal">∣</mi><mn>2</mn></msub></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} V^{t+1}_e = V^t_e - \gamma \frac{\triangledown_{V^t_e}J}{|| \triangledown_WJ ||_2}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3725em;vertical-align:-0.9362em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4362em"><span style="top:-3.4362em"><span class="pstrut" style="height:3.4365em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-2.453em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8436em"><span style="top:-2.453em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4365em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">∣∣</span><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span><span class="mord">∣</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.7531em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord amsrm">▽</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.5371em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7253em"><span style="top:-2.214em;margin-left:-0.2222em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">e</span></span></span><span style="top:-2.786em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3631em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.09618em">J</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9362em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4362em"><span style="top:-3.4362em"><span class="pstrut" style="height:3.4365em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9362em"><span></span></span></span></span></span></span></span></span></div><p>다양한 normalization 전략의 albation 및 상세한 결과는 section 5.3</p><h1>4. Experiments</h1><h4 class="anchor anchorWithStickyNavbar_LWe7" id="datasets">Datasets.<a href="#datasets" class="hash-link" aria-label="Direct link to Datasets." title="Direct link to Datasets.">​</a></h4><p>visual prompting 을 12 downstream classification datasets 에 평가:  CIFAR100, CIFAR10, Flowers102, Food101, EuroSAT, SUN397, SVHN, DTD, OxfordPets, Resisc45, CLEVR, 및 DMLab.</p><p>추가적으로, visual prompting 을 out-of-distribution dataset 에 대한 robustness (Camelyon17, FMoW, 및 iWildCAM), 그리고 2 corruption datasets (CIFAR100-C 및 CIFAR10-C) 에서 테스트</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="baselines">Baselines.<a href="#baselines" class="hash-link" aria-label="Direct link to Baselines." title="Direct link to Baselines.">​</a></h4><p>EVP 의 성능을 TP (text prompting), VP, VPT, LP (linear probing) 및 FT (fully fine-tuning) 등 다른 일반적인 prompting 및 fine-tuning protocol 과 비교.</p><p>구체적으로, 다음을 주목:</p><p>1) TP 는 CLIP 의 zero-shot 과 동등</p><p>2) LP 는 classification head 로 linear layer 사용</p><p>3) FT 는 backbone 및 classification head 의 all parameters 업데이트</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="41-clip">4.1. CLIP<a href="#41-clip" class="hash-link" aria-label="Direct link to 4.1. CLIP" title="Direct link to 4.1. CLIP">​</a></h2><p>VP protocol 을 따라, 12 classification datasets 에서 CLIP-Base/32 model 을 사용하여 평가를 수행.</p><p><img loading="lazy" alt="Table 1" src="/assets/images/image-15-1c26f42e23cd870175849f3a34281333.png" width="2473" height="637" class="img_ev3q"></p><p><img loading="lazy" alt="Figure 3" src="/assets/images/image-16-0878231bc7922a8bb87c5e686ad25be1.png" width="3082" height="1161" class="img_ev3q"></p><p>Tab. 1 에 전체 결과가 있으며, two strong baselines 인 LP 및 VPT 와의 상세 비교는 Fig. 3 에 있다.</p><ul><li>EVP 는 일관되게 이전 prompting 방법들과 유사하거나 fewer parameters 로 능가한다.</li><li>평균적으로, EVP 는 VP 보다 6.0%, VPT 보다 5.4% 향상 보임</li></ul><p>효과성 추가 평가를 위해, 널리사용되는 fine-tuning protocol 인 linear probing 과 EVP 비교.</p><p>Tab. 1 및 Fig. 3 결과에 따르면,</p><ul><li>EVP 는 12 datasets 중 7 에서 linear probing 을 능가</li><li>평균적으로, EVP 는 82.5% accuracy 달성. 이는 linear probing 보다 2.2% 높은 수치</li><li>또한 padding size 를 조정하여 parameter 수를 쉽게 조절 가능하여 더욱 flexible</li><li>반면, linear probing 의 parameter 수는 downstream task 의 class categories 의 수에 의존된다.</li></ul><p>마지막으로, </p><ul><li>EVP 는 fully fine-tuning 과 비교하여 상당히 parameter efficient 하며, parameter 수는 단 0.04% 에 불과</li><li>두 방법 간에는 여전히 performance gap 존재, EVP 평균 정확도는 82.5% 이고 fully fine-tuning 은  88.1% 이다</li><li>하지만, EVP 는 CIFAR100, CIFAR10, EuroSAT, DMLab, Pets 를 포함한 일부 dataset 에서 유사한 결과를 얻거나 능가하는 성능을 보임</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="42-non-clip-models">4.2. Non-CLIP Models<a href="#42-non-clip-models" class="hash-link" aria-label="Direct link to 4.2. Non-CLIP Models" title="Direct link to 4.2. Non-CLIP Models">​</a></h2><p>이 섹션에선 non-CLIP models 에서 EVP 의 효과 평가.</p><p>non-CLIP model 을 downstream task 에 adapting 하는데 하나의 어려움은 original classification head 가 의미적으로 덜 의미있거나 predefined classes 으로 mapping 된다는 것.</p><p>VP 에서 사용된 direct 및 naive solution 은 downstream classes 를 pre-trained classe 에 임의로 매핑하고 할당되지 않은 classes 를 폐기하는 것이다.</p><p>하지만 저자는 pre-trained 및 downstream classes 간에 정확한 대응 관계가 알려져 있지 않더라도 similarity 가 존재할 수 있다고 가정한다.</p><p>이는 visual prompting 을 구현하기 전에 potential similarity 를 활용하기 위해 pre-processing stage 를 제안한다.</p><ul><li>구체적으로, 각 downstream class 에 대해, 해당 class 의 downstream images 를 pre-trained model 에 주입하고 pre-trained classes 에서의 예측을 조사</li><li>이후, highest prediction frequency 의 pre-trained class 의 corresponding class 로 간단히 선택한다</li><li>pre-processing 후, correspondence 를 fix 하고 visual prompting method 를 학습</li></ul><p><img loading="lazy" alt="Table 2" src="/assets/images/image-17-55abcd40872cf6f9d03beae04456336a.png" width="2171" height="768" class="img_ev3q"></p><p>전반적으로, Tab. 2 의 결과는 non-CLIP model 을 downstream task 에 적응시키는데 있어 EVP 의 효과를 보여줌</p><ul><li>arbitrary mapping 을 사용할 때, EVP 의 성능이 baseline VP 보다 이미 향상되었지만 (~ 2%), pre-processing stage 를 사용하면 EVP 의 성능이 더욱 크게 향상된다.</li><li>예로, Instagram pre-training model 에선 33.9% 에서 50.4% 로, ImageNet-train ResNet-50 에선 28.6% 에서 41.3%로 향상</li><li>그러나, EVP* 의 성능은 Flowers102 및 Food101 같은 fine-grained dataset 에선 강력하지 않음을 주목</li><li>이는 이러한 유형의 task 에서 pre-trained class 와 downstream classes 간의 correspondence 를 찾는 것이 더 어려울 수 있음을 시사</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="43-robustness">4.3. Robustness<a href="#43-robustness" class="hash-link" aria-label="Direct link to 4.3. Robustness" title="Direct link to 4.3. Robustness">​</a></h2><p>EVP 의 robustness 를 다른 prompting 및 fine-tuning protocol 과 비교.</p><p>EVP 의 robustness 를 out-of-distribution (OOD) 및 corruption dataset 에서 평가</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ood-robustness">OOD robustness<a href="#ood-robustness" class="hash-link" aria-label="Direct link to OOD robustness" title="Direct link to OOD robustness">​</a></h4><p>WILDS benchmark 를 사용하여 EVP 의 distribution shift 에 대한 robustness 를 테스트</p><p>모델은 specific domain 에서 학습되고 different domain 에서 평가. 예로, different regions, cameras 및 hospital</p><p><img loading="lazy" alt="Table 3" src="/assets/images/image-18-c052b132599e4622f163cd667e65eabb.png" width="2708" height="671" class="img_ev3q"></p><p>Tab. 3 결과는,</p><ul><li>EVP 가 다른 prompting 을 최소 4.5% 능가함을 보여줌</li><li>이 설정에선 EVP 는 linear probing (+3.7%) 및 fully fine-tuning (+0.7%) 뛰어넘음</li><li>EVP 가 OOD 외 sample 을 처리하는 데 잠재력을 갖고 있음을 강조</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="robustness-on-corruption-datasets">Robustness on corruption datasets.<a href="#robustness-on-corruption-datasets" class="hash-link" aria-label="Direct link to Robustness on corruption datasets." title="Direct link to Robustness on corruption datasets.">​</a></h4><p>이는 EVP 의 robustness 를 common image corruptions 에 평가한다.</p><p>CIFAR100-C 및 CIFAR10-C corruption dataset 에서 EVP 를 테스트하며, 이는 각각 19 common image corruptions 를 CIFAR100 및 CIFAR10 dataset 에 적용한 것이다.</p><p>CIFAR100 및 CIFAR10 dataset 에서 EVP 를 학습한 후 해당 corruption dataset 에서 성능을 평가</p><p>평균 정확도는 Tab. 3 에 보고</p><ul><li>EVP 가 다른 prompting 및 linear probing 보다 큰 차이로 뛰어남을 확인</li><li>EVP 가 commonm image corruption 처리에 fully fine-tuning 과 비슷한 성능을 보임을 주목<ul><li>즉, 71.5% vs 71.9%. </li></ul></li><li>이는 image 에 대한 corruption 이 다른 baseline 의 성능을 저하시킬 수 있는 반면, prompt 를 independent component 로 취급하는 전략이 이 문제를 완화할 수 있기 때문<ul><li>즉, EVP 의 prompt 는 inference 중 corrupted images 와 직접 결합되지 않고 주위에 padding 됨</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="44-different-data-scales">4.4 Different Data Scales<a href="#44-different-data-scales" class="hash-link" aria-label="Direct link to 4.4 Different Data Scales" title="Direct link to 4.4 Different Data Scales">​</a></h2><p>이 섹션에선, EVP 의 성능을 다양한 data scales 에서 평가</p><p>저자는 EVP 를 각 class 에 대해 training data 가 1%, 4%, 7%, 10% 만 사용하여 학습</p><p>이는 few-shot learning 이 NLP 에서 prompting 의 중요한 측면이기 때문에, 흥미로운 부분임.</p><p>저자는 EVP 가 제한된 데이터로도 강력한 성능을 발휘할 수 있는지 검증한다.</p><p><img loading="lazy" alt="Figure 4" src="/assets/images/image-19-66e17056dcbe7858cd51115a55297c7b.png" width="2714" height="2007" class="img_ev3q"></p><p>평균 정확도 및 각 데이터셋의 결과는 Fig. 4 에 있음. 이를 통해 다음을 관찰한다.</p><ul><li>visual prompting (VP, VPT, EVP)은 일관되게 linear probing 보다 뛰어나며, 이는 제한된 라벨 데이터로 학습하는 데 visual promting 의 효과를 입증</li><li>모든 visual prompting 중에서 EVP 는 일관되게 best performance 를 달성하며, 이는 다양한 데이터 규모에서 강력한 일반화 능력을 보여줌</li></ul><h1>5. Ablation Study</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="51-original-image-information">5.1. Original Image Information<a href="#51-original-image-information" class="hash-link" aria-label="Direct link to 5.1. Original Image Information" title="Direct link to 5.1. Original Image Information">​</a></h2><p>먼저 input image 의 original information 유지가 얼마나 중요한지 조사.</p><p>이를 위해 learnable parameters 수를 일정하게 유지하면서 input image 의 size 를 변화시킨다.</p><p>즉, original image 의 border information 를 다양한 정도로 손상시킨다.</p><p><img loading="lazy" alt="Table 4" src="/assets/images/image-20-3327e5a34b71731e601984165aaaae22.png" width="2707" height="549" class="img_ev3q"></p><p>결과는 Tab. 4 에 제시</p><ul><li>12 dataset 중 9 개 에서 corruption 정도가 감소할수록 성능이 향상되는 것을 확인할 수 있음</li><li>이는 original image information 을 유지하는 것이 중요함을 나타냄</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="52-prompting-positional-embedding">5.2. Prompting Positional Embedding<a href="#52-prompting-positional-embedding" class="hash-link" aria-label="Direct link to 5.2. Prompting Positional Embedding" title="Direct link to 5.2. Prompting Positional Embedding">​</a></h2><p>다음으로 positional embeddings 의 영향을 조사.</p><p>EVP 는 learnable visual prompts 및 image patch embeddings 의 position 을 모두 encoding 하는 반면, VPT 는 image patch embedding 에만 positional embeddings 를 포함한다.</p><p>저자는 다양한 구성들을 비교하여 visual prompting 에서 positional embedding 의 중요성을 pixel 및 token level 에서 입증한다.</p><hr><p>pixel level 에서, 저자는 <strong>EVP-small w/PE</strong> 로 명명하고, 두 가지 추가 변형을 정의:</p><p>1) <strong>EVP-big w/PE</strong> : original image 를 learnable pixels 로 padding 하고, original positional embeddings 를 적절한 크기로 interpolating 한 다음, positional embedding 을 image patch embedding 과 learnable pixels 모두에 추가</p><p>2) <strong>EVP-big w/o PE</strong> : original image 를 learnable pixels 로 padding 하고, positional embeddings 를 image patch embedding 에만 추가</p><p><img loading="lazy" alt="Table 5" src="/assets/images/image-21-f703d0f497eb55164b8c537c4c1a162e.png" width="1473" height="872" class="img_ev3q"></p><p>결과는 Tab. 5 에서 보여준다.</p><ul><li><strong>EVP-big w/ PE</strong> 가 가장 좋은 성능을 보이는 반면, <strong>EVP-big w/o PE</strong> 가 가장 낮은 성능을 보인다.</li><li>예로, <strong>EVP-small w/ PE</strong> 는 fewer parameters 및 lower resolution 임에도 불구하고, 5 dataset 에서 평균 6.1%(86.7% vs 78.6%) 차이로 <strong>EVP-big w/o PE</strong> 를 능가</li><li>이러한 결과는 visual prompting 에서 positional embedding 을 추가하는 것이 매우 중요함을 입증</li></ul><hr><p>token level 에서, 저자는 learnable tokens 에 positional embedding 을 단순히 추가하는 것만으로 성능이 향상됨을 발견.</p><p>이를 더 조사하기 위해, learnable tokens 에 다양한 positional embedding 을 추가하여 서로 다른 prompting choices 를 설계한다.</p><p><img loading="lazy" alt="Figure 5" src="/assets/images/image-25-784d3d7a093870a2e176c237d621b96c.png" width="2856" height="1043" class="img_ev3q"></p><p>구체적으로, prompting choices 를 VP<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3014em;vertical-align:-0.15em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>T 로 명명하며, 여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span></span></span></span></span>-th positional embeddings 는 learnable tokens 에 추가된다 (Fig. 5).</p><p>실험에서 저자는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mn>25</mn><mo separator="true">,</mo><mn>50</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">n = \{ 1, 25, 50 \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">25</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">50</span><span class="mclose">}</span></span></span></span></span> 을 선택하여 original image 의 head, middle, tail 부분에 token 을 삽입하는 효과를 연구한다. (결과적으로 총 50 tokens)</p><p><img loading="lazy" alt="Table 6" src="/assets/images/image-22-7b45b7f3e3aab5ea6f2749ff7e0ddd83.png" width="1473" height="943" class="img_ev3q"></p><p>Tab. 6 의 결과는</p><ul><li>learnable tokens 에 positional embedding 을 통합하면 visual prompting 의 성능이 일관되게 크게 향상됨을 보여준다.</li><li>예로, 평균 정확도가 VP<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4511em;vertical-align:-0.15em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>T 에서 +2.4%, VP<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mn>25</mn></msub></mrow><annotation encoding="application/x-tex">_{25}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4511em;vertical-align:-0.15em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">25</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>T 에서 +1.8%, VP<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mn>50</mn></msub></mrow><annotation encoding="application/x-tex">_{50}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4511em;vertical-align:-0.15em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>T 에서 +1.4% 증가한다.</li><li>이 결과는 context 에서 positional embedding 의 중요성을 확인시켜준다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="53-training-strategy">5.3. Training strategy<a href="#53-training-strategy" class="hash-link" aria-label="Direct link to 5.3. Training strategy" title="Direct link to 5.3. Training strategy">​</a></h2><p>이 섹션에선 transferable adversarial learning 의 다양한 &quot;old tricks&quot; 가 visual prompting 에 미치는 영향을 조사.</p><p>먼저, CIFAR100 dataset 에서 RandomHorizontalFlip, RandAug, Cutmix 같은 augmentation 효과를 살펴본다</p><p><img loading="lazy" alt="Table 7" src="/assets/images/image-23-6f0add17fda7ee08f40d1f3c78e3c179.png" width="1386" height="827" class="img_ev3q"></p><p>Tab. 7 과 같이, </p><ul><li>RandomHorizontalFlip 같은 simple augmentation 은 만족스러운 결과 발견</li><li>Cutmix 나 RandAug 와 같은 고급 방법은 over-regularization 으로 인해 성능을 저하할 수 있음</li><li>예로, CIFAR100 에서는 RandomHorizontalFlip 이 정확도를 0.7% 향상시키지만, RandAug 와 CutMix는 각각 1.1%와 0.8%의 정확도 저하를 초래</li></ul><hr><p>다음으로, CIFAR100 dataset 에서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">L_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi mathvariant="normal">∞</mi></msub></mrow><annotation encoding="application/x-tex">L_\infty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">∞</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm 을 포함한 다양한 gradient normalization 전략에 대한 ablation study 수행</p><p><img loading="lazy" alt="Table 8" src="/assets/images/image-24-071520e35a6edfe210e804c8d3e7f6ba.png" width="1386" height="827" class="img_ev3q"></p><p>Tab. 8 의 결과에 따르면,</p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm 이 세 전략 중에서 일관되게 가장 좋은 성능을 보임</li><li>게다가, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> norm 의 최적 구성을 조사한 결과, image 전체의 gradient 를 사용하여 norm 계산한 것 (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>-whole)이, visual prompting pixel 의 gradient 만 사용하는 것 (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">L_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>-partial)보다 더 나은 성능을 보인다는 것을 발견</li><li>즉, 81.2% vs 79.4%</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="54-vpt-deep">5.4. VPT-DEEP<a href="#54-vpt-deep" class="hash-link" aria-label="Direct link to 5.4. VPT-DEEP" title="Direct link to 5.4. VPT-DEEP">​</a></h2><p>VPT-DEEP 는 성능 향상을 위해 각 Transformer layer 의 input space 에 learnable token 을 추가로 도입한 VPT 의 고급 버전이다.</p><p>여기서는 EVP 와의 성능을 간단히 비교한다.</p><p>구체적으로, section 4.1 의 설명한 설정을 따라 CLIP-base 으로 실험을 진행.</p><p>결과에 따르면, </p><ul><li>VPT-DEEP 는 기본 VPT 보다 4.6% 더 높은 성능을 보이며 (77.3% to 81.9%)</li><li>EVP 의 평균 정확도인 82.5% 보다는 약간 낮은 성능</li></ul><p>이러한 발견은 EVP 가 우수한 prompting 전략임을 확인. 또한, EVP 와 VPT-DEEP 이 각각 다른 측면의 prompting(pixel-level 및 feature-level)에 초점을 맞추고 있다는 점에서 두 방법을 결합하면 더 강력한 visual prompting 기술을 개발할 수 있는 가능성이 있다.</p><h1>6. Conclusion</h1><p>저자는 pixel-level 에서 visual prompt 를 사용하여 pre-trained model 을 다양한 downstream task 에 adapting 하기 위한 간단하고 효과적인 방법인 EVP 제안</p><p>EVP 는 original image information 을 유지하고 성능을 향상시키기 위해 adversarial learning 기법을 통합한다.</p><p>EVP 가 다른 visual prompting 방법을 능가하며 다양한 환경에서 linear probing 을 능가함을 보여준다.</p><p>또한, EVP 는 다양한 data-scale 및 distribution 외 sample 에 대한 robustness 를 다룰 때 강력한 성능을 보임</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/evp">EVP</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/visual-prompt">Visual Prompt</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/peft">PEFT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/pixel-level">Pixel-Level</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/2022-12-EVP.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/ILM-VP"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Understanding and Improving Visual Prompting: A Label-Mapping Perspective</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Prompting/Pixel-Level/DAM-VP"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Diversity-Aware Meta Visual Prompting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#2-related-work" class="table-of-contents__link toc-highlight">2. Related Work</a></li><li><a href="#31-preliminaries" class="table-of-contents__link toc-highlight">3.1. Preliminaries</a></li><li><a href="#32-designing-evp" class="table-of-contents__link toc-highlight">3.2. Designing EVP</a></li><li><a href="#33-training-strategy-of-evp" class="table-of-contents__link toc-highlight">3.3 Training Strategy of EVP</a></li><li><a href="#41-clip" class="table-of-contents__link toc-highlight">4.1. CLIP</a></li><li><a href="#42-non-clip-models" class="table-of-contents__link toc-highlight">4.2. Non-CLIP Models</a></li><li><a href="#43-robustness" class="table-of-contents__link toc-highlight">4.3. Robustness</a></li><li><a href="#44-different-data-scales" class="table-of-contents__link toc-highlight">4.4 Different Data Scales</a></li><li><a href="#51-original-image-information" class="table-of-contents__link toc-highlight">5.1. Original Image Information</a></li><li><a href="#52-prompting-positional-embedding" class="table-of-contents__link toc-highlight">5.2. Prompting Positional Embedding</a></li><li><a href="#53-training-strategy" class="table-of-contents__link toc-highlight">5.3. Training strategy</a></li><li><a href="#54-vpt-deep" class="table-of-contents__link toc-highlight">5.4. VPT-DEEP</a></li></ul></div></div></div><div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Won-Yong Jo, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.dc82af9c.js"></script>
<script src="/assets/js/main.07c26eea.js"></script>
</body>
</html>