<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Paper/Vision-Language/PEFT/Module/2021-10-CLIP-Adapter">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">CLIP-Adapter: Better Vision-Language Models with Feature Adapters | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Module/CLIP-Adapter"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CLIP-Adapter: Better Vision-Language Models with Feature Adapters | My Site"><meta data-rh="true" name="description" content="논문 및 이미지 출처 :"><meta data-rh="true" property="og:description" content="논문 및 이미지 출처 :"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Module/CLIP-Adapter"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Module/CLIP-Adapter" hreflang="en"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Module/CLIP-Adapter" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.d2ad26d0.css">
<link rel="preload" href="/assets/js/runtime~main.e1d9a069.js" as="script">
<link rel="preload" href="/assets/js/main.d9c907f3.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WYJLab</b></a><a class="navbar__item navbar__link" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Paper</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Computer Vision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Machine Learning/Regularization/Dropout/Dropout">Machine Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/NLP/Analysis/Contextualized Representation">NLP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Survey/Prompting">Survey</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/UPL">Vision-Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/UPL">Unsupervised Prompt Learning for Vision-Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/Img2LLM">From Images to Textual Prompts: Zero-shot Visual Question Answering with Frozen Large Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/Prismer">Prismer: A Vision-Language Model with An Esemble of Experts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Contrastive Learning/ALIGN">Contrastive Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Composition/CLIP-LoRA">PEFT</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Composition/CLIP-LoRA">Composition</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Module/CLIP-Adapter">Module</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Module/CLIP-Adapter">CLIP-Adapter: Better Vision-Language Models with Feature Adapters</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Module/Tip-Adapter">Tip-Adapter: Training-Free Adaption of CLIP for Few-Shot Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Module/TaskRes">Task Residual for Tuning Vision-Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Module/CLAP">A Closer Look at the Few-Shot Adaptation of Large Vision-Language Models</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Multi-Modality/MaPLe">Multi-Modality</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Pixel-Level/CMAR">Prompting</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Single-Stream/VLBERT">Single-Stream</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Two-Stream/LXMERT">Two-Stream</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Programming/Algorithm/">Programming</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Paper</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Vision-Language</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">PEFT</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Module</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">CLIP-Adapter: Better Vision-Language Models with Feature Adapters</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CLIP-Adapter: Better Vision-Language Models with Feature Adapters</h1></header><p>논문 및 이미지 출처 : <a href="https://link.springer.com/article/10.1007/s11263-023-01891-x" target="_blank" rel="noopener noreferrer">https://link.springer.com/article/10.1007/s11263-023-01891-x</a></p><h1>Abstract</h1><p>large-scale contrastive vision-language pretraining 은 visual representation learning 에서 상당한 진전을 보이고 있다.</p><p>기존 fixed discrete labels set 을 사용하여 훈련된 traditional visual systems 와 달리, CLIP 에선 open-vocabulary setting 에서 images 와 raw texts 를 직접 align 하여 학습하는 new paradigm 을 도입하였다.</p><p>downstream tasks 에선 carefully chosen text prompt 가 사용되어 zero-shot prediction 을 수행한다.</p><p>non-trivial prompt engineering 을 피하기 위해, context optimization 이 제안되어 few-shot training examples 로 task-specific prompts 를 continuous vectors 로 학습할 수 있게 하였다.</p><p>본 논문에선 prompt tuning 외에 더 나은 vision-language 모델을 달성할 수 있는 대안적인 방법이 있음을 보여준다.</p><p>prompt tuning 이 textual input 을 위한 것이라면, 저자는 CLIP-Adapter 를 제안하여 visual 또는 language branch 에 feature adapters 를 사용하여 fine-tuning 을 수행한다. </p><p>구체적으로, CLIP-Adapter 는 additional bottleneck layer 를 채택하여 new features 를 학습하고, pretrained features 와 residual-style feature blending 을 수행한다.</p><p>그 결과, CLIP-Adapter 는 단순한 디자인을 유지하면서도 context optimization 을 능가할 수 있다.</p><p>다양한 visual classification tasks 에서의 실험 및 광범위한 ablation studies 으로 효과를 입증한다.</p><h1>1. Introduction</h1><p>visual understanding tasks, 예로 classification, object detection, 및 semantic segmentation 은 더 나은 architecture 설계와 large-scale high-quality dataset 을 기반으로 상당히 향상되었다.</p><p>하지만, 모든 visual task 를 위해 large-scale high-quality dataset 을 수집하는 것은 많은 노동이 필요하고 확장하기에 너무 비용이 많이 든다.</p><p>이를 해결하기 위해 &quot;pretraining-finetuning&quot; paradigm, 즉 ImageNet 같은 large-scale dataset 에서 pre-training 을 하고 다양한 downstream tasks 에 대해 fine-tuning 하는 방식이 visual domain 에서 널리 채택되었다. </p><p>그러나 이런 방식은 여전히 많은 downstream tasks 에 대해 fine-tuning 하기 위해 huge annotations 가 필요하다.</p><hr><p>최근 Contrastive Language-Image Pretraining (CLIP) 은 large-scale noisy image-text pairs 를 사용한 contrastive learning 을 활용하여 visual tasks 를 해결하기 위해 제안되었다. </p><p>CLIP 은 suitable hand-crafted templates 을 prompt 로 사용하여 다양한 visual classification tasks 에서 주목할 만한 성과를 annotations 없이 (i.e., zero-shot transfer) 달성한다. </p><p>prompt-based zero-shot transfer learning 은 유망한 성과를 보여주었지만, designing good prompt 은 여전히 상당한 시간과 domain knowledge 를 요구하는 engineering 문제로 남아 있다.</p><p>이를 해결하기 위해, Context Optimization (CoOp) 은 carefully-chosen hard prompts 를 대체하기 위해 continuous soft prompts 를 few-shot examples 로 학습하도록 제안되었다. </p><p>CoOp 은 zero-shot CLIP 및 linear probe CLIP 설정 모두에서 few-shot classification 성능을 크게 향상시켜, large-scale pre-trained vision-language model 에서 prompt tuning 의 가능성을 보여준다. </p><hr><p>본 논문에선 prompt tuning 이 아닌 feature adapters 를 통해 better adapting vision-language model 을 위한 다른 접근 방식을 제안한다.</p><p>CoOp 이 soft prompt optimization 을 수행하는 것과 달리, 저자는 light-weight additional feature adapters 에 대해 단순히 fine-tuning 을 수행한다. </p><p>CLIP 의 over-parameterization 문제와 enough training examples lack 때문에, naive fine-tuning 은 특정 dataset 에 over-fitting 될 수 있으며 모든 CLIP layers 에서 forward 와 backward propagation 으로 인해 training process 가 매우 느려질 수 있다. </p><hr><p><img loading="lazy" alt="Figure 1" src="/assets/images/image-d52334b9cd6539943b89324a2ff9fd35.png" width="1829" height="844" class="img_ev3q"></p><p>Parameter-efficient transfer learning 에서의 adapter modules 에 영감을 받아, 저자는 CLIP 의 all parameters 를 optimizing 하는 대신 small parameter weights 만 fine-tuning 하는 CLIP-Adapter 를 제안한다(Fig. 1). </p><ul><li>CLIP-Adapter 는 light-weight bottleneck architecture 를 채택하여 parameter 수를 줄여 few-shot learning 의 potential over-parameterization 문제를 방지한다.</li><li>한편, CLIP-Adapter 는 Adapter 과 두 가지 측면에서 다르다: <ul><li>CLIP-Adapter 는 visual 또는 language backbone 의 last layers 에 이어 two linear layers 만 추가한다. <ul><li>이는 original pre-trained CLIP encoder 가 이미 strong representation 능력을 갖추고 있으므로 residuals 형식의 lightweight adaptation 만 필요하기 때문이다. </li></ul></li><li>반면, original adapter modules 는 language backbone 의 모든 layers 에 삽입된다; 또한, CLIP-Adapter 는 residual connection 을 통해 original zero-shot visual 또는 language embedding 을 해당 fine-tuning feature 와 혼합한다. <ul><li>이러한 &quot;residual-style blending&quot; 을 통해 CLIP-Adapter 는 original CLIP 에 저장된 knowledge 와 few-shot training examples 에서 비롯된 freshly learned knowledge 을 동시에 활용할 수 있다.</li></ul></li></ul></li></ul><p>Fig. 2 는 CLIP-Adapter 와 다른 visual classification architecture 간의 차이점을 직관적으로 설명한다.</p><p><img loading="lazy" alt="Figure 2" src="/assets/images/image-1-231e1f53018608cd0ce5aaf2c44e840d.png" width="1371" height="1073" class="img_ev3q"></p><p>전반적으로, 저자의 기여는 다음과 같이 요약할 수 있다:</p><ul><li>저자는 fine-tuning 을 통해 efficient few-shot transfer learning 을 달성하기 위해 residual-style feature blending 을 수행하는 CLIP-Adapter 를 제안</li><li>CoOp 과 비교하여, CLIP-Adapter 는 훨씬 더 간단한 설계를 가지면서도 better few-shot classification 성능을 달성하여, CLIP-Adapter 가 prompt tuning 에 대한 유망한 대안임을 입증</li><li>저자는 CLIP-Adapter 의 특성을 분석하기 위해 열한 개의 classification datasets 에 대한 광범위한 ablation studies 를 수행</li></ul><h1>2. Related Work</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="21-model-fine-tuning">2.1 Model Fine-Tuning<a href="#21-model-fine-tuning" class="hash-link" aria-label="Direct link to 2.1 Model Fine-Tuning" title="Direct link to 2.1 Model Fine-Tuning">​</a></h2><p>deep network 는 large high-quality data 수집과 annotation 에 비용이 많이 들며, 일부 special domain 에선 불가능할 수 있다.</p><p>&quot;pretraining-finetuning&quot; paradigm 은 다양한 CV 및 NLP tasks 에 좋은 해결책을 제공하며, 오랜 기간 널리 채택되어 왔다.</p><p>downstream tasks 에 대해 데이터 efficient fine-tuning 을 위해, adapter modules 은 backbone 의 weight 를 고정하고, 각 Transformer layers 에 learnable linear layers 를 삽입하도록 제안되었다.</p><p>이후 Parallel Adapter 및 VL-Adapter 같은 후속 작업은 Adapter 의 능력을 language 및 multi-modal task 로 확장하였다.</p><p>그 외에도 black-box tuning, ladder side-tuning, sparse structure search, Scaling &amp; Shifting 같은 방법들은 large language 및 vision model 을 parameter-efficient 방식으로 adapting 하기 위한 다양한 기술을 도입하였다.</p><p>기존 접근 방식과 달리, 제안된 CLIP-Adapter 는 CLIP 이 생성한 feature embedding 또는 classifier weight 에 simple residual transformation layer 를 적용한다.</p><p>Residual connection 과 bottleneck linear layer 덕에 CLIP-Adapter 는 few-shot learning settings 에서 CLIP 의 성능을 향상시키고, 최근 제안된 CoOp 보다 우수한 성능을 달성할 수 있다.</p><p>Distribution shifting 에서 performance gap 을 완화하기 위해, WiSE-FT 는 CLIP 의 out-of-distribution robustness 를 향상시키기 위한 post-ensemble 방법을 제안한다.</p><p>반면, CLIP-Adapter 는 training stage 전반에 걸쳐 original features 와 CLIP-Adapter 의 output 사이에서 동적으로 균형을 맞추고 혼합하기 위해 learnable gating ratio 를 채택한다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="22-prompt-design">2.2 Prompt Design<a href="#22-prompt-design" class="hash-link" aria-label="Direct link to 2.2 Prompt Design" title="Direct link to 2.2 Prompt Design">​</a></h2><p>Prompt design 은 GPT 시리즈 성공에 의해 대중화되었다. </p><p>GPT-3 는 large-scale dataset 으로 학습된 large-scale autoregressive language model 이 base architecture 를 fine-tuning 하지 않고도 zero-shot 또는 few-shot 방식으로 모든 NLP tasks 를 수행할 수 있음을 보여주었다.</p><p>new &quot;pretrain, prompt, and predict&quot; paradigm 을 따르면서, 다양한 prompt design 접근 방식이 최근 제안되었다. </p><p>초기 시도로, 이런 접근 방식 중 하나는 pretrained language 또는 vision-language model 을 natural language discrete prompts 로 tuning 하는 것에 중점을 뒀다. 또는 proper natural language discrete prompts 를 발굴하거나 생성하여 prompt engineering 을 수행한다.</p><p>반면, continuous prompts 는 pretrained language models 의 제약을 우회하며, 다양한 접근 방식에 채택되었다.</p><p>최근 vision tasks 에도 도입되어, GPT-3에서 영감을 받아, CLIP 은 400M image-text pairs 에 대해 large-scale contrastive learning model 을 학습시키며, prompt-based zero-shot visual classification 의 잠재력을 보여주었다. </p><p>CLIP 을 backbone 으로 사용하여, CoOp 은 continuous prompts 를 optimizing 함으로써 vision tasks 에서 hand-crafted discrete prompts 를 크게 능가할 수 있음을 보여주었다.</p><p>본 논문에선 prompt tuning 외에도 vision-language model 을 개선할 수 있는 또 다른 경로가 있음을 보여준다. parameter 일부만 fine-tuning 하여도 vision tasks 에서 유사하거나 더 나은 성능을 달성할 수 있으며, 훨씬 간단한 설계를 가질 수 있다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="23-vision-language-models">2.3 Vision-Language Models<a href="#23-vision-language-models" class="hash-link" aria-label="Direct link to 2.3 Vision-Language Models" title="Direct link to 2.3 Vision-Language Models">​</a></h2><p>Vision 과 language 간의 interaction 을 탐구하는 것은 인공지능에서 핵심 연구 주제이다.</p><p>이전에는, bottom-up top-down attention, BAN, Intra-Inter, 및 MCAN 같은 attention-based approaches 가 vision-language tasks 를 지배해왔다. </p><p>BERT 의 성공에서 영감을 받아, ViLBERT, LXMERT, UNITER, Oscar, ALBEF, 및 BEiT 은 multi-modal inference 의 경계를 더욱 넓혔다.</p><p>최근, CLIP 과 ALIGN 은 vision-language contrastive representation learning 의 힘을 보여주었다.</p><p>이들은 fine-tuning 없이도 광범위한 vision tasks 에서 놀라운 결과를 달성한다.</p><p>CLIP 과 supervised training 간의 gap 을 더 줄이기 위해, CoOp 은 visual classification tasks 에서 성능을 향상시키기 위한 continuous prompt optimization 방법을 제안한다.</p><p>CoOp 이 prompt design 의 관점에서 vision-language 모델을 개선하는 반면, 저자의 CLIP-Adapter 는 lightweight feature adapters 를 사용하여 간단한 fine-tuning 을 탐구한다.</p><h1>3. Our Approach</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-classifier-weight-generation-for-few-shot-learning">3.1 Classifier Weight Generation for Few-Shot Learning<a href="#31-classifier-weight-generation-for-few-shot-learning" class="hash-link" aria-label="Direct link to 3.1 Classifier Weight Generation for Few-Shot Learning" title="Direct link to 3.1 Classifier Weight Generation for Few-Shot Learning">​</a></h2><p>DNN 을 사용한 image classification 의 basic framework 를 먼저 살펴보자: </p><ul><li>image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>H</mi><mo>×</mo><mi>W</mi><mo>×</mo><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">I \in \mathbb{R}^{H \times W \times 3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em">H</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em">W</span><span class="mbin mtight">×</span><span class="mord mtight">3</span></span></span></span></span></span></span></span></span></span></span></span></span> 가 주어졌을 때 (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span></span></span></span></span> 는 각각 image 의 height 와 width), cascade basic components (e.g., CNN, Transformer 또는 둘의 혼합)으로 구성된 neural network backbone 은 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span></span></span></span></span> 를 받아서 feature manifold <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>D</mi></msup></mrow><annotation encoding="application/x-tex">f \in \mathbb{R}^D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span></span></span></span></span></span></span></span></span> 로 변환한다. <ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span></span></span></span></span> : feature 의 dimension.</li></ul></li><li>classification 수행을 위해, image feature vector <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span></span></span> 는 classifier weight matrix <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>D</mi><mo>×</mo><mi>K</mi></mrow></msup></mrow><annotation encoding="application/x-tex">W \in \mathbb{R}^{D \times K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span></span></span></span></span></span></span></span></span></span> 와 곱해지며,<ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> : 분류해야 하는 class 수를 나타낸다.</li></ul></li><li>matrix multiplication 후, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span>-dimensional logit 을 얻을 수 있다.</li><li>Softmax function 은 이 logit 을 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> class 에 대한 probability vectors <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>K</mi></msup></mrow><annotation encoding="application/x-tex">p \in \mathbb{R}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span></span></span></span></span></span></span></span></span> 로 변환한다.</li></ul><p>전체 과정은 다음과 같은 수식으로 표현할 수 있다:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>f</mi><mo>=</mo><mtext>Backbone</mtext><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mspace width="1em"></mspace><msub><mi>p</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>i</mi><mi>T</mi></msubsup><mi>f</mi><mi mathvariant="normal">/</mi><mi>τ</mi><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>j</mi><mi>T</mi></msubsup><mi>f</mi><mi mathvariant="normal">/</mi><mi>τ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} f = \text{Backbone}(I), \quad p_i = \frac{\exp(W_i^T f / \tau)}{\sum_{j=1}^K \exp(W_j^T f / \tau)}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.8254em;vertical-align:-1.1627em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6627em"><span style="top:-3.6627em"><span class="pstrut" style="height:3.5183em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">Backbone</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em"></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em"><span style="top:-2.1288em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.0448em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.307em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1627em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6627em"><span style="top:-3.6627em"><span class="pstrut" style="height:3.5183em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1627em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi></mrow><annotation encoding="application/x-tex">\tau</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span></span></span></span></span> : Softmax temperature</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> : class <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span></span> 에 대한 prototype weight vectors</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> : category <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span></span> 에 대한 probability </li></ul><hr><p>Supervised training 과 달리, 본 논문에선 few-shot examples 를 사용한 image classification 에 관심이 있다.</p><p>backbone 과 classifier 를 few samples 로 scratch training 은 특정 dataset 에 over-fitting 되기 쉽고, test split 에서 심각한 성능 저하를 겪을 수 있다.</p><p>일반적으로 few-shot learning 의 대표적인 paradigm 은 large-scale dataset 에서 먼저 backbone 을 pretrain 한 다음, zero-shot prediction 을 직접 수행하거나 few-shot examples 에서 additional fine-tuning 을 통해 learned knowledge 을 downstream tasks 에 transfer 하는 것이다.</p><ul><li>CLIP 은 zero-shot transfer style 을 따르며, 먼저 large-scale noisy image-text pairs 에서 contrastive learning 을 통해 visual backbone 과 text encoder 를 pretrain 한 후, fine-tuning 없이 직접 image classification 를 수행한다.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> categories 와 해당 natural language name <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>C</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>C</mi><mi>K</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\{C_1, \dots, C_K\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> 을 포함하는 image classification downstream dataset 이 주어졌을 때, CLIP 은 각 categories name <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 pre-defined hard prompt templates <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi></mrow><annotation encoding="application/x-tex">H</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.08125em">H</span></span></span></span></span> 에 넣어서 이를 구성한다.</li><li>그런 다음 language feature extractor 가 결과적인 prompt 를 classifier weight <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 로 encoding 한다.</li></ul><p>classifier weight 생성 과정을 다음과 같이 나타낸다:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>=</mo><mtext>Text-Encoder</mtext><mo stretchy="false">(</mo><mtext>Tokenizer</mtext><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mi>H</mi><mo separator="true">;</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} W_i = \text{Text-Encoder}(\text{Tokenizer}([H; C_i])). \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">Text-Encoder</span></span><span class="mopen">(</span><span class="mord text"><span class="mord">Tokenizer</span></span><span class="mopen">([</span><span class="mord mathnormal" style="margin-right:0.08125em">H</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]))</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-2.85em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span></span></div><ul><li>대안적으로, CoOp 은 hand-crafted hard prompts 대신 continuous prompts 를 채택한다.</li><li>CoOp 은 randomly initialized learnable soft token 들의 list <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi>L</mi><mo>×</mo><mi>D</mi></mrow></msup></mrow><annotation encoding="application/x-tex">S \in \mathbb{R}^{L \times D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8413em"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.02778em">D</span></span></span></span></span></span></span></span></span></span></span></span></span> 을 생성하며,<ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal">L</span></span></span></span></span> : soft token sequence length</li></ul></li><li>soft token sequence <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span></span></span></span></span> 는 각 class name <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">C_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 에 연결되어 prompt 를 형성한다.</li></ul><p>전체 과정을 다음과 같이 나타낸다:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>W</mi><mi>i</mi></msub><mo>=</mo><mtext>Text-Encoder</mtext><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mi>S</mi><mo separator="true">;</mo><mtext>Tokenizer</mtext><mo stretchy="false">(</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} W_i = \text{Text-Encoder}([S; \text{Tokenizer}(C_i)]). \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">Text-Encoder</span></span><span class="mopen">([</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord text"><span class="mord">Tokenizer</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)])</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-2.85em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span></span></div><p>CLIP 과 CoOp 모두에서, 생성된 classifier weight <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">W_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 와 함께, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mi>K</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">i \in \{1, \dots, K\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6986em;vertical-align:-0.0391em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="mclose">}</span></span></span></span></span> 일 때, Eq. (1) 에 따라 class <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span></span> 에 대한 prediction probability <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 계산할 수 있다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-clip-adapter">3.2 CLIP-Adapter<a href="#32-clip-adapter" class="hash-link" aria-label="Direct link to 3.2 CLIP-Adapter" title="Direct link to 3.2 CLIP-Adapter">​</a></h2><p>CoOp 의 prompt tuning 과 달리, 저자는 few-shot image classification 에서 더 나은 vision-language 모델을 달성하기 위해 additional feature adapters 를 fine-tuning 하는 대안적인 framework 를 제안한다. </p><p>이전에 널리 채택된 &quot;pretrain-finetuning&quot; paradigm 은 few-shot settings 에서 CLIP backbone 전체를 fine-tuning 하는 데 실패할 것이라고 주장한다.</p><p>이는 방대한 양의 parameters 및 training examples 부족때문이며, 따라서 저자는 CLIP-Adapter 를 제안하며, few-shot fine-tuning 중에 original CLIP backbone 을 고정시키는 동안 CLIP 의 language 및 image branches 에 naive additional learnable bottleneck linear layers 를 추가한다.</p><p>하지만, additional layers 를 사용한 단순한 fine-tuning 은 여전히 few-shot examples 에 over-fitting 될 수 있다.</p><p>over-fitting 을 처리하고 CLIP-Adapter 의 robustness 을 향상시키기 위해, 저자는 residual connections 을 채택하여 fine-tuning 된 knowledge 를 CLIP backbone 의 original knowledge 와 동적으로 혼합한다.</p><hr><p>구체적으로,</p><ul><li>input image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span></span></span></span></span> 와 categories 의 natural language name set <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">{</mo><msub><mi>C</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></mrow><annotation encoding="application/x-tex">\{C_i\}_{i=1}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span></span> 이 주어졌을 때, original CLIP backbone 에서 Eq. (1) 과 (2) 를 사용하여 image feature <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span></span></span> 와 classifier weight <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span></span></span></span></span> 를 계산한다.</li><li>이후, 각각 two linear transformation layers 로 구성된 two learnable feature adapters, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>v</mi></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A_v(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A_t(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> 가 통합되어 각각 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.10764em">f</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span></span></span></span></span> 를 변환한다.</li><li>pretrained CLIP 에 의해 encoding 된 original knowledge 를 잊지 않기 위해 feature adapter 에는 residual connection 이 사용된다.</li><li>성능을 optimizing 하기 위해 original knowledge 를 유지하는 정도를 조정하는 데 도움이 되는 &quot;residual ratio&quot; 로 two constant values <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span></span> 가 사용된다.</li></ul><p>요약하면, feature adapters 는 다음과 같이 쓸 수 있다:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>A</mi><mi>v</mi></msub><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>ReLU</mtext><mo stretchy="false">(</mo><msup><mi>f</mi><mi>T</mi></msup><msub><mi>W</mi><mrow><mi>v</mi><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><msub><mi>W</mi><mrow><mi>v</mi><mn>2</mn></mrow></msub><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} A_v(f) = \text{ReLU}(f^T W_{v1}) W_{v2}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2513em;vertical-align:-0.3757em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.9843em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.8757em"><span class="pstrut" style="height:2.8913em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span></span></div><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>ReLU</mtext><mo stretchy="false">(</mo><msup><mi>W</mi><mi>T</mi></msup><msub><mi>W</mi><mrow><mi>t</mi><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><msub><mi>W</mi><mrow><mi>t</mi><mn>2</mn></mrow></msub><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} A_t(W) = \text{ReLU}(W^T W_{t1}) W_{t2}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2513em;vertical-align:-0.3757em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.9843em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text"><span class="mord">ReLU</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.8757em"><span class="pstrut" style="height:2.8913em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>v</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{v1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>v</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{v2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>t</mi><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{t1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span>, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>W</mi><mrow><mi>t</mi><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">W_{t2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> : 각각 visual branch 와 text branch 를 위한 bottleneck linear layers 의 weight.</li><li>fine-tuning 을 통해 캡처된 new knowledge 는 residual connections 을 통해 original features 와 더해진다:</li></ul><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>α</mi><msub><mi>A</mi><mi>v</mi></msub><mo stretchy="false">(</mo><mi>f</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mi>f</mi><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} f&#x27; = \alpha A_v(f)^T + (1 - \alpha)f, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2513em;vertical-align:-0.3757em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.9843em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.8757em"><span class="pstrut" style="height:2.8913em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span></span></div><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>W</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>β</mi><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mi>W</mi><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>β</mi><mo stretchy="false">)</mo><mi>W</mi><mi mathvariant="normal">.</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} W&#x27; = \beta A_t(W)^T + (1 - \beta)W. \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2513em;vertical-align:-0.3757em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.9843em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8757em"><span style="top:-2.8757em"><span class="pstrut" style="height:2.8913em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3757em"><span></span></span></span></span></span></span></span></span></div><ul><li>new image feature <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>f</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">f&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9463em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> 와 classifier weight <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>W</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">W&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span> 를 얻은 후, 또한 Eq. (1) 을 사용하여 category probability vectors <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>p</mi><mi>i</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>K</mi></msubsup></mrow><annotation encoding="application/x-tex">P = \{p_i\}_{i=1}^K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2587em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span></span></span></span></span> 를 계산하고, </li><li>highest probability 를 가진 class 를 선택하여 image categories 를 예측한다: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>i</mi><mo>^</mo></mover><mo>=</mo><mi>arg</mi><mo>⁡</mo><msub><mrow><mi>max</mi><mo>⁡</mo></mrow><mi>i</mi></msub><msub><mi>p</mi><mi>i</mi></msub><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\hat{i} = \arg \max_i p_i.</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.923em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.923em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal">i</span></span><span style="top:-3.2285em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.25em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mop">ar<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">.</span></span></span></span></span></li></ul><p>few-shot learning 중에, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>v</mi></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A_v(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>t</mi></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">A_t(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span></span> 의 weight 는 original CLIP 을 따르는 contrastive loss 로 optimizing 된다:</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi mathvariant="script">L</mi><mi>θ</mi></msub><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>log</mi><mo>⁡</mo><mfrac><mrow><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>i</mi><mi>T</mi></msubsup><msub><mi>f</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>τ</mi><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msubsup><mi>W</mi><mi>j</mi><mi>T</mi></msubsup><msub><mi>f</mi><mi>i</mi></msub><mi mathvariant="normal">/</mi><mi>τ</mi><mo stretchy="false">)</mo></mrow></mfrac><mo separator="true">,</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \mathcal{L}_\theta = - \frac{1}{N} \sum_{i=1}^N \log \frac{\exp(W_i^T f_i / \tau)}{\sum_{j=1}^N \exp(W_j^T f_i / \tau)}, \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1354em;vertical-align:-1.3177em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8177em"><span style="top:-3.8177em"><span class="pstrut" style="height:3.8283em"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em"><span style="top:-1.8723em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em"><span class="pstrut" style="height:3.05em"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em"><span class="pstrut" style="height:3.05em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5183em"><span style="top:-2.1288em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4358em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span><span style="top:-3.0448em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.413em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mop">exp</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4413em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2587em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.1076em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.1132em">τ</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.307em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3177em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8177em"><span style="top:-3.8177em"><span class="pstrut" style="height:3.8283em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3177em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span> : training examples 의 총 수</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mo stretchy="false">{</mo><msubsup><mi>W</mi><mn>1</mn><mi>v</mi></msubsup><mo separator="true">,</mo><msubsup><mi>W</mi><mn>2</mn><mi>v</mi></msubsup><mo separator="true">,</mo><msubsup><mi>W</mi><mn>1</mn><mi>t</mi></msubsup><mo separator="true">,</mo><msubsup><mi>W</mi><mn>2</mn><mi>t</mi></msubsup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\theta = \{W^v_1, W^v_2, W^t_1, W^t_2\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.02778em">θ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0436em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6644em"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em"><span style="top:-2.4519em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2481em"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> : CLIP-Adapter 의 all learnable parameters</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="33-variants-of-clip-adapter">3.3 Variants of CLIP-Adapter<a href="#33-variants-of-clip-adapter" class="hash-link" aria-label="Direct link to 3.3 Variants of CLIP-Adapter" title="Direct link to 3.3 Variants of CLIP-Adapter">​</a></h2><p>CLIP-Adapter 에는 3 variants 가 있다: (1) text branch 는 고정한 채 image branches 에 대한 feature adapter 만 fine-tuning 하는 경우, (2) image branch 는 고정한 채 text branch 에 대한 feature adapter 만 fine-tuning 하는 경우, (3) CLIP backbone 의 image 와 text branch 모두를 fine-tuning 하는 경우이다. </p><p>hyper-parameter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span></span> 에 관해서는, 서로 다른 dataset 에서 optimal <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span></span> 값이 다르다는 것을 관찰했다. </p><p>hyper-parameter 수동 선택은 시간이 걸리니, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span></span> 를 learnable parameter 로 설정하여, 이를 differentiable manner 로 학습하는 방법도 탐구했다.</p><p>이렇게 하면 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span></span> 는 hyper-network <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span></span> 를 통해 visual feature 나 classifier weight 로부터 동적으로 예측될 수 있다: <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo separator="true">,</mo><mi>β</mi><mo>=</mo><mi mathvariant="script">Q</mi><mo stretchy="false">(</mo><mi>f</mi><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\alpha, \beta = \mathcal{Q}(f, W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathcal">Q</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">W</span><span class="mclose">)</span></span></span></span></span>.</p><h1>4. Experiments</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="41-experimental-setups">4.1 Experimental Setups<a href="#41-experimental-setups" class="hash-link" aria-label="Direct link to 4.1 Experimental Setups" title="Direct link to 4.1 Experimental Setups">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="411-datasets">4.1.1 Datasets<a href="#411-datasets" class="hash-link" aria-label="Direct link to 4.1.1 Datasets" title="Direct link to 4.1.1 Datasets">​</a></h3><p>CLIP 과 CoOp 을 따라, CLIP-Adapter 효과 검증을 위해 11 image classification datasets 를 선택.</p><p>이는 ImageNet, StanfordCars, UCF101, Caltech101, Flowers102, SUN397, DTD, EuroSAT, FGVCAircraft, OxfordPets, 그리고 Food101 이다.</p><p>구체적으로, CLIP-Adapter 는 1, 2, 4, 8, 16-shot few-shot settings 에서 학습한 후, full test split 에서 조정된 모델을 테스트한다. </p><p>few-shot learning 의 randomness 를 고려하여, 3 runs 의 average accuracy 를 보고한다.</p><p>모든 실험은 단일 NVIDIA A100 GPU 에서 수행.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="412-implementation-details">4.1.2 Implementation Details<a href="#412-implementation-details" class="hash-link" aria-label="Direct link to 4.1.2 Implementation Details" title="Direct link to 4.1.2 Implementation Details">​</a></h3><p>별도 언급이 없는 경우, 기본적으로 CLIP-Adapter 의 first variants 를 채택하여, classifier weight 를 고정한 상태에서 image feature 를 fine-tuning 한다. i.e., visual adapter 만 CLIP-Adapter 를 구현한다.</p><p>text adapter 를 활성화하는 다른 variants 변형의 결과는 Sec. 4.2.5에서 제시한다.</p><ul><li>CoOp 과 동일한 training hyper-parameter 를 사용</li><li>batch size 32, all dataset 에 대해 learning rate 는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">1 \times 10^{-5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></span> 를 사용한다. 단, residual ratio 인 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 는 예외이다.<ul><li>각 dataset 에 대해 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 의 다른 값 선택을 통해 hyper-parameter search 를 수행하고, </li><li>all search space 중 가장 좋은 성능을 보고한다.</li></ul></li><li>ResNet-50 을 visual backbone(visual encoder)으로 사용하며, 12 layer Transformer 를 classifier weight generator(text encoder)로 사용한다.</li><li>visual 및 text bottleneck layer 의 hidden embedding dimension 은 original embedding dimension 의 1/4 인 256 으로 설정한다.</li><li>CoOp 의 learnable continuous prompt 와 달리, CLIP-Adapter 는 textual input 으로 CLIP 과 동일한 simple hand-crafted hard prompt 를 사용한다.</li><li>generic-category image dataset 의 경우, 예로, ImageNet 의 경우 &quot;a photo of a {class}&quot; 를 hard prompt templates 으로 채택한다.</li><li>fine-grained classification dataset 의 경우, 해당 domain keyword 를 templates 에 지정하여 더 나은 성능을 낸다.<ul><li>예로, EuroSAT 의 경우 &quot;a centered satellite photo of {class}&quot; 같이 templates 을 사용하며, 다른 fine-grained dataset 도 이와 유사하게 처리한다.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="413-notes-on-image-pre-processing">4.1.3 Notes on Image Pre-processing<a href="#413-notes-on-image-pre-processing" class="hash-link" aria-label="Direct link to 4.1.3 Notes on Image Pre-processing" title="Direct link to 4.1.3 Notes on Image Pre-processing">​</a></h3><p>기존 방법에 two image pre-processing 방법이 있다.</p><p>첫 번째는 CLIP, 두 번째는 CoOp 에서 보고된 방법이다.</p><p>각각을 CLIP stype 과 CoOp stype pre-processing 으로 명명한다.</p><p>이 두 방법은 모두 random cropping, resizing 및 random horizontal flip transformations 로 구성된다.</p><p>이들의 차이점은 resizing 방법이며,</p><ul><li>CLIP style pre-processing 은 cropped image 의 short side 를 224 로 resizing 하되, original aspect ratio 는 유지한다.</li><li>반면, CoOp style 은 이미지의 양쪽을 224 로 resizing 한다.</li><li>기본적으로 CoOp style pre-processing 를 따른다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="42-comparison-on-few-shot-learning">4.2 Comparison on Few-Shot Learning<a href="#42-comparison-on-few-shot-learning" class="hash-link" aria-label="Direct link to 4.2 Comparison on Few-Shot Learning" title="Direct link to 4.2 Comparison on Few-Shot Learning">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="421-baseline-models">4.2.1 Baseline Models<a href="#421-baseline-models" class="hash-link" aria-label="Direct link to 4.2.1 Baseline Models" title="Direct link to 4.2.1 Baseline Models">​</a></h3><p>CLIP-Adapter 를 Zero-shot CLIP, Linear probe CLIP, CoOp 의 3 baselines 와 비교한다.</p><p>공정한 비교를 위해 CLIP-Adapter 는 Zero-shot CLIP 과 동일한 hand-crafted hard prompt 를 공유한다.</p><ul><li>CoOp : discrete token 을 learnable continuous vectors 로 대체한다. 따라서 class token 을 prompt templates 의 multiple candidate position 에 배치할 수 있으며, 이는 front, middle 또는 end 에 배치될 수 있다.<ul><li>여기에선 16 token soft prompt 의 end 에 class token 을 배치하고, 이 context 를 다른 class 간에 공유하는 CoOp 의 최상의 성능 변형을 선택한다.</li></ul></li><li>Linear probe CLIP : visual encoder top 에 additional linear classifier 를 학습시키며, few-shot learning 방식을 따른다. <ul><li>이는 image feature 와 classifier weight 를 dynamic 및 residual fashion 으로 fine-tuning 하는 저자의 bottleneck adapter 와는 다르다.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="422-performance-comparison-and-analysis">4.2.2 Performance Comparison and Analysis<a href="#422-performance-comparison-and-analysis" class="hash-link" aria-label="Direct link to 4.2.2 Performance Comparison and Analysis" title="Direct link to 4.2.2 Performance Comparison and Analysis">​</a></h3><p>main result 는 Fig. 3에 제시되어 있다.</p><p><img loading="lazy" alt="Figure 3" src="/assets/images/image-2-e07f5f8f799f8e9279e8ab1700410564.png" width="812" height="936" class="img_ev3q"></p><ul><li>11 dataset 에 대한 average accuracy 에서 CLIP-Adapter 는 all different shot settings 에서 3 baselines 를 능가하며, 뛰어난 few-shot learning 능력을 입증한다.</li><li>특히, 1-shot 이나 2-shot learning settings 같은 극한 조건에선 CLIP-Adapter 가 기준 모델에 비해 더 큰 성능 향상을 달성하며, data-deficient training 상황에 더 나은 일반화 능력을 보인다.</li></ul><p><img loading="lazy" alt="Figure 4" src="/assets/images/image-3-55715a0f8015f645fcc3a2b5e0f6cfd7.png" width="617" height="548" class="img_ev3q"></p><ul><li>Zero-shot CLIP 과 비교했을 때, CLIP-Adapter 는 all 11 dataset 에서 유의미한 성능 향상을 달성한다.<ul><li>16-shot learning setting 의 11 dataset 에 대한 절대 성능 향상 순위는 Fig. 4 에 표시되어 있다. </li></ul></li><li>EuroSAT 에서 FGVCAircraft 까지의 상위 5 fine-grained dataset 에 대해 CLIP-Adapter 는 20% 에서 50% 에 이르는 큰 성능 향상을 보인다.</li><li>Caltech101 과 ImageNet 과 같은 더 도전적이고 일반적인 dataset 에선 향상이 더 작아진다.</li><li>OxfordPets 와 Food101의 경우, Zero-shot CLIP 의 original 결과가 이미 상당히 우수하기 때문에 CLIP-Adapter 는 상대적으로 제한된 개선을 보인다.</li></ul><hr><ul><li>유사한 스타일인 Linear probe CLIP 과 비교했을 때, CLIP-Adapter 는 전반적인 성능 이점을 보여준다.<ul><li>1-shot 및 2-shot learning settings 에선 Linear probe CLIP 이 Zero-shot CLIP 의 성능에 거의 도달하지 못하지만, CLIP-Adapter 는 항상 Zero-shot CLIP 을 초과하고 Linear probe CLIP 을 큰 차이로 능가한다.</li><li>예로, 1-shot 및 2-shot learning settings 에서의 절대 마진은 OxfordPets 에서 각각 53.6% 및 42.16%, ImageNet 에서 각각 37.17% 및 27.58% 이다.</li></ul></li><li>CoOp 과 비교했을 때, CoOp 은 이미 Zero-shot CLIP 에 비해 큰 향상을 얻었지만, CLIP-Adapter 는 all dataset 과 다양한 shot settings 에서 여전히 CoOp 을 능가한다.<ul><li>CLIP-Adapter 는 CoOp 의 prompt-tuning 이 아닌 완전히 다른 관점 (i.e., fine-tuning) 에서 few-shot learning 을 처리한다는 점에 유의해야 한다.</li><li>이는 prompt-fixed pre-trained vision-language 모델에 대해 residual connection 이 있는 lightweight adapters 를 fine-tuning 하는 것이 prompt engineering 보다 더 나은 성능을 달성할 수 있음을 시사한다.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="423-efficiency-comparison-and-analysis">4.2.3 Efficiency Comparison and Analysis<a href="#423-efficiency-comparison-and-analysis" class="hash-link" aria-label="Direct link to 4.2.3 Efficiency Comparison and Analysis" title="Direct link to 4.2.3 Efficiency Comparison and Analysis">​</a></h3><p><img loading="lazy" alt="Table 1" src="/assets/images/image-4-1dbbda893087b82f91ba2081165a811a.png" width="1592" height="359" class="img_ev3q"></p><p>Tab 1에서, 저자는 여러 방법에 대한 parameter 수, training budget, inference speed 비교를 제공한다.</p><ul><li>baselines 와 비교했을 때, CLIP-Adapter 는 최고의 정확도를 달성하면서도 parameter 와 efficiency 사이에서 best trade-off 를 유지한다.</li><li>구체적으로, CLIP-Adapter 는 Linear probe CLIP 보다 half parameter 만 사용한다.</li><li>CLIP-Adapter 는 Linear probe CLIP 보다 37분 더 소요되지만, 7.89% 의 큰 정확도 향상을 이룬다. 또한, CLIP-Adapter 는 CoOp 보다 16배 적은 training time 과 29배 빠른 inference speed 를 가진다.<ul><li>CoOp 은 적은 수의 parameter 만을 사용하지만, learnable prompt 를 text encoder 앞에 배치하고, Fig. 1 의 녹색 점선으로 표시된 것처럼 forward 및 back propagation 모두 요구한다.</li></ul></li><li>large-scale text encoder 의 weight 와 gradient 를 계산하는 것은 더 많은 GPU memory 와 training time 을 필요로 한다. 반면, CLIP-Adapter 는 hand-crafted prompt 를 활용하며, lightweight adapters 를 통해서만 gradient 를 backpropagation 하여 뛰어난 계산 효율성을 달성한다.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="424-observation-on-optimal-residual-ratio">4.2.4 Observation on Optimal Residual Ratio<a href="#424-observation-on-optimal-residual-ratio" class="hash-link" aria-label="Direct link to 4.2.4 Observation on Optimal Residual Ratio" title="Direct link to 4.2.4 Observation on Optimal Residual Ratio">​</a></h3><p>흥미롭게도, 저자는 optimal residual ratio <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 가 어느 정도 &quot;pretrain-finetuning&quot; paradigm 에서 서로 다른 dataset 의 특성을 반영한다는 것을 관찰한다.</p><ul><li>pre-trained dataset 과 fine-tuning dataset 사이의 의미적 차이가 클수록, CLIP-Adapter 는 original CLIP 의 output 보다 newly adapted feature 에서 더 많은 knowledge 를 학습해야 하므로, larger optimal residual ratio 을 필요로 한다.</li><li>반대로, 의미적 차이가 적을수록 optimal residual ratio 은 작아진다. <ul><li>예로, satellite image 의 EuroSAT 나 detailed textures 의 DTD 같은 specialized domain 의 fine-grained dataset 의 경우, optimal residual ratio <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 는 보통 0.6 에서 0.8 사이에 위치한다.</li><li>반면에, Caltech-101 과 ImageNet 과 같은 종합적이고 일반적인 image dataset 의 경우, optimal <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 은 보통 0.2 정도이다.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="425-variants-with-text-adapter">4.2.5 Variants with Text Adapter<a href="#425-variants-with-text-adapter" class="hash-link" aria-label="Direct link to 4.2.5 Variants with Text Adapter" title="Direct link to 4.2.5 Variants with Text Adapter">​</a></h3><p>CLIP-Adapter 의 다른 two variants, 즉 visual adapter 는 고정하고 text adapter 만 fine-tuning 하는 것과 text 와 visual adapters 모두 fine-tuning 하는 것을 조사한다.</p><p>각 dataset 에 대해 residual ratio 를 수동으로 선택하는 대신, time-efficient 를 고려하여 learnable parameter <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span></span> 를 사용하며, 이는 만족스러운 성능도 달성할 수 있다.</p><p>저자는 두 가지 범주로 나눌 수 있는 4 dataset (EuroSAT &amp; DTD, Caltech101 &amp; ImageNet)에서 이들의 성능을 비교한다.</p><p><img loading="lazy" alt="Figure 5" src="/assets/images/image-5-4f695c9b06953c00540382ae52e73a41.png" width="688" height="560" class="img_ev3q"></p><ul><li>text adapter 와 visual adapter 는 유사한 성능을 발휘하며, 둘 다 Zero-shot CLIP 보다 크게 classification accuracy 를 향상시킨다.</li><li>또한, visual adapter 만 사용하는 것이 text adapter 만 사용하는 것보다 더 좋다.<ul><li>이는 pre-trained dataset 과 fine-tuning dataset 간의 visual feature 의 의미적 차이가 text feature 보다 더 크기 때문에, few-shot image classification 에선 text feature adapting 보다 image feature adapting 이 더 중요하다는 것을 나타낸다.</li></ul></li><li>놀랍게도, both adapters 를 함께 사용하는 것이 visual adapter 만 사용하는 것보다 더 나은 성능을 보이지 않는다.<ul><li>이는 text 와 visual adapter 가 redundant information 을 캡처하거나 심지어 서로 충돌할 수 있음을 시사한다.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="426-where-to-insert-clip-adapter">4.2.6 Where to Insert CLIP-Adapter?<a href="#426-where-to-insert-clip-adapter" class="hash-link" aria-label="Direct link to 4.2.6 Where to Insert CLIP-Adapter?" title="Direct link to 4.2.6 Where to Insert CLIP-Adapter?">​</a></h3><p>기본적으로, 저자는 CLIP 의 encoder end 에 residual-stype adapter 를 삽입한다. 저자는 또한 visual backbone 의 other position 에 adapter 를 장착하는 것을 조사한다.</p><p><img loading="lazy" alt="Table 2" src="/assets/images/image-6-a11f390593de11f80add61417e1f6c85.png" width="1442" height="291" class="img_ev3q"></p><p>Tab. 2 에서, ViT-B/16 을 visual backbone 으로 사용하고, 각각 2, 4, 6, 8, 10, 12th-layer 후에 visual adapter 를 추가한다. 여기서 12th-layer variant 는 저자의 best solution 을 나타낸다.</p><ul><li>저자의 접근법은 end 에 삽입되었을 때 최소한의 계산 비용으로 우수한 성능을 달성한다.</li><li>early layer 에 삽입하면 gradient 를 backpropagation 하기 위해 더 많은 계산 자원이 필요하며, 어느 정도 CLIP 의 pre-trained knowledge 를 손상시킨다.</li><li>all layers 에 adapter 를 삽입하면 총 5.20M parameter 가 생성되며, 이는 12th-layer 에만 삽입하는 것(0.52 M)보다 훨씬 무거운 부담이 된다.<ul><li>후자는 few-shot learning data 의 overfitting 문제를 잘 완화하고, end 에 adapter 를 삽입하여 CLIP 의 pre-trained knowledge 를 크게 보존할 수 있다.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="427-comparison-with-other-adapter-methods">4.2.7 Comparison with Other Adapter Methods<a href="#427-comparison-with-other-adapter-methods" class="hash-link" aria-label="Direct link to 4.2.7 Comparison with Other Adapter Methods" title="Direct link to 4.2.7 Comparison with Other Adapter Methods">​</a></h3><p><img loading="lazy" alt="Table 3" src="/assets/images/image-7-7fed93aac7ee8ea8e6055c6e6bdc26c2.png" width="1446" height="273" class="img_ev3q"></p><p>Tab. 3 에서, 저자는 기존의 adapter-based methods 를 CLIP 에 장착하고 저자의 CLIP-Adapter 와 비교한다.</p><ul><li>저자의 접근법은 성능과 효율성 모두에서 이들을 능가한다.<ul><li>이는 residual connection 을 통해 end 에 adapter 를 삽입하여 CLIP pre-training 에서 얻은 knowledge 를 크게 보존하는 반면, 다른 방법들은 non-residual forms 를 채택하고 backbone 의 middle 에 densely insert 하여 CLIP 의 pre-trained knowledge 에 부정적인 영향을 미치고 overfitting 을 초래하기 때문이다.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="428-comparison-with-elevater-benchmark-baselines">4.2.8 Comparison with ELEVATER Benchmark Baselines<a href="#428-comparison-with-elevater-benchmark-baselines" class="hash-link" aria-label="Direct link to 4.2.8 Comparison with ELEVATER Benchmark Baselines" title="Direct link to 4.2.8 Comparison with ELEVATER Benchmark Baselines">​</a></h3><p><img loading="lazy" alt="Table 4" src="/assets/images/image-8-d41e1ac65e6a36acd580c5f4e4d3185d.png" width="1446" height="235" class="img_ev3q"></p><p>Tab. 4 에서, 저자는 pre-trained vision-language model 에 대해 새롭게 제안된 ELEVATER benchmark 와 CLIP-Adapter 를 비교한다.</p><p>ELEVATER 는 3 baselines 를 포함한다: Random-Init with Two-Projection, Language-Init with Two-Projection, 그리고 Language-Init with One-Projection.</p><ul><li>text encoder 에 randomly initialized additional projection layer 을 학습시키는 것과 비교하여, 저자의 CLIP-Adapter 는 더 높은 classification accuracy 를 달성한다.</li><li>이는 residual design 이 CLIP 의 pre-trained knowledge 를 크게 보존할 수 있기 때문이다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="43-visualization-of-learned-manifold">4.3 Visualization of Learned Manifold<a href="#43-visualization-of-learned-manifold" class="hash-link" aria-label="Direct link to 4.3 Visualization of Learned Manifold" title="Direct link to 4.3 Visualization of Learned Manifold">​</a></h2><p><img loading="lazy" alt="Figure 6" src="/assets/images/image-9-254a61c51fd6abb14c93a30f070242a8.png" width="1173" height="930" class="img_ev3q"></p><p>저자는 EuroSAT dataset 에서 CLIP, CoOp, non-residual CLIP-Adapter, residual CLIP-Adapter 를 학습한 후, t-SNE 를 사용하여 이들의 manifold 를 시각화한다.</p><p>숫자 0 에서 9 는 각각 AnnualCrop, Forest, Herbaceous Vegetation Land, Highway or Road, Industrial Buildings, Pasture Land, Permanent Crop Land, Residential Buildings, River, Sea or Lake categories 를 나타낸다.</p><ul><li>high-dimensional classification space 에서, Fig. 6(d) 에서의 residual CLIP-Adapter 가 서로 다른 categories 에 속한 image features 의 훨씬 더 뚜렷한 분리를 보여준다.</li><li>혼동되기 쉬운 categories 인 Highway or Road (red), Crop Land (pink), Pasture Land (brown)의 경우, 다른 방법들과 비교했을 때 CLIP-Adapter 는 동일 class 의 image manifold 간의 similarity 를 감지하는 데 더 효과적이다. </li><li>요약하자면, 시각화 결과는 CLIP-Adapter 가 few-shot settings 에서 더 나은 feature manifold 를 학습하는 데 능숙하다는 것을 입증한다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="44-ablation-studies">4.4 Ablation Studies<a href="#44-ablation-studies" class="hash-link" aria-label="Direct link to 4.4 Ablation Studies" title="Direct link to 4.4 Ablation Studies">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="441-dimension-of-bottleneck-layer">4.4.1 Dimension of Bottleneck Layer<a href="#441-dimension-of-bottleneck-layer" class="hash-link" aria-label="Direct link to 4.4.1 Dimension of Bottleneck Layer" title="Direct link to 4.4.1 Dimension of Bottleneck Layer">​</a></h3><p>먼저 bottleneck layer 의 hidden dimension 을 변화시키면서 ablation study 를 수행한다.</p><p><img loading="lazy" alt="Table 5" src="/assets/images/image-10-d3ab8e78c60e14b6c12f7eb1e75b822d.png" width="596" height="208" class="img_ev3q"></p><p><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span></span></span></span></span> 는 original image feature 의 dimension 을 나타낸다.</p><ul><li>hidden dimension을 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span></span></span></span></span> 에서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi mathvariant="normal">/</mi><mn>32</mn></mrow><annotation encoding="application/x-tex">D/32</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mord">/32</span></span></span></span></span> 로 줄이면, middle dimension 이 너무 작거나 너무 크면 성능이 크게 저하되며, optimal bottleneck dimension 은 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mi mathvariant="normal">/</mi><mn>4</mn></mrow><annotation encoding="application/x-tex">D/4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">D</span><span class="mord">/4</span></span></span></span></span> 로, 충분한 의미를 보존하면서도 중복되지 않는다는 것을 관찰할 수 있다.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="442-residual-ratio">4.4.2 Residual Ratio<a href="#442-residual-ratio" class="hash-link" aria-label="Direct link to 4.4.2 Residual Ratio" title="Direct link to 4.4.2 Residual Ratio">​</a></h3><p>또한 residual ratio <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 에 대한 ablation study 을 수행한다.</p><p><img loading="lazy" alt="Table 6" src="/assets/images/image-11-eac6f843e6271dfd80f9422c1c61927b.png" width="596" height="208" class="img_ev3q"></p><ul><li>fine-grained dataset DTD 의 optimal residual ratio은 0.6 이며, 일반적인 dataset ImageNet 의 경우 0.2 이다.</li><li>이는 fine-grained dataset 의 adapting 이 old knowledge 보다 더 많은 new knowledge 를 필요로 하고, generic dataset 에선 그 반대라는 Sec. 4.2.4 의 관찰을 검증한다.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 가 0 인 경우 new knowledge 가 학습되지 않으므로 Zero-shot CLIP 과 동일하다.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.0037em">α</span></span></span></span></span> 를 1.0 으로 설정하면 분류는 완전히 적응된 feature(CLIP-Adapter w/o Res)에 의존하게 된다. 그러나 이는 optimal 이 아닌데, CLIP-Adapter 가 이러한 조건에선 over-fitting(overfitting)되는 경향이 있기 때문이다.</li><li>Tab. 6 과 Fig. 6 을 함께 고려하면, CLIP-Adapter 에서 residual connection 을 가지는 장점은 다음과 같다:<ol><li>few-shot examples 에서 over-fitting 을 피하고 Zero-shot knowledge 의 도움으로 CLIP-Adapter 의 generalization 능력을 향상시킨다; </li><li>(2) few-shot fine-tuning 을 통해 더 나은 image feature 또는 classifier weight 를 학습할 자유를 보장한다.</li></ol></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="443-influence-of-prompt-styles">4.4.3 Influence of Prompt Styles<a href="#443-influence-of-prompt-styles" class="hash-link" aria-label="Direct link to 4.4.3 Influence of Prompt Styles" title="Direct link to 4.4.3 Influence of Prompt Styles">​</a></h3><p>다양한 prompt style 이 few-shot 성능에 미치는 영향을 조사한다.</p><p>ImageNet dataset 의 경우, CLIP-Adapter 의 textual input 으로 사용되는 default hard prompt 는 단순히 &quot;a photo of a {class}&quot; 이다. 이외에도 7 hard prompt 를 사용한 prompt ensembling 도 시도한다. </p><p>7 hard prompt templates 은 다음과 같다: &quot;itap of a {class}&quot;, &quot;a bad photo of the {class}&quot;, &quot;a origami {class}&quot;, &quot;a photo of the large {class}&quot;, &quot;a {class} in a video game&quot;, &quot;art of the {class}&quot; 및 &quot;a photo of the small {class}&quot;.</p><p>또 다른 후보 prompt style 은 hard prompt 와 learnable soft prompt 의 혼합이다.</p><p><img loading="lazy" alt="Table 7" src="/assets/images/image-12-09ae8f488bfd59bc7e0244f071a13522.png" width="584" height="202" class="img_ev3q"></p><ul><li>prompt ensemble 전략이 hard prompt 보다 약간 더 우수한 성능을 보이며, 세 가지 prompt style 중에서 최고의 성능을 달성한다.</li><li>결과는 raw texts description 이 다양한 상황에서 효과적이고 견고한 유용한 knowledge 를 포함하고 있음을 입증한다.</li><li>반면, soft prompt 는 명확한 의미를 가지지 않으며, Zero-shot knowledge 를 위한 이상적인 소스가 아니다.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="444-ablation-of-visual-backbones">4.4.4 Ablation of Visual Backbones<a href="#444-ablation-of-visual-backbones" class="hash-link" aria-label="Direct link to 4.4.4 Ablation of Visual Backbones" title="Direct link to 4.4.4 Ablation of Visual Backbones">​</a></h3><p>few-shot learning 성능에 대한 visual backbone 의 영향을 연구한다 (16-shot).</p><p>후보 visual backbone 에는 ResNet-50, ResNet-101, ViT-B/32, 그리고 ViT-B/16 이 포함된다.</p><p><img loading="lazy" alt="Table 8" src="/assets/images/image-13-0ef626f6d328de04ad45fc62466d6034.png" width="1197" height="218" class="img_ev3q"></p><p>CLIP-Adapter 는 DTD 및 ImageNet dataset 모두에서 visual backbone 을 다양하게 변경해도 CoOp 보다 항상 우수한 성능을 발휘한다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="445-robustness-under-distribution-shift">4.4.5 Robustness Under Distribution Shift<a href="#445-robustness-under-distribution-shift" class="hash-link" aria-label="Direct link to 4.4.5 Robustness Under Distribution Shift" title="Direct link to 4.4.5 Robustness Under Distribution Shift">​</a></h3><p>CLIP-Adapter 의 robustness 을 추가로 검증하기 위해, 저자는 distribution shift 에 따른 성능 변화를 관찰하기 위한 실험도 수행한다.</p><p>ImageNet 에서 CLIP-Adapter 를 학습시키고, 각각 4 out-of-distribution dataset: ImageNetV2, ImageNet-Sketch, ImageNet-A, 그리고 ImageNet-R 에서 평가한다.</p><p><img loading="lazy" alt="Table 9" src="/assets/images/image-14-717baeb243d2aa73ef460b5470ea6e91.png" width="1197" height="274" class="img_ev3q"></p><p>CLIP-Adapter 는 다른 baselines 보다 항상 우수한 성능을 발휘하며, distribution shift 에 대한 충분한 robustness 을 보여준다.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="446--finetuning-whole-clip-versus-clip-adapter">4.4.6  Finetuning Whole CLIP versus CLIP-Adapter<a href="#446--finetuning-whole-clip-versus-clip-adapter" class="hash-link" aria-label="Direct link to 4.4.6  Finetuning Whole CLIP versus CLIP-Adapter" title="Direct link to 4.4.6  Finetuning Whole CLIP versus CLIP-Adapter">​</a></h3><p>CLIP 을 full fine-tuning 하면 over-fitting 이 발생할 수 있다는 주장을 검증하기 위해, 저자는 CLIP-Adapter 의 다양한 구성 요소에 대한 ablation study 을 수행한다 (training 을 위해 freezing 을 해제).</p><p>CLIP 의 encoder 를 fine-tuning 할 때는 최고 정확도를 얻기 위해 제안된 대로 early stopping 을 사용한다.</p><p><img loading="lazy" alt="Alt text" src="/assets/images/image-15-667c93764cf52d1236a821d680eedecd.png" width="1198" height="237" class="img_ev3q"></p><ul><li>CLIP 의 visual 또는 text encoder 를 fine-tuning 하면 성능이 저하되고 training time이 더 오래 걸린다는 것을 알 수 있다.</li><li>이는 hude-parameter CLIP 이 few-shot dataset 에서 over-fitting 된다는 것을 나타내며, 제안된 adapter 의 효과를 증명한다.</li></ul><h1>5. Conclusions and Future Work</h1><p>저자는 CLIP-Adapter 를 few-shot image classification 를 위한 prompt-based 접근 방식의 대안으로 제시한다. </p><p>CLIP-Adapter 는 small additional bottleneck layer 만 fine-tuning 하여 &quot;pretrain-finetuning&quot; paradigm 을 되살린다. </p><p>generalization 능력을 더욱 향상시키기 위해, 저자는 residual ratio 로 parameterized residual connection 을 채택하여 Zero-shot knowledge 와 newly adapted feature 를 동적으로 혼합한다.</p><p>실험 결과, CLIP-Adapter 는 다양한 few-shot settings 에서 11 image classification dataset 에서 경쟁력 있는 baselines 보다 뛰어난 성능을 발휘한다.</p><p>광범위한 ablation study 은 저자의 설계를 입증하며, CLIP-Adapter 가 더 나은 특징 manifold 를 학습하는 능력을 증명한다.</p><h1>A Result Comparison Under CLIP-Style Preprocessing</h1><p><img loading="lazy" alt="Figure 7" src="/assets/images/image-16-8b0e0c61ad07dea345acd4473e5258b6.png" width="840" height="944" class="img_ev3q"></p><p>Fig. 7 에서 저자는 11 dataset 에서의 few-shot learning 에 대한 CLIP-stype preprocessing 하에서의 결과 비교를 제시한다.</p><p>CoOp-style preprocessing 과 비교했을 때, 모든 방법의 성능이 CLIP-stype preprocessing 하에서 향상된다.</p><p>본문에 있는 Fig. 3 과 유사하게, CLIP-Adapter 는 여전히 다양한 shot 설정에서 다른 baselines 보다 우수한 성능을 보인다.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/clip-adapter">CLIP-Adapter</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/adapter">Adapter</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/few-shot-learning">Few-shot learning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/multi-modal">multi-modal</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/clip">CLIP</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/Vision-Language/PEFT/Module/2021-10-CLIP-Adapter.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Paper/Vision-Language/PEFT/Composition/CLIP-LoRA"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Low-Rank Few-Shot Adaptation of Vision-Language Models</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Paper/Vision-Language/PEFT/Module/Tip-Adapter"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tip-Adapter: Training-Free Adaption of CLIP for Few-Shot Classification</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#21-model-fine-tuning" class="table-of-contents__link toc-highlight">2.1 Model Fine-Tuning</a></li><li><a href="#22-prompt-design" class="table-of-contents__link toc-highlight">2.2 Prompt Design</a></li><li><a href="#23-vision-language-models" class="table-of-contents__link toc-highlight">2.3 Vision-Language Models</a></li><li><a href="#31-classifier-weight-generation-for-few-shot-learning" class="table-of-contents__link toc-highlight">3.1 Classifier Weight Generation for Few-Shot Learning</a></li><li><a href="#32-clip-adapter" class="table-of-contents__link toc-highlight">3.2 CLIP-Adapter</a></li><li><a href="#33-variants-of-clip-adapter" class="table-of-contents__link toc-highlight">3.3 Variants of CLIP-Adapter</a></li><li><a href="#41-experimental-setups" class="table-of-contents__link toc-highlight">4.1 Experimental Setups</a><ul><li><a href="#411-datasets" class="table-of-contents__link toc-highlight">4.1.1 Datasets</a></li><li><a href="#412-implementation-details" class="table-of-contents__link toc-highlight">4.1.2 Implementation Details</a></li><li><a href="#413-notes-on-image-pre-processing" class="table-of-contents__link toc-highlight">4.1.3 Notes on Image Pre-processing</a></li></ul></li><li><a href="#42-comparison-on-few-shot-learning" class="table-of-contents__link toc-highlight">4.2 Comparison on Few-Shot Learning</a><ul><li><a href="#421-baseline-models" class="table-of-contents__link toc-highlight">4.2.1 Baseline Models</a></li><li><a href="#422-performance-comparison-and-analysis" class="table-of-contents__link toc-highlight">4.2.2 Performance Comparison and Analysis</a></li><li><a href="#423-efficiency-comparison-and-analysis" class="table-of-contents__link toc-highlight">4.2.3 Efficiency Comparison and Analysis</a></li><li><a href="#424-observation-on-optimal-residual-ratio" class="table-of-contents__link toc-highlight">4.2.4 Observation on Optimal Residual Ratio</a></li><li><a href="#425-variants-with-text-adapter" class="table-of-contents__link toc-highlight">4.2.5 Variants with Text Adapter</a></li><li><a href="#426-where-to-insert-clip-adapter" class="table-of-contents__link toc-highlight">4.2.6 Where to Insert CLIP-Adapter?</a></li><li><a href="#427-comparison-with-other-adapter-methods" class="table-of-contents__link toc-highlight">4.2.7 Comparison with Other Adapter Methods</a></li><li><a href="#428-comparison-with-elevater-benchmark-baselines" class="table-of-contents__link toc-highlight">4.2.8 Comparison with ELEVATER Benchmark Baselines</a></li></ul></li><li><a href="#43-visualization-of-learned-manifold" class="table-of-contents__link toc-highlight">4.3 Visualization of Learned Manifold</a></li><li><a href="#44-ablation-studies" class="table-of-contents__link toc-highlight">4.4 Ablation Studies</a><ul><li><a href="#441-dimension-of-bottleneck-layer" class="table-of-contents__link toc-highlight">4.4.1 Dimension of Bottleneck Layer</a></li><li><a href="#442-residual-ratio" class="table-of-contents__link toc-highlight">4.4.2 Residual Ratio</a></li><li><a href="#443-influence-of-prompt-styles" class="table-of-contents__link toc-highlight">4.4.3 Influence of Prompt Styles</a></li><li><a href="#444-ablation-of-visual-backbones" class="table-of-contents__link toc-highlight">4.4.4 Ablation of Visual Backbones</a></li><li><a href="#445-robustness-under-distribution-shift" class="table-of-contents__link toc-highlight">4.4.5 Robustness Under Distribution Shift</a></li><li><a href="#446--finetuning-whole-clip-versus-clip-adapter" class="table-of-contents__link toc-highlight">4.4.6  Finetuning Whole CLIP versus CLIP-Adapter</a></li></ul></li></ul></div></div></div><div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Won-Yong Jo, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.e1d9a069.js"></script>
<script src="/assets/js/main.d9c907f3.js"></script>
</body>
</html>