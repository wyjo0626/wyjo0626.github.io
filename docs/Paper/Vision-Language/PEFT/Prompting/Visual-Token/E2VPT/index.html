<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Paper/Vision-Language/PEFT/Prompting/Visual-Token/2023-07-E2VPT">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">E^2VPT: An Effective and Efficient Approach for Visual Prompt Tuning | My Site</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/E2VPT"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="E^2VPT: An Effective and Efficient Approach for Visual Prompt Tuning | My Site"><meta data-rh="true" name="description" content="논문 및 이미지 출처 :"><meta data-rh="true" property="og:description" content="논문 및 이미지 출처 :"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/E2VPT"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/E2VPT" hreflang="en"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/E2VPT" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="My Site RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="My Site Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.d2ad26d0.css">
<link rel="preload" href="/assets/js/runtime~main.947e1592.js" as="script">
<link rel="preload" href="/assets/js/main.d6888401.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WYJLab</b></a><a class="navbar__item navbar__link" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Paper</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Computer Vision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Machine Learning/Regularization/Dropout/Dropout">Machine Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/NLP/Analysis/Contextualized Representation">NLP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Survey/Prompting">Survey</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/UPL">Vision-Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/UPL">Unsupervised Prompt Learning for Vision-Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/Img2LLM">From Images to Textual Prompts: Zero-shot Visual Question Answering with Frozen Large Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/Prismer">Prismer: A Vision-Language Model with An Esemble of Experts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Contrastive Learning/ALIGN">Contrastive Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Composition/CLIP-LoRA">PEFT</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Composition/CLIP-LoRA">Composition</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Module/CLIP-Adapter">Module</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Multi-Modality/MaPLe">Multi-Modality</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Pixel-Level/CMAR">Prompting</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Pixel-Level/CMAR">Pixel-Level</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Textual-Token/CoOp">Textual-Token</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/VPT">Visual-Token</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/VPT">Visual Prompt Tuning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/DePT">Visual Prompt Tuning For Test-time Domain Adaptation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/LPT">LPT: Long-Tailed Prompt Tuning For Image Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/CVP">Convolutional Visual Prompt for Robust Visual Perception</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/E2VPT">E^2VPT: An Effective and Efficient Approach for Visual Prompt Tuning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/SA2VP">SA^2VPT: Spatially Aligned-and-Adapted Visual Prompt</a></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Single-Stream/VLBERT">Single-Stream</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Two-Stream/LXMERT">Two-Stream</a></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Programming/Algorithm/">Programming</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Paper</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Vision-Language</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">PEFT</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Prompting</span><meta itemprop="position" content="4"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Visual-Token</span><meta itemprop="position" content="5"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">E^2VPT: An Effective and Efficient Approach for Visual Prompt Tuning</span><meta itemprop="position" content="6"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>E^2VPT: An Effective and Efficient Approach for Visual Prompt Tuning</h1></header><p>논문 및 이미지 출처 : <a href="https://openaccess.thecvf.com/content/ICCV2023/papers/Han_E2VPT_An_Effective_and_Efficient_Approach_for_Visual_Prompt_Tuning_ICCV_2023_paper.pdf" target="_blank" rel="noopener noreferrer">https://openaccess.thecvf.com/content/ICCV2023/papers/Han_E2VPT_An_Effective_and_Efficient_Approach_for_Visual_Prompt_Tuning_ICCV_2023_paper.pdf</a></p><h1>Abstract</h1><p>Transformer-based model 크기가 계속 커짐에 따라 new tasks 를 위해 이러한 large-scale pre-trained vision model 을 fine-tuning 하는 것은 점점 더 많은 parameter 를 필요로 함</p><p>parameter-efficient learning 은 fine-tuning 중 tunable parameter 수를 줄이기 위해 개발됨</p><p>이러한 방법들이 유망한 결과를 보이지만, 여전히 full fine-tuning 과 비교하여 상당한 성능 격차가 존재</p><p>이 도전 과제를 해결하기 위해 저자는 large-scale Transformer-based model adapting 을 위한 Effective 및 Efficient Visual Prompt Tuning (E<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>VPT) 제안</p><ul><li>구체적으로, 저자는 self-attention 과 input layer 에 각각 learnable key-value prompts 와 visual prompt 를 도입하여 model fine-tuning 의 효과를 향상</li><li>또한, 모델 성능을 유지하면서 low importance prompts 를 systematically pruning 하는 prompt pruning procedure 를 설계하여 모델의 효율성을 크게 향상시킴.</li><li>실험 결과, 저자의 접근 방식은 two benchmarks 에서 SOTA baselines 를 능가하며, considerably low parameter usage (e.g., VTAB-1k 에서 model parameters 0.32%)을 나타냄.</li></ul><h1>1. Introduction</h1><p>AI 의 발전은 성능 향상 뿐 아닌 지속 sustainable deployment 에도 중점을 둬야 한다. visual task 에선 성능 개선을 추구하는게 매력적이지만, 현재 model size 가 빠르게 증가함에 따라 energy-intensive 및 computationally expensive training 이 필요하게 되었다.</p><p>Transformer-based architecture 는 현재 ViT-Huge (632M) 와 Swin-Large (197M) 와 같은 visual model 에서 지배적이며, 이는 ResNet (25M) 같은 CNN 보다 훨씬 더 많은 파라미터를 포함한다.</p><p>이러한 large-scale model 에 대한 scratch training 은 limitied data 와 낮은 정확도에서의 느린 수렴 등의 문제를 야기한다. 이러한 문제를 극복하기 위한 일반적인 패러다임은 <em>pretrain-then-finetune</em> 으로, 이는 방대한 양의 training data 필요성을 줄이고 다양한 visual tasks 의 처리를 가속화한다.</p><p>그러나 traditional <em>full fine-tuning</em>  은 각 task 에 대해 backbone parameter 의 complete copy 를 저장하고 배포해야 하므로 계산 비용이 많이 들고 빠른 모델 배포에 적합하지 않다.</p><hr><p>이 문제를 해결하기 위해 크게 세 가지 주요 범주로 나눌 수 있다: partial tuning, extra module 및 prompt tuning</p><ul><li><em>Partial tuning</em> : classifier head 또는 last few layers 같은 backbone 의 일부만 fine-tuning 하고 나머지는 freezing</li><li><em>Extra module</em> : network 에 learnable bias term 또는 additional adapters 를 삽입하여 적응</li><li><em>Prompt Tuning</em> :  Transformer 의 input layer 에 prompt token 을 추가하여 backbone 자체를 변경하거나 fine-tuning 하지 않음</li></ul><p>이러한 모든 방법은 <em>pretrain-then-finetune</em> 패러다임 내에서 작동하여 full fine-tuning 과 비교하여 learnable parameter 수를 줄일 수 있다. 그러나 유망한 결과에도 불구하고, 기존의 parameter-efficient approach 에는 두 가지 주요 한계가 있다.</p><ol><li>이들은 Transformer 의 self-attention mechanism 의 core architecture 를 면밀히 조사하지 않아 full fine-tuning 과 큰 성능 격차가 발생</li><li>합리적인 성능을 달성하기 위해 비교적 많은 수의 파라미터를 fine-tuning 해야 하며, parameter-efficiency 의 극한을 탐구하지 못함.</li></ol><p>이 관점은 두 근본적인 질문으로 이어짐: </p><p>이러한 관점은 두 가지 근본적인 질문으로 이어집니다: ❶ large-scale transformer-based vision models 에 대해 prompt tuning 의 <strong>effectiveness</strong> 를 어떻게 입증할 수 있는가? ❷ tunable parameters 를 줄이기 위해 parameter <strong>efficiency</strong> 의 극한을 어떻게 탐구할 수 있을까?</p><p>이 두 가지 질문이 저자의 연구의 기초이다. 저자는 직관은 이전의 prompt tuning 처럼 input 수정에만 집중하는 대신, fine-tuning 중 self-attention mechanism 을 개선할 잠재력을 명확히 조사하고, parameter efficiency 의 극한을 탐구해야 한다는 것</p><p>question ❶ 에 대한 응답으로, </p><ul><li>저자는 Transformer 의 self-attention mechanism 을 분석하고, 이는 global context 내에서 long-range token dependencies 을 capture 하는데 중요한 역할을 함.</li><li>input visual prompt 에 추가하여, 저자는 learnable key-value prompts 를 도입하고 이를 self-attention layer 의 key 및 value matrices 에 통합</li><li>key-value prompts 는 fine-tuning 중 input visual prompts 와 함께 jointly learning</li><li>이 접근법은 Transformer 의 well-designed prompt architecture 을 효과적으로 활용하여 상당한 성능 향상을 가져옴.</li><li>또한, 현재 Transformer architecture 에 대한 일반적인 plug-and-play prompt module 을 제공하며, vision domain 에서 언급된 모든 연구와 개념적으로 다른 fine-tuning solution 을 제공</li></ul><p>question ❷ 에 대한 동기 부여로, </p><ul><li>저자는 model performance 를 유지하면서 parameter 수를 줄이기 위한 pruning 전략을 제안</li><li>저자의 접근법은 주어진 task 에 대해 original over-parameterized network 의 text accuracy 를 맞출 수 있는 sub-network 가 존재한다는 lottery ticket hypothesis (LTH) 에서 영감을 받음.</li><li>이 패러다임을 바탕으로, 저자는 prompt tuning 의 핵심 설계를 재검토하고 learnable parameter 수를 더욱 줄임</li><li>구체적으로, 성능에 크게 기여하는 prompt token 을 유지하면서 fine-tuning 중 redundant 또는 unnecessary prompt tokens 을 pruning</li><li>이러한 불필요한 prompt 를 pruning 함으로써 prompt tuning efficiency 를 크게 향상시키면서 성능을 유지</li></ul><p>question ❶-❷ 에 대한 답변으로, 저자는 <strong>E</strong>ffective 및 <strong>E</strong>fficient <strong>V</strong>isual <strong>P</strong>rompt <strong>T</strong>uning (E<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>VPT)을 제안</p><ul><li>E2VPT 는 architecture aware 및 pruning-anchored  의 novel prompt tuning framework</li><li>저자 제안하는 접근법은 visual 및 key-value prompt 를 설계하여 fewer parameters 로 우수한 성능을 달성하는 방법을 자세히 설명</li><li>다양한 벤치마크, 백본 및 다른 pre-training objectives 에 대한 설득력 있는 실험 결과를 제시</li><li>구체적으로, 저자의 접근법은 VTAB-1k 에서 full fine-tuning 과 비교하여 평균 5.85% 의 정확도 향상을 달성하며, VPT 와 비교하여 1.99% 향상</li><li>더욱이, 기존 방법보다 훨씬 적은 learnable parameters 를 사용하며, VTAB-1k 에서 백본 파라미터의 평균 0.32% 만을 차지함. </li><li>저자는 또한 VPT 와의 비교 우위를 hyperbolic visualization 을 통해 설명.</li><li>마지막으로, language domain 에 대한 강력한 알고리즘 일반화를 설명합니다.</li></ul><h1>2. Related Work</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="21-vision-transformers">2.1. Vision Transformers<a href="#21-vision-transformers" class="hash-link" aria-label="Direct link to 2.1. Vision Transformers" title="Direct link to 2.1. Vision Transformers">​</a></h2><p>NLP 에서 Transformer 의 성공에 영감을 받아, 이를 image classification, image segmentation, objective detection, pose estimation 등 다양한 supervised vision tasks 로 확장함.</p><p>또한, Self-supervised pre-training 패러다임도 탐구되어 SOTA 도출</p><p>Transformer 는 visual-related 분야에 탁월한 성능과 확장성 덕분에 CNN 을 능가한다. </p><p>그러나 다양한 vision task 에 Transformer 를 적용하기 위해 필요한 상당한 계산 및 parameter overhead 는 무시할 수 없다</p><p>예를 들어, 최근의 Transformer-based model 인 MViTv2-Large (218M), ViT-G (1.8B), SwinV2-G (3.0B), V-MoE (14.7B) 는 상당한 계산 비용을 초래한다.</p><p>따라서 저자는 Transformer-based architecture 의 계산 비용을 줄이면서 pretrain-then-finetune 패러다임에서 높은 성능을 유지하도록 설계된 E2VPT 를 제안한다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="22-parameter-efficient-fine-tuning">2.2. Parameter-efficient Fine-tuning<a href="#22-parameter-efficient-fine-tuning" class="hash-link" aria-label="Direct link to 2.2. Parameter-efficient Fine-tuning" title="Direct link to 2.2. Parameter-efficient Fine-tuning">​</a></h2><p>비전 커뮤니티에선 Vision Transformer 의 등장과 함께 효율적인 모델 훈련이 많은 관심을 받고 있지만, 이러한 모델들은 효과적이고 널리 사용되지만 실질적인 배포와 적응에는 너무 큰 경우가 많음.</p><p>그 결과, pretrain-then-finetune 패러다임이 일반적으로 사용된다. full fine-tuning 은 강력한 성능을 보장하지만, 네트워크의 all parameters 를 업데이트하는 데 드는 비용이 많이 든다.</p><p>이 문제를 극복하기 위해, 연구자들은 parameter efficiency 와 강력한 성능 간의 균형을 맞추는 대안을 탐구하고 있으며, 이는 크게 세 가지 그룹으로 나눌 수 있음: <em>partial tuning</em>, <em>extra module</em>, <em>prompt tuning</em>.</p><ul><li><em>Partial tuning</em> : PEFT 로 널리 사용됨. 이 방법은 대부분의 백본을 고정하고, fewer parameters 만 fine-tuning.<ul><li>예로, linear 또는 MLP head 또는 백본의 일부 blocks/layers 만 fine-tuning</li><li>이 방법은 간단하고 구현이 쉽지만, full fine-tuning 에 비해 성능 격차가 큰 경우가 많음. </li></ul></li><li><em>Extra module</em> :  fine-tuning 을 위해 learnable plug-in architecture 설계<ul><li>예로, original network 를 고정하면서 side structure 도입</li><li>백본에 additional residual units 을 삽입한 연구도 있음.</li><li>그러나 이러한 방법의 단점은 inserted module 이 특정 architecture 에 맞춤화되어 다른 아키텍처에는 일반화되지 않을 수 있다는 점</li><li>또한, 이러한 모듈은 partial tuning 에 비해 더 많은 파라미터를 소모하는 경우가 많음. </li></ul></li><li><em>Prompt tuning</em> : 이는 원래 language domain 에서 빠른 모델 적응을 위해 제안됨.<ul><li>이 방법은 백본의 input 에 learnable vector set 을 추가하고, fine-tuning 중 이 task-specific prompt 만 update.</li><li>최근에는 visual-related prompting 이 vision domain 에 도입되어 input sequence 에 visual prompt 를 설계하고 full fine-tuning 과 competitive performance 를 보임</li><li>그러나 현재의 방법들은 Transformer-based architecture 의 내부 설계를 고려하지 않아 덜 효과적인 prompting solution 제공</li></ul></li></ul><p>반면, 저자는 아키텍처를 고려하고 pruning 을 기반으로 하여, 위에서 논의된 방법들과 개념적으로 차별화.</p><h1>3. Our E<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mrow></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>VPT Approach</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-problem-definition">3.1 Problem Definition<a href="#31-problem-definition" class="hash-link" aria-label="Direct link to 3.1 Problem Definition" title="Direct link to 3.1 Problem Definition">​</a></h2><p>large data set 및 task 에 pre-training 된 vision transformer <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> 가 있다고 가정.</p><ul><li>vision transformer 의 input patches sequence <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mrow><msub><mi>I</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>I</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>I</mi><mi>m</mi></msub></mrow></mrow><annotation encoding="application/x-tex">I = {I_1, I_2, ... , I_m}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span></span> 로<ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">m</span></span></span></span></span> : image patch total number</li></ul></li><li>각 patch 는 positional encoding 을 사용해 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span></span>-dimensional 로 project<ul><li>즉, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>E</mi><mi>j</mi></msub><mi mathvariant="normal">∣</mi><mn>1</mn><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>m</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">E = \{E_j | 1 ≤ j ≤ m\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mord">∣1</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05724em">j</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal">m</span><span class="mclose">}</span></span></span></span></span> 이며 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>j</mi></msub><mo>=</mo><mi>E</mi><mi>m</mi><mi>b</mi><mo stretchy="false">(</mo><msub><mi>I</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">E_j = Emb(I_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mord mathnormal">mb</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:-0.0785em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span>. </li></ul></li><li>vision transformer <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> 는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span> identical transformer layers 로 구성되며, 다음과 같음:</li></ul><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>Z</mi><mn>1</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>L</mi><mn>1</mn></msub><mo stretchy="false">(</mo><mi>E</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>Z</mi><mi>i</mi></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>L</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msup><mi>Z</mi><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>N</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \begin{align*} Z^1 &amp;= L_1(E) \\ Z^i &amp;= L_i(Z^{i-1}) \quad i = 2, 3, ..., N \end{align*} \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0588em;vertical-align:-1.2794em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7794em"><span style="top:-3.7794em"><span class="pstrut" style="height:3.7794em"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7794em"><span style="top:-3.9153em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3806em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2794em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7794em"><span style="top:-3.9153em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mclose">)</span></span></span><span style="top:-2.3806em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2794em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2794em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7794em"><span style="top:-3.7794em"><span class="pstrut" style="height:3.7794em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2794em"><span></span></span></span></span></span></span></span></span></div><ul><li>각 transformer layer 는 multi-head self-attention (MSA) 와 feed-forward (FFN) 의 stack:</li></ul><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>L</mi><mo stretchy="false">(</mo><mo separator="true">⋅</mo><mo stretchy="false">)</mo><mo>=</mo><mi>F</mi><mi>F</mi><mi>N</mi><mo stretchy="false">(</mo><mi>M</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mo separator="true">⋅</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} L(·) = FFN (MSA (·)) \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal" style="margin-right:0.10903em">FFN</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">MS</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-2.85em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span></span></div><p>new task 가 주어졌을때, target 은 small parameters 만 tuning 하면서 task 에서 good performance 를 낼 수 있는 model <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>T</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9468em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1667em"><span class="mord">^</span></span></span></span></span></span></span></span></span></span></span> 를 fine-tuning 하는 것이다.</p><p>visual prompt tuning 의 맥락에서, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>T</mi><mo>^</mo></mover><mo>=</mo><mrow><mstyle mathcolor="skyblue"><mi>T</mi></mstyle><mo separator="true">,</mo><mstyle mathcolor="red"><mi>P</mi></mstyle></mrow></mrow><annotation encoding="application/x-tex">\hat{T} = {\textcolor{skyblue}{T}, \textcolor{red}{P}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9468em"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9468em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span><span style="top:-3.2523em"><span class="pstrut" style="height:3em"></span><span class="accent-body" style="left:-0.1667em"><span class="mord">^</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;color:skyblue">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em;color:red">P</span></span></span></span></span></span> 는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="skyblue"><mtext>frozen</mtext></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{skyblue}{\text{frozen}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text" style="color:skyblue"><span class="mord" style="color:skyblue">frozen</span></span></span></span></span></span> backbone <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="skyblue"><mtext>T</mtext></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{skyblue}{\text{T}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text" style="color:skyblue"><span class="mord" style="color:skyblue">T</span></span></span></span></span></span> 와 very few tunable parameters 인 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mtext>trainable</mtext></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{\text{trainable}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text" style="color:red"><span class="mord" style="color:red">trainable</span></span></span></span></span></span> prompts  <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><mtext>P</mtext></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{\text{P}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord text" style="color:red"><span class="mord" style="color:red">P</span></span></span></span></span></span> 를 포함</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-effective-prompting">3.2 Effective Prompting<a href="#32-effective-prompting" class="hash-link" aria-label="Direct link to 3.2 Effective Prompting" title="Direct link to 3.2 Effective Prompting">​</a></h2><p>기존 prompt tuning 은 Transformer layer 의 input sequence 에 visual prompt 를 추가해 tuning 하는데 중점을 두며, Transformer arhcitecture 내부 설계는 고려하지 않음.</p><p>그러나 prompt tuning 의 효과를 높이고 optimal fine-tuning 의 성능을 달성하기 위해, 저자는 input sequence 내의 visual prompts <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">P_I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 외에도 key-value prompt <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">P_K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">P_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 통합하는 새로운 접근 방식을 제안</p><p>직관적으로, input sequence 에 삽입된 input visual prompts 는 new task 를 나타내기 위해 학습됨</p><p>key-value prompt 는 self-attention module 의 key 밒 value parameter matrices 와 결합되어 data 에서 new attention pattern 을 capture 하는 것을 학습</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="visual-prompts">Visual Prompts<a href="#visual-prompts" class="hash-link" aria-label="Direct link to Visual Prompts" title="Direct link to Visual Prompts">​</a></h4><p>visual prompts 는 input visual tokens 와 동일한 dimensionality 를 가지는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi></mrow><annotation encoding="application/x-tex">d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">d</span></span></span></span></span>-dimensional embedding vectors set 이다.</p><ul><li>이 prompts 는 각 transformer encoder layer 의 input sequence 에 추가되어 all input tokens 와 상호작용.</li><li>visual prompt 는 traditional prompt tuning method 의 prompt token 과 유사한 역할을 하며, model 이 new task 를 수행하도록 하는 task-specific embeddings 를 학습</li><li>형식적으로, 이러한 visual prompt 는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>I</mi></msub><mo>=</mo><mo stretchy="false">{</mo><msubsup><mi>P</mi><mi>I</mi><mn>1</mn></msubsup><mo separator="true">,</mo><msubsup><mi>P</mi><mi>I</mi><mn>2</mn></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mi>P</mi><mi>I</mi><mi>N</mi></msubsup><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">P_I = \{ P^1_I, P^2_I, ... , P^N_I \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1.1167em;vertical-align:-0.2753em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> 로 정의<ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>I</mi><mi>i</mi></msubsup></mrow><annotation encoding="application/x-tex">P^i_I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1em;vertical-align:-0.2753em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8247em"><span style="top:-2.4247em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em">I</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2753em"><span></span></span></span></span></span></span></span></span></span></span> : <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">i_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> encoder layer 의 learnable visual prompts</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span> : layer total number</li></ul></li><li>이후 encoder layer 는 다음과 같이 나타냄:</li></ul><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>Z</mi><mn>1</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mstyle mathcolor="skyblue"><msub><mtext>L</mtext><mn>1</mn></msub></mstyle><mo stretchy="false">(</mo><mstyle mathcolor="red"><msubsup><mtext>P</mtext><mi>I</mi><mn>1</mn></msubsup></mstyle><mo separator="true">,</mo><mstyle mathcolor="skyblue"><mi>E</mi></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><msup><mi>Z</mi><mi>i</mi></msup></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mstyle mathcolor="skyblue"><msub><mtext>L</mtext><mi>i</mi></msub></mstyle><mo stretchy="false">(</mo><mstyle mathcolor="red"><msubsup><mtext>P</mtext><mi>I</mi><mi>i</mi></msubsup></mstyle><mo separator="true">,</mo><msup><mi>Z</mi><mi>z</mi></msup><mo stretchy="false">)</mo><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>N</mi></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \begin{align*} Z^1 &amp;= \textcolor{skyblue}{\text{L}_1} (\textcolor{red}{\text{P}^1_I}, \textcolor{skyblue}{E}) \\ Z^i &amp;= \textcolor{skyblue}{\text{L}_i} (\textcolor{red}{\text{P}^i_I}, Z^{z})\quad i = 2, 3, ..., N \end{align*} \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.1052em;vertical-align:-1.3026em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8026em"><span style="top:-3.8026em"><span class="pstrut" style="height:3.8026em"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8026em"><span style="top:-3.9153em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span><span style="top:-2.3574em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8747em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3026em"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8026em"><span style="top:-3.9153em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord" style="color:skyblue"><span class="mord text" style="color:skyblue"><span class="mord" style="color:skyblue">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:skyblue"><span class="mord mtight" style="color:skyblue">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord" style="color:red"><span class="mord text" style="color:red"><span class="mord" style="color:red">P</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8873em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathnormal mtight" style="margin-right:0.07847em;color:red">I</span></span></span><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05764em;color:skyblue">E</span><span class="mclose">)</span></span></span><span style="top:-2.3574em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord" style="color:skyblue"><span class="mord text" style="color:skyblue"><span class="mord" style="color:skyblue">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em"><span style="top:-2.55em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:skyblue"><span class="mord mathnormal mtight" style="color:skyblue">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord" style="color:red"><span class="mord text" style="color:red"><span class="mord" style="color:red">P</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8979em"><span style="top:-2.453em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathnormal mtight" style="margin-right:0.07847em;color:red">I</span></span></span><span style="top:-3.1362em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathnormal mtight" style="color:red">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7144em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em">z</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:1em"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3026em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3026em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8026em"><span style="top:-3.8026em"><span class="pstrut" style="height:3.8026em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.3026em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>Z</mi><mi>i</mi></msup></mrow><annotation encoding="application/x-tex">Z^i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8247em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">Z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8247em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span></span></span></span></span></span></span></span> : <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">i_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8095em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">i</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> encoder layer 에 의해 계산된 context embedding</li><li>input image patches <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi></mrow><annotation encoding="application/x-tex">E</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span></span></span></span></span> 의 embedding 은 backbone 의 frozen Emb projection 으로 초기화</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="key-value-prompts">Key-Value Prompts<a href="#key-value-prompts" class="hash-link" aria-label="Direct link to Key-Value Prompts" title="Direct link to Key-Value Prompts">​</a></h4><ul><li>visual prompt 는 new task 에 대한 knowledge learning 에 유용</li><li>하지만 new data 에서의 information interaction 유도에는 충분하지 않다. 이는 new data 에서의 fine-tuning 이 image distribution 을 pre-trained image examples 와 크게 다를 수 있기 때문.</li><li>따라서 fine-tuning data 에서 new information 을 capture 하고 new pattern 을 학습하기 위해 input token 간의 attention 을 더욱 효과적으로 수행하는 모델 능력을 강화하는 것이 중요</li></ul><p><img loading="lazy" alt="Figure 2" src="/assets/images/image-40-dc94eee52f72dc8fadb893ec499b0725.png" width="1480" height="595" class="img_ev3q"></p><p>이를 위해, 저자는 각 encoder layer 내의 attention module 에 new key-value prompts set <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">P_K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">P_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 도입하는 새로운 접근 방식 제안 (Fig. 2(a))</p><ul><li>이러한 key-value prompts 는 few columns 이지만, original attention module 의 key-value matrices 와 동일한 raws 를 가지는 small matrices</li><li>new attention 계산을 위해, key 밒 value matrices 은 각각 해당하는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">P_K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">P_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> prompt 와 결합<ul><li>이 과정은 다음과 같이 정의:</li></ul></li></ul><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mtable rowspacing="0.25em" columnalign="right" columnspacing=""><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>L</mi><mo stretchy="false">(</mo><mo separator="true">⋅</mo><mo stretchy="false">)</mo><mo>=</mo><mstyle mathcolor="skyblue"><mtext>FFN</mtext></mstyle><mo stretchy="false">(</mo><mstyle mathcolor="red"><mtext>MSA</mtext></mstyle><mo stretchy="false">(</mo><mo separator="true">⋅</mo><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>M</mi><mi>S</mi><mi>A</mi><mo stretchy="false">(</mo><mo separator="true">⋅</mo><mo stretchy="false">)</mo><mo>=</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mo stretchy="false">(</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mfrac><mrow><mstyle mathcolor="skyblue"><msub><mi>Q</mi><mi>h</mi></msub></mstyle><msup><mstyle mathcolor="red"><msubsup><mi>K</mi><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mstyle><mi>T</mi></msup></mrow><msqrt><mi>d</mi></msqrt></mfrac><mo stretchy="false">)</mo><mstyle mathcolor="red"><msubsup><mi>V</mi><mi>h</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msubsup></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} \begin{align*} L(·) = \textcolor{skyblue}{\text{FFN}} (\textcolor{red}{\text{MSA}} (·)) \\ MSA(·) = concat(softmax(\frac{\textcolor{skyblue}{Q_h}\textcolor{red}{K&#x27;_h}^T}{\sqrt{d}})\textcolor{red}{V&#x27;_h}) \end{align*} \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.3901em;vertical-align:-1.9451em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.4451em"><span style="top:-4.4451em"><span class="pstrut" style="height:4.4451em"></span><span class="mord"><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.4451em"><span style="top:-5.2652em"><span class="pstrut" style="height:3.6601em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord text" style="color:skyblue"><span class="mord" style="color:skyblue">FFN</span></span><span class="mopen">(</span><span class="mord text" style="color:red"><span class="mord" style="color:red">MSA</span></span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">))</span></span></span><span style="top:-2.9451em"><span class="pstrut" style="height:3.6601em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">MS</span><span class="mord mathnormal">A</span><span class="mopen">(</span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal">so</span><span class="mord mathnormal" style="margin-right:0.10764em">f</span><span class="mord mathnormal">t</span><span class="mord mathnormal">ma</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6601em"><span style="top:-2.1778em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322em"><span class="svg-align" style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord" style="padding-left:0.833em"><span class="mord mathnormal">d</span></span></span><span style="top:-2.8922em"><span class="pstrut" style="height:3em"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.08em" viewBox="0 0 400000 1080" preserveAspectRatio="xMinYMin slice"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1078em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="color:skyblue"><span class="mord mathnormal" style="color:skyblue">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:skyblue"><span class="mord mathnormal mtight" style="color:skyblue">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord" style="color:red"><span class="mord mathnormal" style="margin-right:0.07153em;color:red">K</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-2.4169em;margin-left:-0.0715em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathnormal mtight" style="color:red">h</span></span></span><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red"><span class="mord mtight" style="color:red">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em"><span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9831em"><span style="top:-3.2048em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">T</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.93em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mord" style="color:red"><span class="mord mathnormal" style="margin-right:0.22222em;color:red">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-2.453em;margin-left:-0.2222em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathnormal mtight" style="color:red">h</span></span></span><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red"><span class="mord mtight" style="color:red">′</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9451em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9451em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.4451em"><span style="top:-4.4451em"><span class="pstrut" style="height:4.4451em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9451em"><span></span></span></span></span></span></span></span></span></div><ul><li>FFN : feed forward network</li><li>MSA : encoder layer 내부의 multi-head attention</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span></span> : <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">h_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> head</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><msup><mi>K</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{K&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord" style="color:red"><span class="mord mathnormal" style="margin-right:0.07153em;color:red">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red"><span class="mord mtight" style="color:red">′</span></span></span></span></span></span></span></span></span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mstyle mathcolor="red"><msup><mi>V</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mstyle></mrow><annotation encoding="application/x-tex">\textcolor{red}{V&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em"></span><span class="mord" style="color:red"><span class="mord mathnormal" style="margin-right:0.22222em;color:red">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mtight" style="color:red"><span class="mord mtight" style="color:red">′</span></span></span></span></span></span></span></span></span></span></span></span></span> : new key 및 value embedding matrices:</li></ul><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msup><mi>K</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mo stretchy="false">(</mo><mstyle mathcolor="skyblue"><mi>K</mi></mstyle><mo separator="true">,</mo><mstyle mathcolor="red"><msub><mi>P</mi><mi>K</mi></msub></mstyle><mo stretchy="false">)</mo><mo separator="true">,</mo><msup><mi>V</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><mi>c</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mo stretchy="false">(</mo><mstyle mathcolor="skyblue"><mi>V</mi></mstyle><mo separator="true">,</mo><mstyle mathcolor="red"><msub><mi>P</mi><mi>V</mi></msub></mstyle><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} K&#x27; = concat(\textcolor{skyblue}{K}, \textcolor{red}{P_K}), V&#x27; = concat(\textcolor{skyblue}{V}, \textcolor{red}{P_V}) \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2em;vertical-align:-0.35em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-3.01em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em">K</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07153em;color:skyblue">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord" style="color:red"><span class="mord mathnormal" style="margin-right:0.13889em;color:red">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathnormal mtight" style="margin-right:0.07153em;color:red">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8019em"><span style="top:-3.113em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord mathnormal">co</span><span class="mord mathnormal">n</span><span class="mord mathnormal">c</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em;color:skyblue">V</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord" style="color:red"><span class="mord mathnormal" style="margin-right:0.13889em;color:red">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight" style="color:red"><span class="mord mathnormal mtight" style="margin-right:0.22222em;color:red">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.85em"><span style="top:-2.85em"><span class="pstrut" style="height:2.84em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35em"><span></span></span></span></span></span></span></span></span></div><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span></span></span></span> : backbone 의 original key 및 value matrices</li><li>이렇게 key-value prompt 가 new data 에 대한 model adapting 을 돕는데 기여할 수 있음</li><li>저자의 구현에서는 separate learnable vectors 를 tuning 하는 대신, 각 Transformer layer 내에서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>K</mi></msub></mrow><annotation encoding="application/x-tex">P_K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 및 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>V</mi></msub></mrow><annotation encoding="application/x-tex">P_V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> prompts 를 parameter sharing 을 가능케 함</li><li>저자의 동기는 두 가지: <ol><li>저자의 실험 결과에 따르면 shared prompt 를 사용하면 fine-tuning 성능이 일관되게 향상</li><li>shared prompt vectors 를 사용하면 learnable transformer part 의 parameter usage 가 절반으로 줄어들어 parameter-effcient 를 높임</li></ol></li></ul><hr><p>self-attention mechanism 에서 query matrix <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span></span> 는 또 다른 중요한 요소.</p><p>하지만 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span></span> 에 대한 additional prompting 은 두 가지 이유로 바람직하지 않음:</p><ol><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span></span> 에 대한 prompt 는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> 의 각 pairs 사이의 attention score 계산과 유사. 따라서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> 모두에 대한 prompt 는 불필요.</li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord mathnormal">Q</span></span></span></span></span> 의 변화는 attention map  의 output 형태에 영향을 미쳐 next layer 에서의 일치하지 않는 차원에 대한 additional linear projection 이 필요. 이는 parameter efficient 측면에서 감당할 수 없음.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="33-efficient-prompting">3.3 Efficient Prompting<a href="#33-efficient-prompting" class="hash-link" aria-label="Direct link to 3.3 Efficient Prompting" title="Direct link to 3.3 Efficient Prompting">​</a></h2><p>저자의 effective prompting 기법은 fine-tuned model 의 성능을 향상시키는 것을 목표로 함.</p><p>자연스럽게 드는 질문은, moidel performance 를 희생하지 않고 tunable prompts 수를 줄일 수 있는가이다.</p><p>lottery ticket hypothesis (LTH) 에 따르면, 주어진 task 에서 unnecessary weights 없이 original over-parameterized network 와 동일한 test performance 를 달성할 수 있는 sub-network 가 존재한다.</p><p>이 가설에 영감을 받아, 저자는 다양한 visual prompt 를 masking 하는 실험을 수행하며, 다양한 prompt 가 model performance 에 미치는 영향이 다르며 일부는 오히려 negative impact 를 미치는 것을 발견.</p><p>이 발견을 바탕으로, 저자는 visual prompt 에 대한 prompt pruning 방법을 제안</p><ul><li>이 방법의 주요 목표는 가장 영향력 있는 prompt 를 유지하면서 redundant 또는 unnecessary 를 제거하는 것.</li><li>less important prompt 를 제거함으로써, 저자는 prompt tuning 의 efficiency 를 크게 향상시키면서 성능을 유지할 수 있음.</li><li>이를 달성하기 위해, 저자는 token-wise pruning 및 segment-wise pruning 이란 두 가지 세분화 수준에서 작동하는 cascade pruning 전략 설계 (Fig. 2(d)).<ul><li>token-wise pruning 은 처음에 가장 중요하지 않은 visual prompt 를 식별하고 제거</li><li>이후, segment-wise pruning 은 남아 있는 각 prompt 를 multiple segments 로 나누고 negative segments 를 filtering</li><li>learnable visual prompts 의 parameter usage 를 공동으로 줄임으로써, 저자의 두 단계 pruning 접근법은 re-training 단계에서, rewinding stage 에서 re-train 될 수 있는 soft filtered prompt 생성</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="token-wise-pruning">Token-wise Pruning.<a href="#token-wise-pruning" class="hash-link" aria-label="Direct link to Token-wise Pruning." title="Direct link to Token-wise Pruning.">​</a></h3><p>저자는 각 Transformer layer 의 input visual prompt 와 연관된 learnable mask variable <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>ρ</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>ρ</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>ρ</mi><mi>M</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">ρ = \{ ρ_1, ρ_2, ... , ρ_M \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal">ρ</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">...</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em">M</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span></span> (<span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">M</span></span></span></span></span> 은 visual prompt length) 를 도입</p><ul><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>k</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">ρ_k \in \{ 0, 1 \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span></span></li><li>0 은 해당 learnable input prompt 가 pruning 되었다는 것을 의미</li><li>이후 masked visual prompt 는 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>P</mi><mi>k</mi></msub><mo stretchy="true">~</mo></mover><mo>=</mo><msub><mi>ρ</mi><mi>k</mi></msub><mo separator="true">⋅</mo><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\widetilde{P_k} = ρ_k · P_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0933em;vertical-align:-0.15em"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9433em"><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span><span class="svg-align" style="top:-3.6833em"><span class="pstrut" style="height:3em"></span><span style="height:0.26em"><svg xmlns="http://www.w3.org/2000/svg" width="100%" height="0.26em" viewBox="0 0 600 260" preserveAspectRatio="none"><path d="M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">⋅</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 가 됨.</li><li>pruning position 결정을 위해, 저자는 각 prompt token 의 importance score 를 계산하고 lowest scores 를 가진 position 을 제거</li><li>importance score 는 mask variables <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">ρ_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 에 대한 model 의 sensitivity 의 기대값으로 정의:</li></ul><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.16em" columnspacing="1em"><mtr><mtd class="mtr-glue"></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>S</mi><msub><mi>P</mi><mi>k</mi></msub></msub><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mi>x</mi><mo>∼</mo><msub><mi mathvariant="script">D</mi><mi>x</mi></msub></mrow></msub><mi mathvariant="normal">∣</mi><mfrac><mrow><mi mathvariant="normal">∂</mi><mi mathvariant="script">L</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>ρ</mi><mi>k</mi></msub></mrow></mfrac><mi mathvariant="normal">∣</mi></mrow></mstyle></mtd><mtd class="mtr-glue"></mtd><mtd class="mml-eqn-num"></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation} S_{P_k} = \mathbb{E}_{x \sim \mathcal{D}_x}|\frac{∂\mathcal{L}(x)}{∂ρ_k}| \end{equation}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.3074em;vertical-align:-0.9037em"></span><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4037em"><span style="top:-3.4037em"><span class="pstrut" style="height:3.427em"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3488em;margin-left:-0.1389em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1512em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2559em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mord"><span class="mord mathbb">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">x</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.02778em">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:-0.0278em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.314em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord"><span class="mord mathnormal">ρ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord" style="margin-right:0.05556em">∂</span><span class="mord mathcal">L</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9037em"><span></span></span></span></span></span></span></span><span class="tag"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4037em"><span style="top:-3.4037em"><span class="pstrut" style="height:3.427em"></span><span class="eqn-num"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9037em"><span></span></span></span></span></span></span></span></span></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="segment-wise-pruning">Segment-wise Pruning.<a href="#segment-wise-pruning" class="hash-link" aria-label="Direct link to Segment-wise Pruning." title="Direct link to Segment-wise Pruning.">​</a></h4><p>저자는 각 prompt 내의 negative prompt segments 를 배제하기 위해 , segment-wise pruning 를 추가로 조사.</p><ul><li>각 prompt token 의 embedding 을 먼저 동일하게 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.00773em">R</span></span></span></span></span> parts 로 나눔</li><li>각 part 는 isolated unit 으로 취급되며 jointly optimizing</li><li>token-wise pruning 과 유사하게, prompt token 내의 각 segment 에 mask 를 할당하고 importance score 가 낮은 segment filtering</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="rewinding">Rewinding.<a href="#rewinding" class="hash-link" aria-label="Direct link to Rewinding." title="Direct link to Rewinding.">​</a></h4><p>two-level cascade pruning 수행 후, weight rewinding stage 는 soft filtered prompt tokens 를 re-training 하는데 중점을 둠</p><ul><li>이 과정은 pruning stage 에서 각 layer 의 importance scores 를 매긴 후, importance score 가 낮은 경우 해당 mask variable 를 0 으로 설정하는 것을 포함</li><li>다음, soft filtered input prompts 는 fine-tuning 중에 original combination (learning rate, weight decay) 를 사용하여 다른 learnable parameters 를 함께 재훈련</li></ul><h1>4. Experiment</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="41-experimental-setup">4.1. Experimental Setup<a href="#41-experimental-setup" class="hash-link" aria-label="Direct link to 4.1. Experimental Setup" title="Direct link to 4.1. Experimental Setup">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="datasets">Datasets.<a href="#datasets" class="hash-link" aria-label="Direct link to Datasets." title="Direct link to Datasets.">​</a></h4><p>저자의 실험은 두 가지 image classification benchmark 수행</p><ul><li><strong>VTAB-1k</strong> : 19 benchmark Visual Task Adaptation 을 수집하여, 세 가지 그룹으로 분류됨:<ol><li><em>Natural</em> : 일반 카메라로 촬영된 자연 이미지를 포함</li><li><em>Specialized</em> : 특수 장비로 촬영된 이미지를 포함</li><li><em>Structured</em> : 기하학적 이해를 요구하는 작업(e.g., counting, distance)을 포함</li></ol><ul><li>VTAB-1k 의 각 task 에는 1000 training examples 포함</li><li>이전 연구를 따라, 저자는 hyper-parameter tuning 을 위해 training set 을 800-200 split</li><li>최종 평가는 full training data 를 사용하여 수행</li></ul></li><li><strong>FGVC</strong> : CUB-200-2011, NABirds, Oxford Flowers, Stanford Dogs 및 Stanford Cars 를 포함한 5 benchmark Fine-grained Visual Classification 포함<ul><li>이전 연구를 따라, training set 은 무작위로 90% train 과 10% val 로 split</li><li>저자는 hyper-parameter tuning 을 위해 val 사용</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="baselines">Baselines.<a href="#baselines" class="hash-link" aria-label="Direct link to Baselines." title="Direct link to Baselines.">​</a></h4><p>공정한 비교를 위해, 이전 연구를 따라 E²VPT 와 널리 사용되는 PEFT 비교</p><p>image classification 에 대한 두 가지 vision transformer architecture: Vision Transformer (ViT) 와 Swin Transformer (Swin) 의 결과 논의.</p><p>또한 E²VPT 를 두 가지 self-supervision objective, MAE 및 MoCo v3 에 적용</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="training">Training.<a href="#training" class="hash-link" aria-label="Direct link to Training." title="Direct link to Training.">​</a></h4><p>저자는 각 task 에 대해 best tuning hyperparameter, learning rate (e.g., <!-- -->[50, 25, 10, 5, 2.5, 1, 0.5, 0.25, 0.1, 0.05]<!-- -->) 및 weight decay (e.g., <!-- -->[0.01, 0.001, 0.0001, 0.0]<!-- -->)를 맞추기 위해 grid search</p><ul><li>주목할 점은, E²VPT 는 이전 연구에서 특별히 설계된 large learning rate 를 필요로 하지 않음.</li><li>모든 모델의 learning rate 는 cosine decay 를 따라 일정하며, 100 epochs (10 warm-up epochs) 동안 훈련</li><li>저자는 이전 연구에서와 같은 batch size 설정을 따름: 각각 ViT-Base/16에 대해 64/128, Swin-Base 에 대해 80. 각 token 의 segment 수 는 8 로 설정</li><li>prunikng stage 의 백분율은 10% 에서 90% 사이에서 10% 간격으로 linear search</li><li>rewinding stage 는 한번만 재훈련</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="reproducibility">Reproducibility<a href="#reproducibility" class="hash-link" aria-label="Direct link to Reproducibility" title="Direct link to Reproducibility">​</a></h4><p>E²VPT 는 Pytorch 로 구현.</p><p>실험은 NVIDIA A100-40GB GPU 에서 수행.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="42-comparison-with-state-of-the-arts">4.2. Comparison with State-of-the-Arts<a href="#42-comparison-with-state-of-the-arts" class="hash-link" aria-label="Direct link to 4.2. Comparison with State-of-the-Arts" title="Direct link to 4.2. Comparison with State-of-the-Arts">​</a></h2><p>각각 ViT, Swin 및 두 가지 self-supervised objectives - MAE 및 MoCo v3 에 대한 E²VPT 의 성능과 견고성을 검사</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="evpt-on-vit">E²VPT on ViT<a href="#evpt-on-vit" class="hash-link" aria-label="Direct link to E²VPT on ViT" title="Direct link to E²VPT on ViT">​</a></h4><p>저자는 3 runs 를 4 task groups 에 대한 VTAB-1k 및 FGVC benchmark 의 평균 정확도 점수를 Tab. 1 에 보고하며 E²VPT 를 다른 8 tuning protocols 와 비교</p><p><img loading="lazy" alt="Table 1" src="/assets/images/image-41-b9baddfcf665e7fb1ec9341429eb6960.png" width="1273" height="521" class="img_ev3q"></p><ul><li>구체적으로, Full 은 backbone 및 classification head 모두 업데이트;</li><li>Linear, Parital-1 (top layer) 및 MLP-3 (3 MLP layers) 는 partial tuning</li><li>Sidetune, Bias 및 Adapter 는 backbone 에 new trainable parameters 를 추가하는 extra module</li><li>VPT 는 가장 최근의 visual prompt tuning</li></ul><p>이 결과로부터 몇 가지 주요 관찰이 있음.</p><ul><li>E²VPT 는 대부분의 경우에서 full fine-tuning 을 능가할 수 있으며, 24 task 중 12 에서 그럼.<ul><li>예로, 저자의 모델은 FGVC 에서 0.68%, VTAB-1k Structured 에서 9.75% 의 개선을 달성</li><li>이 관찰은 large-scale vision model adaptation 의 신속성을 위한 저자의 접근법의 효과 보여줌.</li><li>반면, 저자의 모델은 backbone 에서 0.39% 의 parameter 만 training 하므로, full fine-tuning 보다 훨씬 parameter-efficient</li></ul></li><li>prompt tuning 기반 접근법이 일반적으로 partial fine-tuning (Partial-1) 및 extra module (Adapter) 과 같은 PEFT 를 능가하는 것을 보는 것은 놀라운 일이 아님.<ul><li>이는 large-scale vision model 에 대한 prompt tuning 의 뛰어난 adapting 을 나타냄.</li><li>prompt tuning 의 learnable parameter 수 또한 다른 방법보다 작음.</li></ul></li><li>저자의 접근법은 항상 강력한 VPT 모델을 능가하며, learnable prompt 수가 더 적음.<ul><li>이는 key-value prompt 의 효과적인 설계와 효율적인 prompt pruning 의 효과를 보여줌</li><li>VPT 는 input visual prompt 의 설계에만 집중하기 때문에, new data 에서 image patch 간의 정확한 상호작용을 capture 하는데 실패함.</li><li>반면, E²VPT 의 key-value prompt 는 이 격차를 효과적으로 메움.</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="evpt-on-hierarchical-transformer">E²VPT on Hierarchical Transformer<a href="#evpt-on-hierarchical-transformer" class="hash-link" aria-label="Direct link to E²VPT on Hierarchical Transformer" title="Direct link to E²VPT on Hierarchical Transformer">​</a></h4><p>저자의 아키텍처 디자인의 효과와 일반화를 증명하기 위해, 저자는 E²VPT 를 hierarchical transformers - Swin 으로 확장하며, 이 모델은 MSA layer 는 local shifted windows 에서 사용되고, patch embedding 은 deeper layers 에서 병합됨</p><p><img loading="lazy" alt="Table 2" src="/assets/images/image-42-b7bc8c8cec4e255cfc845f8e44fdf80e.png" width="782" height="361" class="img_ev3q"></p><ul><li>일반성을 위해, 저자는 ViT architecture 의 동일한 설정을 따라 K-V learnable paris 를 prepend 하고 이전 연구를 따라 input vectors 를 변경 (i.e., 이러한 learnable vectors 는 local windows 내에서 attend 되며 patch merging 시 무시됨).</li><li>pruning 의 경우, deeper local window 내에서 통합할 때 성능이 떨어지는 것을 발견<ul><li>따라서 저자는 pruning stage 는 first stage 만 할당</li></ul></li><li>Swin 은 <!-- -->[CLS]<!-- --> 를 사용하지 않으며, classification head 의 input 으로 global pooling 적용<ul><li>저자의 방법을 적응할 때 이 설계를 따름.</li></ul></li><li>광범위한 실험은 ImageNet-21k supervised pre-trained Swin-Base 에서 배포.</li><li>E²VPT 는 VTAB-1k 의 세 가지 problem classes 에서 all other PEFT 를 지속적으로 능가하며, full fine-tuning 을 처음으로 VTAB-1k <em>Specialized</em> 및 <em>Structured</em> 에서 능가 (i.e., 0.21%)</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="different-pretraining-methods">Different Pretraining Methods<a href="#different-pretraining-methods" class="hash-link" aria-label="Direct link to Different Pretraining Methods" title="Direct link to Different Pretraining Methods">​</a></h4><p>저자는 VPT 의 접근법을 따라, pretrained backbone with unlabeled data 에서 두 가지 self-supervised objectives, MAE 및 MoCo v3 으로 실험을 수행.</p><p><img loading="lazy" alt="Table 3" src="/assets/images/image-43-1092d0a7f43cd03e36469b492963ad40.png" width="1571" height="416" class="img_ev3q"></p><ul><li>VPT 는 이러한 objective 에서 결론을 내리지 못했지만, 저자의 제안된 방법인 E²VPT 는 다른 방법을 능가하고 full fine-tuning 과 competitive performance 달성 (MAE 에선 19 instance 중 8, MoCo v3 에선 19 instance 중 12).</li><li>저자는 VPT 에서 논의된 격차를 활용했으며, 이는 self-supervised ViT 가 supervising 된 것과 근본적으로 다르다는 것을 나타내며, 저자의 방법의 일반성을 두 가지 pre-training objective 에 대해 입증</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="43-diagnostic-experiments">4.3. Diagnostic Experiments<a href="#43-diagnostic-experiments" class="hash-link" aria-label="Direct link to 4.3. Diagnostic Experiments" title="Direct link to 4.3. Diagnostic Experiments">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="impact-of-different-components">Impact of Different Components.<a href="#impact-of-different-components" class="hash-link" aria-label="Direct link to Impact of Different Components." title="Direct link to Impact of Different Components.">​</a></h4><p>E²VPT 의 다양한 구성 요소(visual prompt, key-value prompt, pruning 및 rewinding) 가 미치는 영향을 조사하기 위해 2 task 에서 실험 수행.</p><p><img loading="lazy" alt="Table 4" src="/assets/images/image-44-52a50e5cd018fa9a68f4a3de4a342ee9.png" width="1531" height="253" class="img_ev3q"></p><ul><li>SVHN 에 대해, visual prompt 만 사용한 모델이 78.1% 의 정확도를 달성</li><li>key-value prompt 를 각각 pruning 과 rewinding 기법을 적용한 결과, 각각 5.7% 및 0.9% 의 추가 향상이 나타났으며, 이는 self-attention module 에서 key-value prompt tuning 기술과 pruning 메커니즘의 효과를 입증</li><li>마지막으로, 모든 구성 요소를 결합한 결과, 85.3% 의 최고의 성능을 달성.</li><li>FGVC NABirds 에서도 유사한 경향이 관찰.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="prompt-location">Prompt Location.<a href="#prompt-location" class="hash-link" aria-label="Direct link to Prompt Location." title="Direct link to Prompt Location.">​</a></h4><p>E²VPT 와 다른 방법들 간의 근본적인 차이점은 self-attention 에 도입된 learnable key-value prompt 이다.</p><ul><li>구현에서 저자는 key-value prompt 를 key 와 value matrices sequence 앞에 추가함.</li><li>learnable prompt 의 적절한 배치를 결정하기 위해 추가 조사 필요</li><li>VTAB-1k 에 대한 ablation 결과를 Tab. 5(a) 에 포괄적으로 제공</li></ul><p><img loading="lazy" alt="Table 5" src="/assets/images/image-45-20f6710274a4ad7662c25e605c75b5dd.png" width="772" height="303" class="img_ev3q"></p><ul><li>learnable prompt 를 key 와 value matrices 앞 또는 뒤에 추가하는 두 가지 경우 모두 competitive 결과를 보여줌</li><li>이는 prompt location 에 대한 robustness 입증</li><li>평균적으로 약간 더 나은 결과를 보여주는 &quot;Before&quot; 를 모든 실험에서 기본 방법으로 선택 (e.g., 73.94% vs 73.91%).</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="initialization">Initialization.<a href="#initialization" class="hash-link" aria-label="Direct link to Initialization." title="Direct link to Initialization.">​</a></h4><p>Tab. 5(b) 는 VTAB-1k benchmark 에 대한 두 가지 널리 사용되는 initialization 방법 (<em>truncated normal</em> 및 <em>He initialization</em>) 에 대한 성능을 보고.</p><ul><li>결과는 He initialization 이 일반적으로 더 안정적이고 바람직한 성능을 제공함을 보여줌.</li><li>그러나 일부 특정 과제에서는(e.g., VTAB-1k Specialized Diabetic Retinopathy Detection 에서 정확도가 1.1% 더 높음) truncated normal 이 약간 더 나은 결과를 보여줌.</li><li>결론적으로, E²VPT 는 다양한 초기화 방법에 대해 robust 하며 full fine-tuning 과 일관된 성능을 달성할 수 있음</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="prompt-length">Prompt Length<a href="#prompt-length" class="hash-link" aria-label="Direct link to Prompt Length" title="Direct link to Prompt Length">​</a></h4><p>prompt length 는 E²VPT 에서 조정해야 하는 유일한 hyper-parameter.</p><p>모델 성능에 미치는 다양한 prompt length 의 영향을 분석하기 위해, VTAB-1k Natural SVHN 에서 visual prompt 와 key-value prompt length 에 대한 종합적인 연구를 수행</p><ul><li>visual prompt length 는 일반적으로 <!-- -->[5, 10, 20, 30, 50]<!-- --> 으로 제한되며, key-value prompt length 는 대부분의 dataset 에서 표준 구성인 <!-- -->[1, 5, 10, 50]<!-- --> 으로 제한.</li><li>다양한 prompt length combination 에 대한 모델 성능 결과는 Fig. 4 에 보고</li></ul><p><img loading="lazy" alt="Figure 4" src="/assets/images/image-47-69ddfefbe421e1076a854b7d078a793a.png" width="772" height="617" class="img_ev3q"></p><ul><li>50 visual prompt 를 사용할 때, 상대적으로 shorter key-value prompt 가 성능에 눈에 띄게 도움이 된다는 것을 알 수 있음 (e.g., key-value prompt 를 도입하지 않은 경우 78.1% 에서 key-value prompt 하나를 도입한 경우 84.7%).</li><li>key-value prompt length 를 더 늘리면 성능이 약간 향상 (e.g., 5 key-value prompt 사용한 경우 85.3%).</li><li>또한, 많은 수의 key-value prompt 를 성능이 떨어진다는 것을 알 수 있음 (e.g., 20 key-value prompt 사용한 경우 80.2%).</li><li>다른 visual prompt length 에서도 유사한 패턴이 관찰</li><li>self-attention layer 에서도 heavy parameter engineering 이 original attention map 을 왜곡하여 adapting 에 해를 끼칠 수 있다고 주장</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="44--visualization">4.4  Visualization<a href="#44--visualization" class="hash-link" aria-label="Direct link to 4.4  Visualization" title="Direct link to 4.4  Visualization">​</a></h2><p>이전 연구를 따라, FGVC 의 3 tasks (CUB-200-2011, Oxford Flowers, Stanford Dogs) 에 대해 VPT 와 저자의 model training set 에서의 hyperbolic visualizations 결과를 보여줌.</p><ul><li>구체적으로, hyperbolic space 는 constant negative curvature 를 가진 Riemannian manifold</li><li>hyperbolic space 의 여러 isometric models 가 있지만, 이전 연구을 따라 Poincare ball model 을 사용</li><li>저자는 &quot;hyperboloid&quot; distance metric 을 사용하여 UMAP 을 사용해 dimension 을 2D 로 축소</li><li>ViT-Base 는 두 가지 pre-training 방식 (즉, tuned model on VPT 및 저자의 rewinded model)으로 encoder 역할을 함</li><li>model 을 fine-tuning 동안 고정하고 output embedding 을 hyperbolic space 로 mapping</li><li>Adam optimizer 와 learning rate <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>5</mn></mrow></msup></mrow><annotation encoding="application/x-tex">3×10^{−5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8141em"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em"><span style="top:-3.063em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">5</span></span></span></span></span></span></span></span></span></span></span></span></span> 를 모든 setting 에 적용</li><li>weight decay 는 0.01 이고 batch size 는 900</li><li>모든 모델은 공정한 비교를 위해 50 steps 동안 학습되며, gradient clip 은 norm 3</li></ul><p><img loading="lazy" alt="Figure 3" src="/assets/images/image-46-a126c6a3dea4a3debbaa450953594cb6.png" width="1558" height="387" class="img_ev3q"></p><p>Fig. 3 은 learned embeddings 이 Poincare disk 에 어떻게 배열되는지 보여줌.</p><ul><li>E²VPT 에선 sample 들이 label 에 따라 clustering 되고 각 cluster 가 disk 의 경계에 더 가까워져 encoder 가 class 를 잘 구분하는 것을 나타냄</li><li>반면, VPT 에선 일부 sample 들이 중심으로 이동하고 혼합되는 것을 관찰</li><li>project 과정에서 혼란이 있을 수 있음을 시사</li><li>이러한 시각화 결과는 new tasks 에서 input image 로부터  separatable embeddings 을 생성하는 데 있어 제안된 E²VPT 의 효과를 추가 검증</li></ul><h1>5. Conclusion</h1><p>현재의 대부분의 <em>pretrain-then-tinetune</em> 패러다임은 parameter usage 를 줄이려 하지만 transformer-based architecture 의 내부 설계를 간과하고 있음. 이 관점에서 저자는 adapting 중 transformer architecture modeling 을 위한 novel parameter efficient visual prompt tuning 인 E²VPT 를 제시</p><p>이 접근법은 여러 가지 장점을 가지고 있음: </p><ol><li>self-attention 메커니즘을 고려하여 현재의 parameter-efficient fine-tuning 보다 우수한 성능 발휘</li><li>input visual prompt 에서 parameter usage 사용을 줄이기 위해, pruning 및 rewinding 단계를 적용</li><li>이러한 체계적인 장점은 effectiveness 및 efficiency 알고리즘이 가능하게 함.</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/e-2-vpt">E2VPT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/prompt">Prompt</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/peft">PEFT</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/visual-prompt">Visual Prompt</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/pruning">Pruning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/lottery-ticket-hypothesis">Lottery Ticket Hypothesis</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/2023-07-E2VPT.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/CVP"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Convolutional Visual Prompt for Robust Visual Perception</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Paper/Vision-Language/PEFT/Prompting/Visual-Token/SA2VP"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SA^2VPT: Spatially Aligned-and-Adapted Visual Prompt</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#21-vision-transformers" class="table-of-contents__link toc-highlight">2.1. Vision Transformers</a></li><li><a href="#22-parameter-efficient-fine-tuning" class="table-of-contents__link toc-highlight">2.2. Parameter-efficient Fine-tuning</a></li><li><a href="#31-problem-definition" class="table-of-contents__link toc-highlight">3.1 Problem Definition</a></li><li><a href="#32-effective-prompting" class="table-of-contents__link toc-highlight">3.2 Effective Prompting</a></li><li><a href="#33-efficient-prompting" class="table-of-contents__link toc-highlight">3.3 Efficient Prompting</a><ul><li><a href="#token-wise-pruning" class="table-of-contents__link toc-highlight">Token-wise Pruning.</a></li></ul></li><li><a href="#41-experimental-setup" class="table-of-contents__link toc-highlight">4.1. Experimental Setup</a></li><li><a href="#42-comparison-with-state-of-the-arts" class="table-of-contents__link toc-highlight">4.2. Comparison with State-of-the-Arts</a></li><li><a href="#43-diagnostic-experiments" class="table-of-contents__link toc-highlight">4.3. Diagnostic Experiments</a></li><li><a href="#44--visualization" class="table-of-contents__link toc-highlight">4.4  Visualization</a></li></ul></div></div></div><div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Won-Yong Jo, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.947e1592.js"></script>
<script src="/assets/js/main.d6888401.js"></script>
</body>
</html>