<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Paper/Vision-Language/VQA-IC/Few-shot/2022-03-TAP">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">CLIP Models are Few-shot Learners: Empirical Studies on VQA and Visual Entailment | WYJLab</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://wyjo0626.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://wyjo0626.github.io/docs/Paper/Vision-Language/VQA-IC/Few-shot/TAP"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CLIP Models are Few-shot Learners: Empirical Studies on VQA and Visual Entailment | WYJLab"><meta data-rh="true" name="description" content="이미지 및 논문 출처 :"><meta data-rh="true" property="og:description" content="이미지 및 논문 출처 :"><link data-rh="true" rel="icon" href="/img/WYJLab.ico"><link data-rh="true" rel="canonical" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/VQA-IC/Few-shot/TAP"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/VQA-IC/Few-shot/TAP" hreflang="en"><link data-rh="true" rel="alternate" href="https://wyjo0626.github.io/docs/Paper/Vision-Language/VQA-IC/Few-shot/TAP" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="WYJLab RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="WYJLab Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9ed678b7.css">
<link rel="preload" href="/assets/js/runtime~main.24800c52.js" as="script">
<link rel="preload" href="/assets/js/main.4c1744f1.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/WYJLab.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/WYJLab.svg" alt="WYJLab Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">WYJLab</b></a><a class="navbar__item navbar__link" href="/publications">Publications</a><a class="navbar__item navbar__link" href="/projects">Projects</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Tutorial Intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---basics">Tutorial - Basics</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Basics&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorial---extras">Tutorial - Extras</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorial - Extras&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Paper</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Computer Vision/Adversarial Attack/AR">Computer Vision</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Machine Learning/Regularization/Dropout/Dropout">Machine Learning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Multi-Modal/PEFT/Composition/Moka">Multi-Modal</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/NLP/Analysis/Contextualized Representation">NLP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Survey/Prompting">Survey</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">Vision-Language</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/CLIP/Few-shot/Composition/CLIP-LoRA">CLIP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/Paper/Vision-Language/Foundation/Contrastive Learning/ALIGN">Foundation</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/VQA Few-shot">VQA-IC</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/VQA Few-shot">Few-shot</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/VQA Few-shot">Multimodal Few-Shot Learning with Frozen Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/PICa">An Empirical Study of GPT-3 for Few-Shot Knowledge-Based VQA</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/xGQA">xGQA: Cross-Lingual Visual Question Answering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/FEWVLM">A Good Prompt Is Worth Millions of Parameters: Low-resource Prompt-based Learning for Vision-Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/TAP">CLIP Models are Few-shot Learners: Empirical Studies on VQA and Visual Entailment</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/MGMA">Linearly Mapping from Image to Text Space</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/Img2LLM">From Images to Textual Prompts: Zero-shot Visual Question Answering with Frozen Large Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/Meta-Mapper">Meta Learning to Bridge Vision and Language Models for MultiModal Few-shot Learning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/LLMVQA">Few-Shot VQA with Frozen LLMs: A Tale of Two Approaches</a></li></ul></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Programming/Algorithm/">Programming</a></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Paper</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Vision-Language</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">VQA-IC</span><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Few-shot</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">CLIP Models are Few-shot Learners: Empirical Studies on VQA and Visual Entailment</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CLIP Models are Few-shot Learners: Empirical Studies on VQA and Visual Entailment</h1></header><p>이미지 및 논문 출처 : <a href="https://arxiv.org/pdf/2203.07190" target="_blank" rel="noopener noreferrer">https://arxiv.org/pdf/2203.07190</a></p><h1>Abstract</h1><p>CLIP 은 다양한 vision task 에서 뛰어난 zero-shot 성능을 보여왔다. 기존에는 CLIP 이 powerful visual encoder 로만 간주되었다. 그러나 대량의 image-caption pair 로부터 language supervision 을 받아 pretraining 된 이후, CLIP 자체도 vision-language task 에 대해 일부 few-shot 능력을 획득했을 가능성이 있다. </p><p>본 연구에서는 CLIP 이 language 의 힘을 활용하여 strong vision-language few-shot learner 가 될 수 있음을 실증적으로 보인다. </p><ul><li>먼저, 대표적인 visual question answering task 에서 CLIP 의 zero-shot 성능을 평가하고, visual entailment task 에서 CLIP 의 zero-shot cross-modality transfer 능력을 입증한다. </li><li>이후, vqa task 의 few-shot 성능을 향상시키기 위한 parameter-efficient fine-tuning 전략을 제안한다. </li><li>추가적인 pre-training 절차를 도입하지 않고도 visual question answering 과 visual entailment task 에서 경쟁력 있는 zero/few-shot 결과를 달성한다.</li></ul><h1>1 Introduction</h1><p>Visual question answering 과 visual entailment 과 같은 vision-language understanding (VLU) task 는 시스템이 시각적 세계와 자연어의 의미를 종합적으로 이해하는 능력을 평가한다. Vision 과 language 간의 alignment 를 포착하기 위해, vision-language pre-trained model 을 구축하려는 다양한 시도가 이루어졌다. 이러한 방법들은 우수한 성능에도 불구하고 object detection dataset 이나 image-text pair 와 같이 비용이 많이 들거나 expert knowledge 가 필요한 human-annotated training data 를 광범위하게 사용해 왔다. 이러한 dataset 수집은 데이터 수집과 human annotation 에 많은 작업량이 필요하며, 규모가 수천만 개 수준에 그쳐 NLP pretraining 을 위한 Internet text corpus 에 비해 훨씬 작다.</p><p>최근 CLIP 은 Internet 에서 수집한 400M image-text pair 를 활용하여 natural language supervision 으로 visual concept 를 학습하도록 제안되었다. CLIP 은 visual encoder 와 text encoder 로 구성되며, contrastive loss 를 통해 image 와 text 를 alignment 하면서 visual representation 을 학습한다. 이를 통해 CLIP 은 ImageNet 과 같은 vision benchmark 에서 strong zero-shot 성능을 달성한다. 또한 기존 연구에서는 CLIP 이 강력한 visual encoder 로서 downstream vision-language task 에 이점을 줄 수 있음을 보였다. 그러나 CLIP 과 기존 visual encoder 간에는 두 가지 중요한 차이가 있다.</p><ol><li>훨씬 크지만 noisy 한 web data 로 학습되었다.</li><li>Vision 과 language 간의 상호작용이 얕다.</li></ol><p>첫 번째 특징은 CLIP 의 generalization 능력을 보장하며, 두 번째 특징은 modality 간 alignment 능력을 부여한다. 그렇다면 CLIP 의 strong zero-shot 능력을 vision-language understanding task 로 전이할 수 있을까?</p><p>이 질문에 답하기 위해, 본 연구에서는 CLIP 의 zero-shot 능력을 VLU task 로 전이하는 방법을 실증적으로 연구하고, 나아가 CLIP 을 few-shot learner 로 전환하는 방법을 탐구한다. 이를 위해 두 가지 VLU task 에 대해 실험을 수행하였다.</p><ol><li><strong>Visual question answering (VQA)</strong> — 모델이 이미지와 자연어 질문의 세부 사항을 바탕으로 답변을 생성해야 한다.</li><li><strong>Visual entailment</strong> — 모델이 이미지와 자연어 문장 간의 entailment 관계를 판별해야 한다.</li></ol><p>Zero-shot VQA 에서 성공적인 성능 전이를 위해 핵심은 CLIP 의 pretraining task 와 QA task 형태 간의 차이를 줄이는 것이다. 이를 위해 NLP 의 few-shot learning 의 최근 발전에서 영감을 받아, 질문을 문장으로 변환해 masked template 을 생성하는 자동 변환 단계와, generative pre-trained T5 model 을 사용한 span-infilling 을 통해 candidate answers 를 생성하는 <strong>two-step prompt generation strategy</strong> 를 제안한다.</p><p>Zero-shot cross-modality transfer 능력은 visual entailment task 를 통해 탐구한다. 구체적으로, 학습 시 이미지 대신 해당 caption 을 사용하고 작은 classification layer 만 업데이트한다. inference 시에는 기존과 같이 image-text pair 를 사용한다. 이를 통해 CLIP model 에서 language 와 vision representation 이 얼마나 잘 aligned 되어 있는지를 조사한다.</p><p>또한 zero-shot transfer 방법을 기반으로 CLIP 의 VQA 성능을 향상시키기 위해 few-shot learning 을 적용한다. 실험 결과 bias 와 normalization (BiNor) parameter 만 최적화하는 것이 제한된 예시를 더 잘 활용하며 최신 few-shot model 인 <em>Frozen</em> 보다 더 나은 성능을 낸다는 것을 확인했다. 이는 CLIP model 이 우수한 vision-language few-shot learner 가 될 수 있음을 입증한다.</p><p>저자의 기여 사항은 다음과 같다.</p><ul><li>CLIP 의 zero-shot 능력을 VLU task 로 전이하는 방법을 연구하고, CLIP model 이 우수한 few-shot learner 가 될 수 있음을 확인한 최초의 연구이다.</li><li>CLIP 의 zero-shot cross-modality transfer 능력을 입증했다.</li><li>CLIP 의 few-shot VQA 성능을 향상시키기 위한 parameter-efficient fine-tuning 전략인 BiNor 를 제안했다.</li></ul><p><img loading="lazy" alt="Figure 1" src="/assets/images/image-11-ddaa4757996cc8871026acd6099118b1.png" width="2219" height="2149" class="img_ev3q"></p><h1>2 Preliminaries</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="21-clip">2.1 CLIP<a href="#21-clip" class="hash-link" aria-label="Direct link to 2.1 CLIP" title="Direct link to 2.1 CLIP">​</a></h2><p><img loading="lazy" alt="Figure 2" src="/assets/images/image-12-711586479a048fd1b806f80c0f797e1d.png" width="2219" height="1825" class="img_ev3q"></p><p>CLIP 은 Contrastive Language-Image Pretraining 의 약자로, natural language supervision 을 통해 visual representation 을 학습한다. Fig. 2 는 CLIP 의 핵심 구성 요소와 동작 방식을 보여준다. CLIP 은 visual encoder <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span></span></span></span> (e.g., ResNet, ViT) 와 text encoder <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> (e.g., transformer) 로 구성되며, 두 encoder 는 image 와 text 를 독립적으로 인코딩한다. 이후 두 encoder 의 출력에 대해 dot-product 연산, 즉 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mtext>text</mtext><mo stretchy="false">)</mo><mo>⋅</mo><mi>V</mi><mo stretchy="false">(</mo><mtext>image</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(\text{text}) \cdot V(\text{image})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mopen">(</span><span class="mord text"><span class="mord">text</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mopen">(</span><span class="mord text"><span class="mord">image</span></span><span class="mclose">)</span></span></span></span></span> 를 수행하여 input image 와 text 간의 alignment score 를 계산한다. CLIP 은 contrastive loss 를 통해, 올바르게 매칭된 image-text pair 와 무작위로 결합된 pair 를 구분하도록 pretraining 된다.</p><p>기존의 vision benchmark 에서 직접 학습하는 대신, CLIP 은 400M web-crawled image-text pair 로부터 abundant language supervision 을 활용하여, specific task-optimized training 없이도 다양한 image classification task 를 수행할 수 있다. 그러나 CLIP 을 직접 vision-language understanding model 로 적용하는 것은 여전히 어려운 문제이다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="22-vision-language-understanding-tasks">2.2 Vision-Language Understanding Tasks<a href="#22-vision-language-understanding-tasks" class="hash-link" aria-label="Direct link to 2.2 Vision-Language Understanding Tasks" title="Direct link to 2.2 Vision-Language Understanding Tasks">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="visual-question-answering-vqa">Visual question answering (VQA).<a href="#visual-question-answering-vqa" class="hash-link" aria-label="Direct link to Visual question answering (VQA)." title="Direct link to Visual question answering (VQA).">​</a></h4><p>VQA task 는 주어진 image 의 세부 사항에 대한 질문에 답변하는 것을 요구한다. 기존 연구를 따라, VQAv2 dataset 에서 실험을 수행하며, 이를 3,129 개의 사전에 정의된 가장 빈도가 높은 답변들에 대한 classification 문제로 정의한다. VQAv2 의 image 는 Microsoft COCO dataset 에서 가져왔으며, dataset 에는 <em>how many</em>, <em>what color is</em> 와 같은 총 65 종류의 질문 유형이 포함된다. 답변 유형은 <strong>yes/no</strong>, <strong>number</strong>, <strong>other</strong> 의 세 가지로 구성된다.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="visual-entailment">Visual entailment.<a href="#visual-entailment" class="hash-link" aria-label="Direct link to Visual entailment." title="Direct link to Visual entailment.">​</a></h4><p>Natural language inference (NLI) 와 유사하게, visual entailment task 는 premise 와 hypothesis 간의 관계를 entailment, neutral, contradiction 중 하나로 예측한다. VL 환경에서는 premise 가 NLI 의 text description 이 아니라 image 의 세부 사항에 기반한다. SNLI-VE dataset 은 SNLI dataset 에서 premise 를 Flickr30k dataset 의 image 로 대체하여 구성된다. 이러한 특성을 고려하여, 본 연구에서는 SNLI-VE dataset 을 사용해 CLIP model 의 zero-shot cross-modality (language 와 vision) transfer 능력을 검증한다. 이 zero-shot 설정은 CLIP model 에서 vision representation 과 language representation 이 얼마나 잘 aligned 되어 있는지를 조사한다.</p><h1>3 Zero-shot VQA</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-a-two-step-prompt-generation-method">3.1 A Two-Step Prompt Generation Method<a href="#31-a-two-step-prompt-generation-method" class="hash-link" aria-label="Direct link to 3.1 A Two-Step Prompt Generation Method" title="Direct link to 3.1 A Two-Step Prompt Generation Method">​</a></h2><p>기존 연구에서는 CLIP model 을 zero-shot VL task 에 직접 적용하는 것이 불가능하다는 것을 발견했다. 예를 들어, “question: <!-- -->[question text]<!-- --> answer: <!-- -->[answer text]<!-- -->” 와 같은 prompt template 을 직접 사용했을 때 VQAv2 dataset 에서 거의 랜덤 수준의 zero-shot 성능이 관찰되었다. Prompt engineering 의 본질을 재검토하면, VQA task 의 zero-shot 성능 전이에서 핵심은 자연어 설명과 question answering 형태 간의 간극을 줄이는 것임을 알 수 있다.</p><p>이러한 관찰에 기반하여, 저자는 pre-trained generative T5 model 의 도움을 받아 CLIP model 에 zero-shot VQA 능력을 부여하기 위한 <strong>two-step automatic prompt generation method</strong> 를 제안한다. Fig. 3 에 제시된 바와 같이, 이 방법의 핵심 아이디어는 다음과 같다.</p><p><img loading="lazy" alt="Figure 3" src="/assets/images/image-13-c1d252dee8a8ef0ed936a25dd0c83171.png" width="3389" height="1746" class="img_ev3q"></p><ol><li>질문을 masked template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> 로 변환한다.</li><li>Language model 을 사용하여 불가능한 답변을 필터링하고 후보 답변 집합 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">V</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{V}_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 얻는다.</li></ol><p>이렇게 생성된 infilled template 은 질문과 답변을 자연스러운 설명 형태로 연결하므로, VQA task 를 위한 ideal prompt 형태가 될 수 있다.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-i-automatic-template-generation">Step I: Automatic Template Generation<a href="#step-i-automatic-template-generation" class="hash-link" aria-label="Direct link to Step I: Automatic Template Generation" title="Direct link to Step I: Automatic Template Generation">​</a></h4><p>이 단계에서는 질문을 mask token 을 포함한 문장 형태의 template 으로 변환한다. 변환을 위해 두 가지 접근법을 사용한다.</p><ul><li><p><strong>Demonstration to T5</strong>
질문을 <!-- -->[mask]<!-- --> token 이 포함된 template 으로 변환하는 예시를 language model 에 제공하여 변환 패턴을 학습시키는 방식이다. 질문 유형별로 몇 개의 예시를 정의하고, 이에 따라 질문을 변환한다. T5 는 large pre-trained text-to-text Transformer 로, 문장에서 특정 span (e.g., <code>&lt;extra_id_0&gt;</code>) 을 채우도록 pretraining 되어 있다. 예시, 질문, <code>&lt;extra_id_0&gt;</code> token 을 연결하여 T5 에 입력하고, 생성된 span 을 masked template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mtext>demo</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_{\text{demo}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">demo</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 로 사용한다.</p></li><li><p><strong>Dependency parsing</strong>
T5 변환 방식이 잘 동작하더라도 일부 coverage 문제를 해결하기 위해 dependency parsing 기반 방식을 보완적으로 사용한다. 이 방식은 질문을 POS tagging 과 parsing 결과를 기반으로 statement 로 변환하며, wh-word, root word, auxiliary, copula, 그리고 wh-word 또는 root 의 dependent 인 전치사나 particle 을 식별하여 grammar rule 에 따라 변환한다. Stanza 를 사용해 POS tagging 과 parsing 을 수행하고, 답변 부분은 mask token 으로 남긴다. 변환 규칙은 Demszky et al. 의 규칙을 따른다. 이렇게 얻은 template 을 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mtext>parsing</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_{\text{parsing}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">parsing</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 이라 한다.</p></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="step-ii-answer-filtering">Step II: Answer Filtering<a href="#step-ii-answer-filtering" class="hash-link" aria-label="Direct link to Step II: Answer Filtering" title="Direct link to Step II: Answer Filtering">​</a></h4><p>예를 들어 “the specie of a flower” 가 vase 가 될 수 없다는 것은 상식이다. Pre-trained language model 은 이러한 개념을 이미 학습했으므로, 가능성이 낮은 답변을 필터링하면 최종 QA 성능에 긍정적인 영향을 준다.</p><p>주어진 masked template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.25417em">T</span></span></span></span></span>, language model <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">L</mi></mrow><annotation encoding="application/x-tex">\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal">L</span></span></span></span></span>, answer vocabulary <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">V</mi></mrow><annotation encoding="application/x-tex">\mathcal{V}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.08222em">V</span></span></span></span></span> 에 대해, filtered answers <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">V</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{V}_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 는 다음과 같이 얻는다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi mathvariant="script">V</mi><mi>F</mi></msub><mo>=</mo><mtext>Top-</mtext><msub><mi>k</mi><mrow><mi>v</mi><mo>∈</mo><mi>V</mi></mrow></msub><mo stretchy="false">{</mo><mi>log</mi><mo>⁡</mo><msub><mi>P</mi><mi mathvariant="script">L</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mtext>mask</mtext><mo stretchy="false">]</mo><mo>=</mo><mi>v</mi><mo>∣</mo><mi mathvariant="script">T</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(1)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\mathcal{V}_F = \text{Top-}k_{v \in V} \{ \log P_\mathcal{L}([\text{mask}] = v \mid \mathcal{T}) \} \tag{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Top-</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.22222em">V</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em"><span></span></span></span></span></span></span><span class="mopen">{</span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathcal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord text"><span class="mord">mask</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="mclose">)}</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">1</span></span><span class="mord">)</span></span></span></span></span></span></div><ul><li>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mtext>mask</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\text{mask}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord text"><span class="mord">mask</span></span><span class="mclose">]</span></span></span></span></span> 는 template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> 내의 답변 위치이며, </li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi mathvariant="script">L</mi></msub></mrow><annotation encoding="application/x-tex">P_\mathcal{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathcal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 은 language model 의 output distribution 이다.</li><li>answers infilling 에는 T5 를 사용한다. </li><li>Template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> 와 filtered answers <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">V</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{V}_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 얻은 후, 각 선택된 답변을 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.25417em">T</span></span></span></span></span> 의 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mtext>mask</mtext><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\text{mask}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord text"><span class="mord">mask</span></span><span class="mclose">]</span></span></span></span></span> token 위치에 삽입하여 prompts <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.08222em">P</span></span></span></span></span> 를 생성한다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-tap-c-method-for-vqa">3.2 TAP-C Method for VQA<a href="#32-tap-c-method-for-vqa" class="hash-link" aria-label="Direct link to 3.2 TAP-C Method for VQA" title="Direct link to 3.2 TAP-C Method for VQA">​</a></h2><p>제안한 방법은 <strong>Template → Answer → Prompt → CLIP discrimination</strong> 파이프라인을 따르므로 <strong>TAP-C</strong> 라 명명한다. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mtext>parsing</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_{\text{parsing}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">parsing</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 과 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mtext>demo</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_{\text{demo}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">demo</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를 더 효과적으로 사용하기 위해, T5 생성 confidence threshold 를 설정하여 앙상블한다. Confidence 가 높으면 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mtext>demo</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_{\text{demo}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">demo</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 를, 낮으면 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">T</mi><mtext>parsing</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{T}_{\text{parsing}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em"><span style="top:-2.55em;margin-left:-0.2542em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">parsing</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 을 사용한다.</p><p>image <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em"></span><span class="mord mathnormal">i</span></span></span></span></span> 와 생성된 prompts <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.08222em">P</span></span></span></span></span> 가 주어졌을 때, TAP-C 의 zero-shot VQA 예측은 다음과 같이 계산된다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><munder><mrow><mi>max</mi><mo>⁡</mo></mrow><mrow><mi>v</mi><mo>∈</mo><msub><mi mathvariant="script">V</mi><mi>F</mi></msub><mo separator="true">,</mo><mtext> </mtext><msub><mi>p</mi><mi>v</mi></msub><mo>∈</mo><mi mathvariant="script">P</mi></mrow></munder><mo stretchy="false">{</mo><mi>V</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>⋅</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mi>p</mi><mi>v</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(2)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\max_{v \in \mathcal{V}_F, \, p_v \in \mathcal{P}} \{ V(i) \cdot T(p_v) \}\tag{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.6304em;vertical-align:-0.8804em"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.4306em"><span style="top:-2.3557em;margin-left:0em"><span class="pstrut" style="height:3em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mrel mtight">∈</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em"><span style="top:-2.3567em;margin-left:-0.0822em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1433em"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mspace mtight" style="margin-right:0.1952em"></span><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em"><span class="pstrut" style="height:2.5em"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em"><span></span></span></span></span></span></span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">P</span></span></span></span><span style="top:-3em"><span class="pstrut" style="height:3em"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804em"><span></span></span></span></span></span><span class="mopen">{</span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)}</span></span><span class="tag"><span class="strut" style="height:1.6304em;vertical-align:-0.8804em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">2</span></span><span class="mord">)</span></span></span></span></span></span></div><ul><li>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> 는 CLIP model 의 visual encoder 와 text encoder 이다. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>v</mi></msub></mrow><annotation encoding="application/x-tex">p_v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 는 TAP-C 에 의해 생성된 prompt 로, masked template 에서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">V</mi><mi>F</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{V}_F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em">F</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 의 answer <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span></span></span></span></span> 로 채워진 형태이다.</li></ul><h1>4 Zero-shot Cross-modality Transfer</h1><p>최근 pre-trained multilingual language model 들은 서로 다른 언어 간에 representation 을 전이하는 데 성공적인 성과를 보였다. 예를 들어, 특정 source language 로만 fine-tuning 하고, 별도의 학습 없이도 다양한 target language 에 대해 좋은 성능을 낼 수 있다.</p><p>한편, CLIP model 은 vision 과 language representation 간의 dot product 만으로도 image-to-text, text-to-image retrieval task 에서 strong zero-shot 성능을 달성한다. 이는 두 modality 가 CLIP model 내에서 잘 aligned 되어 있다는 직관을 준다. 그렇다면 multilingual model 이 언어 간 전이를 수행하듯, CLIP model 에서도 language 와 vision 간 cross-modality capability 가 존재하는가?</p><p><img loading="lazy" alt="Figure 4" src="/assets/images/image-17-3832e9aa0309f004a6c77c4a7ddc0698.png" width="2588" height="2237" class="img_ev3q"></p><p>이 질문에 답하기 위해, 저자는 Sec. 2.2 의 visual entailment task 를 활용하여 zero-shot cross-modality 성능을 탐구한다. Fig. 4 는 핵심 아이디어를 간단히 나타낸다. 구체적으로, premise 와 hypothesis 의 fused representation 위에 MLP classifier 를 학습하며, fusion function 은 다음과 같이 정의된다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>fuse</mtext><mo stretchy="false">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo>+</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo>−</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>1</mn></msub><mo>⋅</mo><msub><mi>v</mi><mn>2</mn></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{fuse}(v_1, v_2) = [v_1, v_2, v_1 + v_2, v_1 - v_2, v_1 \cdot v_2]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">fuse</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6389em;vertical-align:-0.1944em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></div><p>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">v_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 과 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">v_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 는 두 개의 입력 벡터이다.</p><p><strong>Training 단계</strong>에서는 text-only premise 와 hypothesis 를 CLIP text encoder 의 입력으로 사용한다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mtext>MLP</mtext><mo stretchy="false">{</mo><mtext>fuse</mtext><mo stretchy="false">(</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mtext>pre</mtext><mi>t</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mtext>hyp</mtext><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(3)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\text{MLP}\{\text{fuse}(T(\text{pre}_t), T(\text{hyp}_t))\} \tag{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">MLP</span></span><span class="mopen">{</span><span class="mord text"><span class="mord">fuse</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">pre</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">hyp</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mclose">))}</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">3</span></span><span class="mord">)</span></span></span></span></span></span></div><p>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span></span></span></span></span> 는 CLIP text encoder 로, 학습 중 업데이트되지 않는다. <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>pre</mtext><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\text{pre}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6747em;vertical-align:-0.2441em"></span><span class="mord"><span class="mord text"><span class="mord">pre</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>hyp</mtext><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">\text{hyp}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9386em;vertical-align:-0.2441em"></span><span class="mord"><span class="mord text"><span class="mord">hyp</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span></span></span> 는 text premise 와 text hypothesis 이다. Inference 단계에서는 premise 가 image 형태로 주어지고, CLIP visual encoder 에 입력된다. 학습된 MLP 는 다음과 같이 예측에 사용된다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">{</mo><mtext>MLP</mtext><mo stretchy="false">{</mo><mtext>fuse</mtext><mo stretchy="false">(</mo><mi>V</mi><mo stretchy="false">(</mo><msub><mtext>pre</mtext><mi>i</mi></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>T</mi><mo stretchy="false">(</mo><msub><mtext>hyp</mtext><mi>t</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo><mo stretchy="false">}</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(4)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\max \{ \text{MLP}\{\text{fuse}(V(\text{pre}_i), T(\text{hyp}_t))\} \} \tag{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mop">max</span><span class="mopen">{</span><span class="mord text"><span class="mord">MLP</span></span><span class="mopen">{</span><span class="mord text"><span class="mord">fuse</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.22222em">V</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">pre</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mopen">(</span><span class="mord"><span class="mord text"><span class="mord">hyp</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1864em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span><span class="mclose">))}}</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">4</span></span><span class="mord">)</span></span></span></span></span></span></div><p>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>pre</mtext><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\text{pre}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6747em;vertical-align:-0.2441em"></span><span class="mord"><span class="mord text"><span class="mord">pre</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2175em"><span style="top:-2.4559em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2441em"><span></span></span></span></span></span></span></span></span></span></span> 는 image premise 이고, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.22222em">V</span></span></span></span></span> 는 CLIP visual encoder 이다.</p><h1>5 Few-shot Learning for VQA</h1><p>본 절에서는 CLIP model 이 <em>few-shot</em> learning 에서 이점을 얻을 수 있는지 여부를 조사하며, 이를 위해 visual question answering (VQA) task 를 대상으로 연구를 수행한다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="51-setup-of-few-shot-vqa">5.1 Setup of Few-shot VQA<a href="#51-setup-of-few-shot-vqa" class="hash-link" aria-label="Direct link to 5.1 Setup of Few-shot VQA" title="Direct link to 5.1 Setup of Few-shot VQA">​</a></h2><p>Few-shot VQA 설정에서 사용되는 용어를 다음과 같이 정의한다.</p><ul><li><strong>Number of ways</strong>
원래는 task 내의 서로 다른 class 수로 정의되지만, 본 연구에서는 answer vocabulary 에 따른 3,129-way 가 아닌, question type 과 answer type (Sec. 2.2) 의 곱으로 정의한다. 즉, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>65</mn><mo>×</mo><mn>3</mn><mo>=</mo><mn>195</mn></mrow><annotation encoding="application/x-tex">65 \times 3 = 195</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">65</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.6444em"></span><span class="mord">195</span></span></span></span></span> ways 로 설정하여, 모델이 특정 question type 에 답변할 수 있는 generalization 능력을 보장한다.</li><li><strong>Number of shots</strong>
각 way 에서의 서로 다른 예시 수를 의미한다. 여기서 shot 은 이미지, 질문, 정답으로 구성된 하나의 예시를 뜻한다.</li><li><strong>Support set 과 query set</strong>
학습 전, VQAv2 training set 에서 195-way K-shot subset 을 샘플링하여, few-shot learning 에 사용 가능한 예시 수를 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>195</mn><mo>×</mo><mi>K</mi></mrow><annotation encoding="application/x-tex">195 \times K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em"></span><span class="mord">195</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> 로 설정한다. 각 학습 epoch 에서 195 ways 중 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">C</span></span></span></span></span> ways 를 선택하여 parameter optimization 을 수행하며, 각 way 의 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span> shots 를 일정 비율로 support set 과 query set 으로 나눈다. Support set 은 모델 학습에, query set 은 성능 평가(일종의 dev set 역할)에 사용된다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="52-parameter-efficient-fine-tuning">5.2 Parameter-efficient Fine-tuning<a href="#52-parameter-efficient-fine-tuning" class="hash-link" aria-label="Direct link to 5.2 Parameter-efficient Fine-tuning" title="Direct link to 5.2 Parameter-efficient Fine-tuning">​</a></h2><p>Few-shot 환경에서의 목표는 CLIP model 이 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span>-way <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathnormal" style="margin-right:0.07153em">K</span></span></span></span></span>-shot 예시로부터 학습하여 zero-shot VQA 성능을 향상시키는 것이다. 이를 위해 CLIP model 의 전체 100M parameter 중 약 0.3M 만 최적화 대상으로 설정한다. 최적화되는 parameter 는 bias term 과 normalization term 으로, normalization 은 BatchNorm (ResNet) 과 LayerNorm (Transformer) 모두 다음과 같이 통일적으로 표현할 수 있다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>y</mi><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>E</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><msqrt><mrow><mtext>Var</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>ϵ</mi></mrow></msqrt></mfrac><mo>⋅</mo><mi>γ</mi><mo>+</mo><mi>β</mi></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(5)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">y = \frac{x - E(x)}{\sqrt{\text{Var}(x) + \epsilon}} \cdot \gamma + \beta \tag{5}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:2.557em;vertical-align:-1.13em"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em"><span style="top:-2.175em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.935em"><span class="svg-align" style="top:-3.2em"><span class="pstrut" style="height:3.2em"></span><span class="mord" style="padding-left:1em"><span class="mord text"><span class="mord">Var</span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal">ϵ</span></span></span><span style="top:-2.895em"><span class="pstrut" style="height:3.2em"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em"><svg xmlns="http://www.w3.org/2000/svg" width="400em" height="1.28em" viewBox="0 0 400000 1296" preserveAspectRatio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.305em"><span></span></span></span></span></span></span></span><span style="top:-3.23em"><span class="pstrut" style="height:3em"></span><span class="frac-line" style="border-bottom-width:0.04em"></span></span><span style="top:-3.677em"><span class="pstrut" style="height:3em"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mord mathnormal" style="margin-right:0.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.13em"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span><span class="tag"><span class="strut" style="height:2.557em;vertical-align:-1.13em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">5</span></span><span class="mord">)</span></span></span></span></span></span></div><ul><li>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">x</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.03588em">y</span></span></span></span></span> 는 mini-batched input/output 이고, </li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi></mrow><annotation encoding="application/x-tex">\gamma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span></span></span></span></span> 는 learned parameter 이다.</li></ul><p>CLIP model 의 모든 linear layer 와 projection layer 는 다음과 같이 표현된다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><mi>o</mi><mo>=</mo><mi>w</mi><mo>⋅</mo><mi>h</mi><mo>+</mo><mtext>bias</mtext></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(6)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">o = w \cdot h + \text{bias} \tag{6}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">o</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:0.4445em"></span><span class="mord mathnormal" style="margin-right:0.02691em">w</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord text"><span class="mord">bias</span></span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">6</span></span><span class="mord">)</span></span></span></span></span></span></div><p>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal">h</span></span></span></span></span> 와 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi></mrow><annotation encoding="application/x-tex">o</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em"></span><span class="mord mathnormal">o</span></span></span></span></span> 는 각각 input 과 output vector 이다. 따라서 learnable parameter set 은 다음과 같이 정의된다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi>P</mi><mtext>learn</mtext></msub><mo>=</mo><mo stretchy="false">{</mo><mtext>bias</mtext><mo separator="true">,</mo><mi>γ</mi><mo separator="true">,</mo><mi>β</mi><mo stretchy="false">}</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(7)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">P_{\text{learn}} = \{\text{bias}, \gamma, \beta\} \tag{7}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">learn</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">{</span><span class="mord text"><span class="mord">bias</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05556em">γ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathnormal" style="margin-right:0.05278em">β</span><span class="mclose">}</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">7</span></span><span class="mord">)</span></span></span></span></span></span></div><p>저자는 <strong>Bi</strong>as 와 <strong>Nor</strong>malization (BiNor) parameter 를 few-shot 예시에서 최적화하며, 각 image-prompt pair 의 dot product (Eq. 2) 에 대해 standard cross-entropy loss 를 사용한다.</p><p>또한, 예시 수가 적은 경우, TAP-C (Sec. 3.1) 의 answer filtering 과정에서 <strong>in-context demonstration</strong> 방식을 활용하여 성능을 개선할 수 있다. 이를 위해 식 (1)을 다음과 같이 수정한다.</p><div class="math math-display"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable width="100%"><mtr><mtd width="50%"></mtd><mtd><mrow><msub><mi mathvariant="script">V</mi><mtext>demo</mtext></msub><mo>=</mo><mtext>Top-</mtext><msub><mi>k</mi><mrow><mi>v</mi><mo>∈</mo><mi mathvariant="script">V</mi></mrow></msub><mo stretchy="false">{</mo><mi>log</mi><mo>⁡</mo><msub><mi>P</mi><mi mathvariant="script">L</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mtext>mask</mtext><mo stretchy="false">]</mo><mo>=</mo><mi>v</mi><mo>∣</mo><mo stretchy="false">[</mo><mi mathvariant="script">D</mi><mo separator="true">,</mo><mi mathvariant="script">T</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mtd><mtd width="50%"></mtd><mtd><mtext>(8)</mtext></mtd></mtr></mtable><annotation encoding="application/x-tex">\mathcal{V}_{\text{demo}} = \text{Top-}k_{v \in \mathcal{V}} \{ \log P_\mathcal{L}([\text{mask}] = v \mid [\mathcal{D}, \mathcal{T}]) \} \tag{8}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">demo</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">Top-</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.0315em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em">v</span><span class="mrel mtight">∈</span><span class="mord mathcal mtight" style="margin-right:0.08222em">V</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1774em"><span></span></span></span></span></span></span><span class="mopen">{</span><span class="mop">lo<span style="margin-right:0.01389em">g</span></span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathcal mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord text"><span class="mord">mask</span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mspace" style="margin-right:0.2778em"></span><span class="mrel">∣</span><span class="mspace" style="margin-right:0.2778em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mopen">[</span><span class="mord mathcal" style="margin-right:0.02778em">D</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord mathcal" style="margin-right:0.25417em">T</span><span class="mclose">])}</span></span><span class="tag"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord text"><span class="mord">(</span><span class="mord"><span class="mord">8</span></span><span class="mord">)</span></span></span></span></span></span></div><ul><li>여기서 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">D</mi></mrow><annotation encoding="application/x-tex">\mathcal{D}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.02778em">D</span></span></span></span></span> 는 demonstration 으로, template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">T</mi></mrow><annotation encoding="application/x-tex">\mathcal{T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord mathcal" style="margin-right:0.25417em">T</span></span></span></span></span> 와 유사하지만 답변이 채워져 있으며, few-shot 예시 중 동일 question type 에서 샘플링된다. </li><li>이 과정을 통해 필터링된 vocabulary 를 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">V</mi><mtext>demo</mtext></msub></mrow><annotation encoding="application/x-tex">\mathcal{V}_{\text{demo}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em">V</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.0822em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">demo</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 라 한다.</li></ul><h1>6 Experiments</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="61-experimental-settings">6.1 Experimental Settings<a href="#61-experimental-settings" class="hash-link" aria-label="Direct link to 6.1 Experimental Settings" title="Direct link to 6.1 Experimental Settings">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="datasets">Datasets.<a href="#datasets" class="hash-link" aria-label="Direct link to Datasets." title="Direct link to Datasets.">​</a></h4><p><img loading="lazy" alt="Table 7" src="/assets/images/image-14-9161bfb2e886047594a9e8fac16fd6c6.png" width="1627" height="881" class="img_ev3q"></p><p>Visual question answering 과 visual entailment 에 대해 각각 VQAv2 와 SNLI-VE dataset 에서 실험을 수행한다. 두 dataset 의 통계치는 Tab. 7 에 보고한다. </p><ul><li>VQA task 평가는 Frozen model 을 따라 VQAv2 validation set 에서 vqa score 를 계산한다. </li><li>Visual entailment 평가는 sklearn toolkit 을 사용하여 validation set 과 test set 의 accuracy 를 계산한다.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="clip-models">CLIP models.<a href="#clip-models" class="hash-link" aria-label="Direct link to CLIP models." title="Direct link to CLIP models.">​</a></h4><p>Visual encoder 종류(e.g., ResNet, ViT)에 따라 CLIP model 은 여러 variant 가 있으며, learnable bias 및 normalization parameter 의 수가 크게 달라진다. CLIP variant 의 learnable parameter 수는 Tab. 11 에 보고한다. </p><p><img loading="lazy" alt="Table 11" src="/assets/images/image-15-30ed293ca3dd91abbb3f999348867203.png" width="1627" height="700" class="img_ev3q"></p><p>본 연구에서는 ResNet 기반의 CLIP Res50x16 과 ViT 기반의 CLIP ViT-B/16, 두 가지 성능 우수 variant 를 선택하여 제안한 전이 방법(§§ 3–5)을 적용한 zero-shot 및 few-shot vision-language understanding 성능을 실증적으로 연구한다.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="62-results-of-zero-shot-vqa">6.2 Results of Zero-shot VQA<a href="#62-results-of-zero-shot-vqa" class="hash-link" aria-label="Direct link to 6.2 Results of Zero-shot VQA" title="Direct link to 6.2 Results of Zero-shot VQA">​</a></h2><p>기존 VL model 은 object detection sub-module 에 크게 의존하므로 zero-shot 환경에서 직접 적용하기 어렵다. 본 연구에서는 최신 연구 두 가지를 zero-shot VL baseline 으로 설정한다.</p><ul><li><strong>Frozen</strong>
Frozen 은 7B parameter, 32-layer language model 에 image representation 을 prompt 로 제공하는 방식이다. Aligned image-caption data 로 학습되었으며, zero-shot 및 few-shot VQA 성능을 처음으로 보여준 모델이다.</li><li><strong>Question irrelevant prompt (QIP)</strong>
Shen et al. 은 CLIP model 을 직접 prompt 하여 VQA task 를 수행하는 방법을 탐구했다. “question: <!-- -->[question text]<!-- --> answer: <!-- -->[answer text]<!-- -->” template 과 image classification prompt engineering 을 결합해 prompt 를 준비했다. 그러나 이렇게 생성된 prompt 는 질문과 무관하므로 QIP 로 표기한다.</li></ul><p>Table 1 의 zero-shot VQA 결과는 Sec. 3.1 의 가설을 검증한다. 즉, CLIP 의 prompt 는 task 설명이 아니라 label 을 설명하는 형태여야 한다. </p><p><img loading="lazy" alt="Table 1" src="/assets/images/image-16-c1e34e5e31d87fdc35e5a149fd089779.png" width="2080" height="1180" class="img_ev3q"></p><ul><li>QIP 방식은 단순히 task 설명과 정답을 CLIP model 에 제시하며, 랜덤 추측보다 약간 나은 수준에 그친다. </li><li>반면, 저자의 TAP-C 방법은 질문을 template 으로 변환하고, pre-trained language model 로 답변을 필터링함으로써, 7B parameter Frozen zero-shot model 과 비교해도 강력한 zero-shot 성능을 달성한다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="63-zero-shot-cross-modality-transfer">6.3 Zero-shot Cross-modality Transfer<a href="#63-zero-shot-cross-modality-transfer" class="hash-link" aria-label="Direct link to 6.3 Zero-shot Cross-modality Transfer" title="Direct link to 6.3 Zero-shot Cross-modality Transfer">​</a></h2><p><img loading="lazy" alt="Table 2" src="/assets/images/image-18-5fbd408d573a6627c1ea3bd405bd982d.png" width="1951" height="1030" class="img_ev3q"></p><p>Table 2 는 zero-shot cross-modality transfer 결과를 보여준다. 먼저 <strong>language → vision transfer</strong> 를 조사한다. </p><ul><li>Sec. 4 에서 설명한 대로, image 를 caption 으로 대체한 text-only SNLI-VE dataset 에서 classifier 를 학습한 뒤, 추론 시 image-text 를 입력으로 평가한다. </li><li>첫 번째 결과 그룹에서 보이듯, text-text (caption 을 premise 로 사용) entailment data 로만 학습했음에도, 서로 다른 CLIP variant 는 image-text 환경에서도 유사한 판별 능력을 유지한다.</li></ul><p>위 결과가 실제로 language → vision 전이임을 확인하기 위해, 추론 시 이미지를 masking 하여 평가했으며(Image Masked), 결과는 3-class 무작위 추측 수준과 유사했다. 이는 이미지가 cross-modality 평가에서 중요한 역할을 한다는 것을 의미한다.</p><p>다음으로 <strong>vision → language transfer</strong> 여부를 조사한다. 이를 위해 original SNLI-VE dataset(image premise + text hypothesis) 으로 classifier 를 학습하고, 추론 시 text-only valid/test data 로 평가했다. </p><ul><li>Table 2 결과는 vision → language 전이 능력을 확인시켜 준다. </li><li>실제 응용에서 text data 는 visual data 보다 훨씬 저렴하므로, practical 관점에서는 language → vision 전이가 더 유망하다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="64-results-of-few-shot-vqa">6.4 Results of Few-shot VQA<a href="#64-results-of-few-shot-vqa" class="hash-link" aria-label="Direct link to 6.4 Results of Few-shot VQA" title="Direct link to 6.4 Results of Few-shot VQA">​</a></h2><p><img loading="lazy" alt="Table 3" src="/assets/images/image-19-2c12c1465fa515e30467619313a4755d.png" width="3971" height="1932" class="img_ev3q"></p><p>Table 3 은 few-shot VQA 결과를 보여준다. </p><ul><li>Baseline 으로 Frozen model 과 이미지가 가려진 Frozenblind 를 사용했다. </li><li>서로 다른 <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> 값에서 제안한 방법은 항상 제한된 학습 예시로부터 학습하여 zero-shot 성능을 향상시켰으며, 이는 CLIP model 이 VL few-shot learner 가 될 수 있음을 확인시켜 준다.</li><li>Shot 수가 증가함에 따라 <strong>other</strong> category 에서 큰 성능 향상이 관찰되는데, 이는 question type 별로 예시를 샘플링하므로 other category 의 많은 답변이 학습 초기에 모델에 노출되지 않았기 때문이다. </li><li>예시가 추가되면 모델이 계속 학습하여 향상되는 경향을 보인다. 또한, T5 에 예시를 제공하는 것은 answer filtering 과정 성능을 높여 other category 성능 향상으로 이어졌다.</li><li>반면, <strong>number</strong> category 는 학습 초기 일부 예시만 보아도 성능이 빠르게 향상되지만, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> 가 계속 증가하면 개선 속도가 둔화된다.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="65-analyses-and-discussion">6.5 Analyses and Discussion<a href="#65-analyses-and-discussion" class="hash-link" aria-label="Direct link to 6.5 Analyses and Discussion" title="Direct link to 6.5 Analyses and Discussion">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-effects-of-template-generation-methods">The effects of template generation methods.<a href="#the-effects-of-template-generation-methods" class="hash-link" aria-label="Direct link to The effects of template generation methods." title="Direct link to The effects of template generation methods.">​</a></h4><p><img loading="lazy" alt="Table 4" src="/assets/images/image-20-fdb4ad9889e98f9a753444ad60088540.png" width="1939" height="1058" class="img_ev3q"></p><p>TAP-C 방법은 dependency parsing 기반 template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mtext>parsing</mtext></msub></mrow><annotation encoding="application/x-tex">T_{\text{parsing}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3175em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">parsing</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em"><span></span></span></span></span></span></span></span></span></span></span> 과 T5 demonstration 기반 template <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mtext>demo</mtext></msub></mrow><annotation encoding="application/x-tex">T_{\text{demo}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">demo</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em"><span></span></span></span></span></span></span></span></span></span></span> 의 앙상블을 사용한다. 여기서는 이러한 앙상블 사용이 필수적인지 조사한다. Table 4 의 ablation 결과에 따르면, 두 template 은 질문 유형에 따라 서로 다른 장점을 가지며, 앙상블은 이들의 장점을 최대한 활용할 수 있음을 보여준다.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="the-effects-of-two-steps-in-tap-c">The effects of two steps in TAP-C.<a href="#the-effects-of-two-steps-in-tap-c" class="hash-link" aria-label="Direct link to The effects of two steps in TAP-C." title="Direct link to The effects of two steps in TAP-C.">​</a></h4><p><img loading="lazy" alt="Table 5" src="/assets/images/image-21-6e3e1b8339480b929d27ace2a308a3c7.png" width="1955" height="1298" class="img_ev3q"></p><p>TAP-C 는 template generation (t.gen.) 과 answer filtering (a.filt.) 을 통해 prompt 를 생성한다. 각 단계가 zero/few-shot VQA 최종 성능에 기여하는 정도를 정량적으로 분석하기 위해 Table 5 의 ablation 결과를 보고한다. </p><ul><li>Answer filtering 단계를 제거(w/o a.filt.)하면 zero-shot 및 few-shot 성능이 약 20% 감소하지만, 모델은 여전히 일부 few-shot 학습 능력을 유지한다. </li><li>Template generation 단계마저 제거하고 question irrelevant template 만 사용하면 성능이 절반 수준으로 떨어지며, 이는 zero-shot 과 few-shot 환경 모두에서 질문 반영이 매우 중요함을 시사한다.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="comparisons-of-fine-tuning-methods">Comparisons of fine-tuning methods.<a href="#comparisons-of-fine-tuning-methods" class="hash-link" aria-label="Direct link to Comparisons of fine-tuning methods." title="Direct link to Comparisons of fine-tuning methods.">​</a></h4><p><img loading="lazy" alt="Table 6" src="/assets/images/image-22-8501fa58327e58484392c5d232389bad.png" width="3973" height="1074" class="img_ev3q"></p><p>Few-shot 학습 시 저자는 bias 와 normalization parameter 만 업데이트한다(§ 5.2). BiNor fine-tuning 전략의 효과를 검증하기 위해 다음 두 방법과 비교한다.</p><ol><li><strong>Full-FT (Full fine-tuning)</strong> — 모델의 모든 parameter 업데이트</li><li><strong>BitFit</strong> — 모든 layer 에서 bias term 만 업데이트</li></ol><ul><li>Table 6 결과, BiNor 와 BitFit 은 모두 Full-FT 를 크게 상회하는 성능을 보였다. 이는 수백만 개 parameter 전체를 학습하면 few-shot 환경에서 쉽게 overfitting 되기 때문이다. </li><li><span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> 가 작을 때 BiNor 와 BitFit 간 성능 차이는 작지만, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> 가 커지면 BiNor 가 BitFit 을 확연히 앞선다. </li><li>BiNor 는 BitFit 과 유사하지만 normalization parameter 도 업데이트하여, 특히 batch normalization parameter 가 많은 ResNet 기반 CLIP model 에서 새로운 예시에 더 잘 적응하도록 한다. </li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="limitations-of-tap-c">Limitations of TAP-C.<a href="#limitations-of-tap-c" class="hash-link" aria-label="Direct link to Limitations of TAP-C." title="Direct link to Limitations of TAP-C.">​</a></h4><p>제안한 TAP-C 방법은 CLIP model 의 zero/few-shot VQA 수행 가능성을 탐구했으나, few-shot 성능 향상을 저해하는 몇 가지 한계도 확인되었다. 이러한 한계는 CLIP model 자체에 기인할 수 있다.</p><ol><li><strong>정밀 객체 수 세기 어려움</strong> — 특히 이미지의 작은 영역에서 객체 수를 세는 경우, CLIP model 은 어려움을 겪으며, 이는 language knowledge 로 보완하기 어렵다.</li><li><strong>미묘한 의미 구분 실패</strong> — 예를 들어, “what is the man in the background doing?” 질문에 대해 모든 실험 CLIP model 이 전경(foreground) 인물의 행동을 예측했다.</li></ol><p>이러한 경우 TAP-C 가 질문을 prompt 로 완벽하게 변환하더라도 최종 결과는 여전히 잘못될 수 있다. 그럼에도, 저자는 더 강력한 text encoder 로 CLIP model 을 강화하면 이 문제가 상당 부분 해결될 수 있다고 보고, 향후 연구에서 이를 탐구할 계획이다.</p><h1>7 Related Work</h1><h4 class="anchor anchorWithStickyNavbar_LWe7" id="vision-language-few-shot-learning">Vision-language few-shot learning.<a href="#vision-language-few-shot-learning" class="hash-link" aria-label="Direct link to Vision-language few-shot learning." title="Direct link to Vision-language few-shot learning.">​</a></h4><p>Aligned caption data 를 활용하여 image-text discriminative loss 로 pretraining 된 vision-language model 은 최근 image classification 과 cross-modality retrieval task 에서 강력한 zero-shot generalization 성능을 보였다. Discriminative 방식과 달리, Tsimpoukelli et al. 은 vision prefix 를 사용해 large frozen language model 을 generative 방식으로 prompt 하였으며, 이는 최초의 vision-language few-shot model 이다.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="language-model-prompting">Language model prompting.<a href="#language-model-prompting" class="hash-link" aria-label="Direct link to Language model prompting." title="Direct link to Language model prompting.">​</a></h4><p>본 연구는 language model prompting 연구 흐름에서도 영감을 받았다. GPT series 로 시작된 prompting 은 pre-trained language model 로부터 zero-shot 또는 few-shot 방식으로 knowledge 를 추출하는 방법으로 널리 사용되고 있다. PET 연구는 few-shot language understanding 성능 향상을 위한 semi-supervised prompting 방법을 제시하였다.</p><h1>8 Conclusions</h1><p>본 연구에서는 CLIP model 을 vision-language understanding task 로 전이하는 방법을 실증적으로 연구하였다. </p><p>*먼저, language prompt 를 활용하여 CLIP model 의 zero-shot VQA 성능을 탐구하고, few-shot 성능 향상을 위한 parameter-efficient fine-tuning 방법을 제안하였다.
또한 visual entailment task 에서 CLIP model 의 zero-shot cross-modality transfer 능력을 입증하였다. VQAv2 와 SNLI-VE dataset 에서의 실험 및 분석을 통해 CLIP model 이 우수한 VL few-shot learner 가 될 수 있음을 확인하였다.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/vision-language">Vision-Language</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/multimodal">Multimodal</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/vqa">VQA</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/visual-entailment">Visual Entailment</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/few-shot-learning">few-shot learning</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/frozen">Frozen</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/clip">CLIP</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/wyjo0626/wyjo0626.github.io/tree/master/docs/docs/Paper/Vision-Language/VQA-IC/Few-shot/2022-03-TAP.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/FEWVLM"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">A Good Prompt Is Worth Millions of Parameters: Low-resource Prompt-based Learning for Vision-Language Models</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Paper/Vision-Language/VQA-IC/Few-shot/MGMA"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Linearly Mapping from Image to Text Space</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#21-clip" class="table-of-contents__link toc-highlight">2.1 CLIP</a></li><li><a href="#22-vision-language-understanding-tasks" class="table-of-contents__link toc-highlight">2.2 Vision-Language Understanding Tasks</a></li><li><a href="#31-a-two-step-prompt-generation-method" class="table-of-contents__link toc-highlight">3.1 A Two-Step Prompt Generation Method</a></li><li><a href="#32-tap-c-method-for-vqa" class="table-of-contents__link toc-highlight">3.2 TAP-C Method for VQA</a></li><li><a href="#51-setup-of-few-shot-vqa" class="table-of-contents__link toc-highlight">5.1 Setup of Few-shot VQA</a></li><li><a href="#52-parameter-efficient-fine-tuning" class="table-of-contents__link toc-highlight">5.2 Parameter-efficient Fine-tuning</a></li><li><a href="#61-experimental-settings" class="table-of-contents__link toc-highlight">6.1 Experimental Settings</a></li><li><a href="#62-results-of-zero-shot-vqa" class="table-of-contents__link toc-highlight">6.2 Results of Zero-shot VQA</a></li><li><a href="#63-zero-shot-cross-modality-transfer" class="table-of-contents__link toc-highlight">6.3 Zero-shot Cross-modality Transfer</a></li><li><a href="#64-results-of-few-shot-vqa" class="table-of-contents__link toc-highlight">6.4 Results of Few-shot VQA</a></li><li><a href="#65-analyses-and-discussion" class="table-of-contents__link toc-highlight">6.5 Analyses and Discussion</a></li></ul></div></div></div><div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/wyjo0626/wyjo0626.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Won-Yong Jo, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.24800c52.js"></script>
<script src="/assets/js/main.4c1744f1.js"></script>
</body>
</html>